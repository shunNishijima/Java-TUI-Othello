!function(){this.MooTools={version:"1.6.0",build:"529422872adfff401b901b8b6c7ca5114ee95e2b"};var t,r=this.typeOf=function(t){if(null==t)return"null";if(null!=t.$family)return t.$family();if(t.nodeName){if(1==t.nodeType)return"element";if(3==t.nodeType)return/\S/.test(t.nodeValue)?"textnode":"whitespace"}else if("number"==typeof t.length){if("callee"in t)return"arguments";if("item"in t)return"collection"}return typeof t},o=(this.instanceOf=function(t,e){if(null==t)return!1;for(var i=t.$constructor||t.constructor;i;){if(i===e)return!0;i=i.parent}return!!t.hasOwnProperty&&t instanceof e},Object.prototype.hasOwnProperty),a=!0;for(t in{toString:1})a=null;function l(t,e,i){if(a)for(var n=a.length;n--;){var s=a[n];o.call(t,s)&&e.call(i,s,t[s])}}var a=a&&["hasOwnProperty","valueOf","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","constructor"],e=this.Function;e.prototype.overloadSetter=function(n){var s=this;return function(t,e){if(null==t)return this;if(n||"string"!=typeof t){for(var i in t)s.call(this,i,t[i]);l(t,s,this)}else s.call(this,t,e);return this}},e.prototype.overloadGetter=function(s){var o=this;return function(t){var e;if("string"!=typeof t?e=t:1<arguments.length?e=arguments:s&&(e=[t]),e)for(var i={},n=0;n<e.length;n++)i[e[n]]=o.call(this,e[n]);else i=o.call(this,t);return i}},e.prototype.extend=function(t,e){this[t]=e}.overloadSetter(),e.prototype.implement=function(t,e){this.prototype[t]=e}.overloadSetter();var h=Array.prototype.slice;Array.convert=function(t){return null==t?[]:u.isEnumerable(t)&&"string"!=typeof t?"array"==r(t)?t:h.call(t):[t]},e.convert=function(t){return"function"==r(t)?t:function(){return t}},Number.convert=function(t){t=parseFloat(t);return isFinite(t)?t:null},String.convert=function(t){return t+""},e.from=e.convert,Number.from=Number.convert,String.from=String.convert,e.implement({hide:function(){return this.$hidden=!0,this},protect:function(){return this.$protected=!0,this}});var u=this.Type=function(t,e){var i;return t&&(i=t.toLowerCase(),u["is"+t]=function(t){return r(t)==i},null!=e&&(e.prototype.$family=function(){return i}.hide())),null==e?null:(e.extend(this),e.$constructor=u,e.prototype.$constructor=e)},i=Object.prototype.toString;u.isEnumerable=function(t){return null!=t&&"number"==typeof t.length&&"[object Function]"!=i.call(t)};var n={},c=function(t){t=r(t.prototype);return n[t]||(n[t]=[])},d=function(t,e){if(!e||!e.$hidden){for(var i=c(this),n=0;n<i.length;n++){var s=i[n];"type"==r(s)?d.call(s,t,e):s.call(this,t,e)}var o=this.prototype[t];null!=o&&o.$protected||(this.prototype[t]=e),null==this[t]&&"function"==r(e)&&p.call(this,t,function(t){return e.apply(t,h.call(arguments,1))})}},p=function(t,e){var i;e&&e.$hidden||(null!=(i=this[t])&&i.$protected||(this[t]=e))};u.implement({implement:d.overloadSetter(),extend:p.overloadSetter(),alias:function(t,e){d.call(this,t,this.prototype[e])}.overloadSetter(),mirror:function(t){return c(this).push(t),this}}),new u("Type",u);var m=function(t,e,s){var i=e!=Object,o=e.prototype;i&&(e=new u(t,e));for(var a,n=0,r=s.length;n<r;n++){var l=s[n],h=e[l],c=o[l];h&&h.protect(),i&&c&&e.implement(l,c.protect())}return i&&(a=o.propertyIsEnumerable(s[0]),e.forEachMethod=function(t){if(!a)for(var e=0,i=s.length;e<i;e++)t.call(o,o[s[e]],s[e]);for(var n in o)t.call(o,o[n],n)}),m};m("String",String,["charAt","charCodeAt","concat","contains","indexOf","lastIndexOf","match","quote","replace","search","slice","split","substr","substring","trim","toLowerCase","toUpperCase"])("Array",Array,["pop","push","reverse","shift","sort","splice","unshift","concat","join","slice","indexOf","lastIndexOf","filter","forEach","every","map","some","reduce","reduceRight","contains"])("Number",Number,["toExponential","toFixed","toLocaleString","toPrecision"])("Function",e,["apply","call","bind"])("RegExp",RegExp,["exec","test"])("Object",Object,["create","defineProperty","defineProperties","keys","getPrototypeOf","getOwnPropertyDescriptor","getOwnPropertyNames","preventExtensions","isExtensible","seal","isSealed","freeze","isFrozen"])("Date",Date,["now"]),Object.extend=p.overloadSetter(),Date.extend("now",function(){return+new Date}),new u("Boolean",Boolean),Number.prototype.$family=function(){return isFinite(this)?"number":"null"}.hide(),Number.extend("random",function(t,e){return Math.floor(Math.random()*(e-t+1)+t)}),Array.implement({forEach:function(t,e){for(var i=0,n=this.length;i<n;i++)i in this&&t.call(e,this[i],i,this)},each:function(t,e){return Array.forEach(this,t,e),this}}),Object.extend({keys:function(t){var e,i=[];for(e in t)o.call(t,e)&&i.push(e);return l(t,function(t){i.push(t)}),i},forEach:function(e,i,n){Object.keys(e).forEach(function(t){i.call(n,e[t],t,e)})}}),Object.each=Object.forEach;function s(t){switch(r(t)){case"array":return t.clone();case"object":return Object.clone(t);default:return t}}Array.implement("clone",function(){for(var t=this.length,e=new Array(t);t--;)e[t]=s(this[t]);return e});function f(t,e,i){switch(r(i)){case"object":"object"==r(t[e])?Object.merge(t[e],i):t[e]=Object.clone(i);break;case"array":t[e]=i.clone();break;default:t[e]=i}return t}Object.extend({merge:function(t,e,i){if("string"==r(e))return f(t,e,i);for(var n=1,s=arguments.length;n<s;n++){var o,a=arguments[n];for(o in a)f(t,o,a[o])}return t},clone:function(t){var e,i={};for(e in t)i[e]=s(t[e]);return i},append:function(t){for(var e=1,i=arguments.length;e<i;e++){var n,s=arguments[e]||{};for(n in s)t[n]=s[n]}return t}}),["Object","WhiteSpace","TextNode","Collection","Arguments"].each(function(t){new u(t)});var g=Date.now();String.extend("uniqueID",function(){return(g++).toString(36)})}(),Array.implement({every:function(t,e){for(var i=0,n=this.length>>>0;i<n;i++)if(i in this&&!t.call(e,this[i],i,this))return!1;return!0},filter:function(t,e){for(var i,n=[],s=0,o=this.length>>>0;s<o;s++)s in this&&(i=this[s],t.call(e,i,s,this)&&n.push(i));return n},indexOf:function(t,e){for(var i=this.length>>>0,n=e<0?Math.max(0,i+e):e||0;n<i;n++)if(this[n]===t)return n;return-1},map:function(t,e){for(var i=this.length>>>0,n=Array(i),s=0;s<i;s++)s in this&&(n[s]=t.call(e,this[s],s,this));return n},some:function(t,e){for(var i=0,n=this.length>>>0;i<n;i++)if(i in this&&t.call(e,this[i],i,this))return!0;return!1},clean:function(){return this.filter(function(t){return null!=t})},invoke:function(e){var i=Array.slice(arguments,1);return this.map(function(t){return t[e].apply(t,i)})},associate:function(t){for(var e={},i=Math.min(this.length,t.length),n=0;n<i;n++)e[t[n]]=this[n];return e},link:function(t){for(var e={},i=0,n=this.length;i<n;i++)for(var s in t)if(t[s](this[i])){e[s]=this[i],delete t[s];break}return e},contains:function(t,e){return-1!=this.indexOf(t,e)},append:function(t){return this.push.apply(this,t),this},getLast:function(){return this.length?this[this.length-1]:null},getRandom:function(){return this.length?this[Number.random(0,this.length-1)]:null},include:function(t){return this.contains(t)||this.push(t),this},combine:function(t){for(var e=0,i=t.length;e<i;e++)this.include(t[e]);return this},erase:function(t){for(var e=this.length;e--;)this[e]===t&&this.splice(e,1);return this},empty:function(){return this.length=0,this},flatten:function(){for(var t=[],e=0,i=this.length;e<i;e++){var n=typeOf(this[e]);"null"!=n&&(t=t.concat("array"==n||"collection"==n||"arguments"==n||instanceOf(this[e],Array)?Array.flatten(this[e]):this[e]))}return t},pick:function(){for(var t=0,e=this.length;t<e;t++)if(null!=this[t])return this[t];return null},hexToRgb:function(t){if(3!=this.length)return null;var e=this.map(function(t){return 1==t.length&&(t+=t),parseInt(t,16)});return t?e:"rgb("+e+")"},rgbToHex:function(t){if(this.length<3)return null;if(4==this.length&&0==this[3]&&!t)return"transparent";for(var e=[],i=0;i<3;i++){var n=(+this[i]).toString(16);e.push(1==n.length?"0"+n:n)}return t?e:"#"+e.join("")}}),Function.extend({attempt:function(){for(var t=0,e=arguments.length;t<e;t++)try{return arguments[t]()}catch(t){}return null}}),Function.implement({attempt:function(t,e){try{return this.apply(e,Array.convert(t))}catch(t){}return null},bind:function(i){var n=this,s=1<arguments.length?Array.slice(arguments,1):null,o=function(){},a=function(){var t=i,e=arguments.length;this instanceof a&&(o.prototype=n.prototype,t=new o);e=s||e?n.apply(t,s&&e?s.concat(Array.slice(arguments)):s||arguments):n.call(t);return t==i?e:t};return a},pass:function(t,e){var i=this;return null!=t&&(t=Array.convert(t)),function(){return i.apply(e,t||arguments)}},delay:function(t,e,i){return setTimeout(this.pass(null==i?[]:i,e),t)},periodical:function(t,e,i){return setInterval(this.pass(null==i?[]:i,e),t)}}),Number.implement({limit:function(t,e){return Math.min(e,Math.max(t,this))},round:function(t){return t=Math.pow(10,t||0).toFixed(t<0?-t:0),Math.round(this*t)/t},times:function(t,e){for(var i=0;i<this;i++)t.call(e,i,this)},toFloat:function(){return parseFloat(this)},toInt:function(t){return parseInt(this,t||10)}}),Number.alias("each","times"),function(){var e={};["abs","acos","asin","atan","atan2","ceil","cos","exp","floor","log","max","min","pow","sin","sqrt","tan"].each(function(t){Number[t]||(e[t]=function(){return Math[t].apply(null,[this].concat(Array.convert(arguments)))})}),Number.implement(e)}(),String.implement({contains:function(t,e){return-1<(e?String(this).slice(e):String(this)).indexOf(t)},test:function(t,e){return("regexp"==typeOf(t)?t:new RegExp(""+t,e)).test(this)},trim:function(){return String(this).replace(/^\s+|\s+$/g,"")},clean:function(){return String(this).replace(/\s+/g," ").trim()},camelCase:function(){return String(this).replace(/-\D/g,function(t){return t.charAt(1).toUpperCase()})},hyphenate:function(){return String(this).replace(/[A-Z]/g,function(t){return"-"+t.charAt(0).toLowerCase()})},capitalize:function(){return String(this).replace(/\b[a-z]/g,function(t){return t.toUpperCase()})},escapeRegExp:function(){return String(this).replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1")},toInt:function(t){return parseInt(this,t||10)},toFloat:function(){return parseFloat(this)},hexToRgb:function(t){var e=String(this).match(/^#?(\w{1,2})(\w{1,2})(\w{1,2})$/);return e?e.slice(1).hexToRgb(t):null},rgbToHex:function(t){var e=String(this).match(/\d{1,3}/g);return e?e.rgbToHex(t):null},substitute:function(i,t){return String(this).replace(t||/\\?\{([^{}]+)\}/g,function(t,e){return"\\"==t.charAt(0)?t.slice(1):null!=i[e]?i[e]:""})}}),function(){function t(t,e){t=t.toLowerCase(),e=e?e.toLowerCase():"";var i=t.match(/(edge)[\s\/:]([\w\d\.]+)/);return"trident"==(i=i||(t.match(/(opera|ie|firefox|chrome|trident|crios|version)[\s\/:]([\w\d\.]+)?.*?(safari|(?:rv[\s\/:]|version[\s\/:])([\w\d\.]+)|$)/)||[null,"unknown",0]))[1]?(i[1]="ie",i[4]&&(i[2]=i[4])):"crios"==i[1]&&(i[1]="chrome"),"win"==(e=t.match(/ip(?:ad|od|hone)/)?"ios":(t.match(/(?:webos|android)/)||t.match(/mac|win|linux/)||["other"])[0])&&(e="windows"),{extend:Function.prototype.extend,name:"version"==i[1]?i[3]:i[1],version:parseFloat("opera"==i[1]&&i[4]?i[4]:i[2]),platform:e}}var e,i=this.document,n=i.window=this,s=this.Browser=t(navigator.userAgent,navigator.platform);function o(){return new XMLHttpRequest}function a(){return new ActiveXObject("MSXML2.XMLHTTP")}function r(){return new ActiveXObject("Microsoft.XMLHTTP")}if("ie"==s.name&&i.documentMode&&(s.version=i.documentMode),s.extend({Features:{xpath:!!i.evaluate,air:!!n.runtime,query:!!i.querySelector,json:!!n.JSON},parseUA:t}),s.Request=Function.attempt(function(){return o(),o},function(){return a(),a},function(){return r(),r}),s.Features.xhr=!!s.Request,s.exec=function(t){return t&&(n.execScript?n.execScript(t):((e=i.createElement("script")).setAttribute("type","text/javascript"),e.text=t,i.head.appendChild(e),i.head.removeChild(e)),t);var e},String.implement("stripScripts",function(t){var i="",e=this.replace(/<script[^>]*>([\s\S]*?)<\/script>/gi,function(t,e){return i+=e+"\n",""});return!0===t?s.exec(i):"function"==typeOf(t)&&t(i,e),e}),s.extend({Document:this.Document,Window:this.Window,Element:this.Element,Event:this.Event}),this.Window=this.$constructor=new Type("Window",function(){}),this.$family=Function.convert("window").hide(),Window.mirror(function(t,e){n[t]=e}),this.Document=i.$constructor=new Type("Document",function(){}),i.$family=Function.convert("document").hide(),Document.mirror(function(t,e){i[t]=e}),i.html=i.documentElement,i.head||(i.head=i.getElementsByTagName("head")[0]),i.execCommand)try{i.execCommand("BackgroundImageCache",!1,!0)}catch(t){}this.attachEvent&&!this.addEventListener&&this.attachEvent("onunload",e=function(){this.detachEvent("onunload",e),i.head=i.html=i.window=null,n=this.Window=i=null});var l=Array.convert;try{l(i.html.childNodes)}catch(t){Array.convert=function(t){if("string"!=typeof t&&Type.isEnumerable(t)&&"array"!=typeOf(t)){for(var e=t.length,i=new Array(e);e--;)i[e]=t[e];return i}return l(t)};var h=Array.prototype,c=h.slice;["pop","push","reverse","shift","sort","splice","unshift","concat","join","slice"].each(function(t){var e=h[t];Array[t]=function(t){return e.apply(Array.convert(t),c.call(arguments,1))}})}}(),function(){function n(t,e,i){if(s.Mutators.hasOwnProperty(t)&&null==(e=s.Mutators[t].call(this,e)))return this;if("function"==typeOf(e)){if(e.$hidden)return this;this.prototype[t]=i?e:a(this,t,e)}else Object.merge(this.prototype,t,e);return this}var s=this.Class=new Type("Class",function(t){instanceOf(t,Function)&&(t={initialize:t});var e=function(){if(o(this),e.$prototyping)return this;this.$caller=null,this.$family=null;var t=this.initialize?this.initialize.apply(this,arguments):this;return this.$caller=this.caller=null,t}.extend(this).implement(t);return e.$constructor=s,(e.prototype.$constructor=e).prototype.parent=i,e}),i=function(){if(!this.$caller)throw new Error('The method "parent" cannot be called.');var t=this.$caller.$name,e=this.$caller.$owner.parent,e=e?e.prototype[t]:null;if(!e)throw new Error('The method "'+t+'" has no parent.');return e.apply(this,arguments)},o=function(t){for(var e in t){var i=t[e];switch(typeOf(i)){case"object":function n(){}n.prototype=i,t[e]=o(new n);break;case"array":t[e]=i.clone()}}return t},a=function(t,n,s){s.$origin&&(s=s.$origin);var o=function(){if(s.$protected&&null==this.$caller)throw new Error('The method "'+n+'" cannot be called.');var t=this.caller,e=this.$caller;this.caller=e,this.$caller=o;var i=s.apply(this,arguments);return this.$caller=e,this.caller=t,i}.extend({$owner:t,$origin:s,$name:n});return o};s.implement("implement",n.overloadSetter()),s.Mutators={Extends:function(t){this.parent=t,this.prototype=function(t){t.$prototyping=!0;var e=new t;return delete t.$prototyping,e}(t)},Implements:function(t){Array.convert(t).each(function(t){var e,i=new t;for(e in i)n.call(this,e,i[e],!0)},this)}}}(),function(){this.Chain=new Class({$chain:[],chain:function(){return this.$chain.append(Array.flatten(arguments)),this},callChain:function(){return!!this.$chain.length&&this.$chain.shift().apply(this,arguments)},clearChain:function(){return this.$chain.empty(),this}});function s(t){return t.replace(/^on([A-Z])/,function(t,e){return e.toLowerCase()})}this.Events=new Class({$events:{},addEvent:function(t,e,i){return t=s(t),this.$events[t]=(this.$events[t]||[]).include(e),i&&(e.internal=!0),this},addEvents:function(t){for(var e in t)this.addEvent(e,t[e]);return this},fireEvent:function(t,e,i){t=s(t);t=this.$events[t];return t&&(e=Array.convert(e),t.each(function(t){i?t.delay(i,this,e):t.apply(this,e)},this)),this},removeEvent:function(t,e){t=s(t);t=this.$events[t];return!t||e.internal||-1!=(e=t.indexOf(e))&&delete t[e],this},removeEvents:function(t){if("object"==typeOf(t)){for(var e in t)this.removeEvent(e,t[e]);return this}for(e in t=t&&s(t),this.$events)if(!t||t==e)for(var i=this.$events[e],n=i.length;n--;)n in i&&this.removeEvent(e,i[n]);return this}}),this.Options=new Class({setOptions:function(){var t=this.options=Object.merge.apply(null,[{},this.options].append(arguments));if(this.addEvent)for(var e in t)"function"==typeOf(t[e])&&/^on[A-Z]/.test(e)&&(this.addEvent(e,t[e]),delete t[e]);return this}})}(),function(){var o,s=0,a=1,r=2,n=Class.Thenable=new Class({$thenableState:s,$thenableResult:null,$thenableReactions:[],resolve:function(t){return l(this,t),this},reject:function(t){return c(this,t),this},getThenableState:function(){switch(this.$thenableState){case s:return"pending";case a:return"fulfilled";case r:return"rejected"}},resetThenable:function(t){return c(this,t),(t=this).$thenableState!==s&&(t.$thenableResult=null,t.$thenableState=s),this},then:function(t,e){"function"!=typeof t&&(t="Identity"),"function"!=typeof e&&(e="Thrower");var i=new n;return this.$thenableReactions.push({thenable:i,fulfillHandler:t,rejectHandler:e}),this.$thenableState!==s&&u(this),i},catch:function(t){return this.then(null,t)}});function l(e,t){if(e.$thenableState===s)if(e===t)c(e,new TypeError("Tried to resolve a thenable with itself."));else if(!t||"object"!=typeof t&&"function"!=typeof t)h(e,t);else{var i,n;try{i=t.then}catch(t){c(e,t)}"function"==typeof i?(n=!1,o(function(){try{i.call(t,function(t){n||(n=!0,l(e,t))},function(t){n||(n=!0,c(e,t))})}catch(t){n||(n=!0,c(e,t))}})):h(e,t)}}function h(t,e){t.$thenableState===s&&(t.$thenableResult=e,t.$thenableState=a,u(t))}function c(t,e){t.$thenableState===s&&(t.$thenableResult=e,t.$thenableState=r,u(t))}function u(t){var e,i=t.$thenableState,n=t.$thenableResult,s=t.$thenableReactions;i===a?(t.$thenableReactions=[],e="fulfillHandler"):i==r&&(t.$thenableReactions=[],e="rejectHandler"),e&&o(function(t,e,i){for(var n=0,s=e.length;n<s;++n){var o=e[n],a=o[i];if("Identity"===a)l(o.thenable,t);else if("Thrower"===a)c(o.thenable,t);else try{l(o.thenable,a(t))}catch(t){c(o.thenable,t)}}}.pass([n,s,e]))}n.extend({resolve:function(t){var e;return t instanceof n?e=t:l(e=new n,t),e},reject:function(t){var e=new n;return c(e,t),e}}),o="undefined"!=typeof process&&"function"==typeof process.nextTick?process.nextTick:"undefined"!=typeof setImmediate?setImmediate:function(t){setTimeout(t,0)}}(),Object.extend({subset:function(t,e){for(var i={},n=0,s=e.length;n<s;n++){var o=e[n];o in t&&(i[o]=t[o])}return i},map:function(t,e,i){for(var n={},s=Object.keys(t),o=0;o<s.length;o++){var a=s[o];n[a]=e.call(i,t[a],a,t)}return n},filter:function(t,e,i){for(var n={},s=Object.keys(t),o=0;o<s.length;o++){var a=s[o],r=t[a];e.call(i,r,a,t)&&(n[a]=r)}return n},every:function(t,e,i){for(var n=Object.keys(t),s=0;s<n.length;s++){var o=n[s];if(!e.call(i,t[o],o))return!1}return!0},some:function(t,e,i){for(var n=Object.keys(t),s=0;s<n.length;s++){var o=n[s];if(e.call(i,t[o],o))return!0}return!1},values:function(t){for(var e=[],i=Object.keys(t),n=0;n<i.length;n++){var s=i[n];e.push(t[s])}return e},getLength:function(t){return Object.keys(t).length},keyOf:function(t,e){for(var i=Object.keys(t),n=0;n<i.length;n++){var s=i[n];if(t[s]===e)return s}return null},contains:function(t,e){return null!=Object.keyOf(t,e)},toQueryString:function(t,s){var o=[];return Object.each(t,function(t,e){var i;switch(s&&(e=s+"["+e+"]"),typeOf(t)){case"object":i=Object.toQueryString(t,e);break;case"array":var n={};t.each(function(t,e){n[e]=t}),i=Object.toQueryString(n,e);break;default:i=e+"="+encodeURIComponent(t)}null!=t&&o.push(i)}),o.join("&")}}),function(){var y,b,w,_,i={},n={},E=/\\/g,s=function(t,e){if(null==t)return null;if(!0===t.Slick)return t;t=(""+t).replace(/^\s+|\s+$/g,"");e=(_=!!e)?n:i;if(e[t])return e[t];for(y={Slick:!0,expressions:[],raw:t,reverse:function(){return s(this.raw,!0)}},b=-1;t!=(t=t.replace(a,r)););return y.length=y.expressions.length,e[y.raw]=_?o(y):y},S=function(t){return"!"===t?" ":" "===t?"!":/^!/.test(t)?t.replace(/^!/,""):"!"+t},o=function(t){for(var e=t.expressions,i=0;i<e.length;i++){for(var n=e[i],s={parts:[],tag:"*",combinator:S(n[0].combinator)},o=0;o<n.length;o++){var a=n[o];a.reverseCombinator||(a.reverseCombinator=" "),a.combinator=a.reverseCombinator,delete a.reverseCombinator}n.reverse().push(s)}return t},x=function(t){return t.replace(/[-[\]{}()*+?.\\^$|,#\s]/g,function(t){return"\\"+t})},a=new RegExp("^(?:\\s*(,)\\s*|\\s*(<combinator>+)\\s*|(\\s+)|(<unicode>+|\\*)|\\#(<unicode>+)|\\.(<unicode>+)|\\[\\s*(<unicode1>+)(?:\\s*([*^$!~|]?=)(?:\\s*(?:([\"']?)(.*?)\\9)))?\\s*\\](?!\\])|(:+)(<unicode>+)(?:\\((?:(?:([\"'])([^\\13]*)\\13)|((?:\\([^)]+\\)|[^()]*)+))\\))?)".replace(/<combinator>/,"["+x(">+~`!@$%^&={}\\;</")+"]").replace(/<unicode>/g,"(?:[\\w\\u00a1-\\uFFFF-]|\\\\[^\\s0-9a-f])").replace(/<unicode1>/g,"(?:[:\\w\\u00a1-\\uFFFF-]|\\\\[^\\s0-9a-f])"));function r(t,e,i,n,s,o,a,r,l,h,c,u,d,p,m,f){if((e||-1===b)&&(y.expressions[++b]=[],w=-1,e))return"";(i||n||-1===w)&&(i=i||" ",n=y.expressions[b],_&&n[w]&&(n[w].reverseCombinator=S(i)),n[++w]={combinator:i,tag:"*"});var g,v,i=y.expressions[b][w];if(s)i.tag=s.replace(E,"");else if(o)i.id=o.replace(E,"");else if(a)a=a.replace(E,""),i.classList||(i.classList=[]),i.classes||(i.classes=[]),i.classList.push(a),i.classes.push({value:a,regexp:new RegExp("(^|\\s)"+x(a)+"(\\s|$)")});else if(d)f=(f=f||m)?f.replace(E,""):null,i.pseudos||(i.pseudos=[]),i.pseudos.push({key:d.replace(E,""),value:f,type:1==u.length?"class":"element"});else if(r){switch(r=r.replace(E,""),c=(c||"").replace(E,""),l){case"^=":v=new RegExp("^"+x(c));break;case"$=":v=new RegExp(x(c)+"$");break;case"~=":v=new RegExp("(^|\\s)"+x(c)+"(\\s|$)");break;case"|=":v=new RegExp("^"+x(c)+"(-|$)");break;case"=":g=function(t){return c==t};break;case"*=":g=function(t){return t&&-1<t.indexOf(c)};break;case"!=":g=function(t){return c!=t};break;default:g=function(t){return!!t}}g=(g=""==c&&/^[*$^]=$/.test(l)?function(){return!1}:g)||function(t){return t&&v.test(t)},i.attributes||(i.attributes=[]),i.attributes.push({key:r,operator:l,value:c,test:g})}return""}var t=this.Slick||{};t.parse=function(t){return s(t)},t.escapeRegExp=x,this.Slick||(this.Slick=t)}.apply("undefined"!=typeof exports?exports:this),function(){var n={},p={},e=Object.prototype.toString;n.isNativeCode=function(t){return/\{\s*\[native code\]\s*\}/.test(""+t)},n.isXML=function(t){return!!t.xmlVersion||!!t.xml||"[object XMLDocument]"==e.call(t)||9==t.nodeType&&"HTML"!=t.documentElement.nodeName},n.setDocument=function(i){var t=i.nodeType;if(9!=t)if(t)i=i.ownerDocument;else{if(!i.navigator)return;i=i.document}if(this.document!==i){var e,n,s,o,a=(this.document=i).documentElement,r=this.getUIDXML(a),l=p[r];if(l)for(e in l)this[e]=l[e];else{(l=p[r]={}).root=a,l.isXMLDocument=this.isXML(i),l.brokenStarGEBTN=l.starSelectsClosedQSA=l.idGetsName=l.brokenMixedCaseQSA=l.brokenGEBCN=l.brokenCheckedQSA=l.brokenEmptyAttributeQSA=l.isHTMLDocument=l.nativeMatchesSelector=!1;var h,c="slick_uniqueid",u=i.createElement("div"),t=i.body||i.getElementsByTagName("body")[0]||a;t.appendChild(u);try{u.innerHTML='<a id="'+c+'"></a>',l.isHTMLDocument=!!i.getElementById(c)}catch(t){}if(l.isHTMLDocument){u.style.display="none",u.appendChild(i.createComment("")),r=1<u.getElementsByTagName("*").length;try{u.innerHTML="foo</foo>",n=(h=u.getElementsByTagName("*"))&&!!h.length&&"/"==h[0].nodeName.charAt(0)}catch(t){}l.brokenStarGEBTN=r||n;try{u.innerHTML='<a name="'+c+'"></a><b id="'+c+'"></b>',l.idGetsName=i.getElementById(c)===u.firstChild}catch(t){}if(u.getElementsByClassName){try{u.innerHTML='<a class="f"></a><a class="b"></a>',u.getElementsByClassName("b").length,u.firstChild.className="b",o=2!=u.getElementsByClassName("b").length}catch(t){}try{u.innerHTML='<a class="a"></a><a class="f b a"></a>',s=2!=u.getElementsByClassName("a").length}catch(t){}l.brokenGEBCN=o||s}if(u.querySelectorAll){try{u.innerHTML="foo</foo>",h=u.querySelectorAll("*"),l.starSelectsClosedQSA=h&&!!h.length&&"/"==h[0].nodeName.charAt(0)}catch(t){}try{u.innerHTML='<a class="MiX"></a>',l.brokenMixedCaseQSA=!u.querySelectorAll(".MiX").length}catch(t){}try{u.innerHTML='<select><option selected="selected">a</option></select>',l.brokenCheckedQSA=0==u.querySelectorAll(":checked").length}catch(t){}try{u.innerHTML='<a class=""></a>',l.brokenEmptyAttributeQSA=0!=u.querySelectorAll('[class*=""]').length}catch(t){}}try{u.innerHTML='<form action="s"><input id="action"/></form>',d="s"!=u.firstChild.getAttribute("action")}catch(t){}if(l.nativeMatchesSelector=a.matches||a.mozMatchesSelector||a.webkitMatchesSelector,l.nativeMatchesSelector)try{l.nativeMatchesSelector.call(a,":slick"),l.nativeMatchesSelector=null}catch(t){}}try{a.slick_expando=1,delete a.slick_expando,l.getUID=this.getUIDHTML}catch(t){l.getUID=this.getUIDXML}t.removeChild(u),u=h=t=null,l.getAttribute=l.isHTMLDocument&&d?function(t,e){var i=this.attributeGetters[e];if(i)return i.call(t);e=t.getAttributeNode(e);return e?e.nodeValue:null}:function(t,e){var i=this.attributeGetters[e];return i?i.call(t):t.getAttribute(e)},l.hasAttribute=a&&this.isNativeCode(a.hasAttribute)?function(t,e){return t.hasAttribute(e)}:function(t,e){return!(!(t=t.getAttributeNode(e))||!t.specified&&!t.nodeValue)};var u=a&&this.isNativeCode(a.contains),d=i&&this.isNativeCode(i.contains);for(e in l.contains=u&&d?function(t,e){return t.contains(e)}:u&&!d?function(t,e){return t===e||(t===i?i.documentElement:t).contains(e)}:a&&a.compareDocumentPosition?function(t,e){return t===e||!!(16&t.compareDocumentPosition(e))}:function(t,e){if(e)do{if(e===t)return!0}while(e=e.parentNode);return!1},l.documentSorter=a.compareDocumentPosition?function(t,e){return t.compareDocumentPosition&&e.compareDocumentPosition?4&t.compareDocumentPosition(e)?-1:t===e?0:1:0}:"sourceIndex"in a?function(t,e){return t.sourceIndex&&e.sourceIndex?t.sourceIndex-e.sourceIndex:0}:i.createRange?function(t,e){if(!t.ownerDocument||!e.ownerDocument)return 0;var i=t.ownerDocument.createRange(),n=e.ownerDocument.createRange();return i.setStart(t,0),i.setEnd(t,0),n.setStart(e,0),n.setEnd(e,0),i.compareBoundaryPoints(Range.START_TO_END,n)}:null,a=null,l)this[e]=l[e]}}};var N=/^([#.]?)((?:[\w-]+|\*))$/,A=/\[.+[*$^]=(?:""|'')?\]/,D={};n.search=function(t,e,i,n){var s=this.found=n?null:i||[];if(!t)return s;if(t.navigator)t=t.document;else if(!t.nodeType)return s;var o,a,r,l,h,c,u,d,p,m,f,g,v=this.uniques={},y=!(!i||!i.length),b=9==t.nodeType;if(this.document!==(b?t:t.ownerDocument)&&this.setDocument(t),y)for(k=s.length;k--;)v[this.getUID(s[k])]=!0;if("string"==typeof e){var w=e.match(N);t:if(w){var _=w[1],E=w[2];if(_){if("#"==_){if(!this.isHTMLDocument||!b)break t;if(!(a=t.getElementById(E)))return s;if(this.idGetsName&&a.getAttributeNode("id").nodeValue!=E)break t;if(n)return a||null;y&&v[this.getUID(a)]||s.push(a)}else if("."==_){if(!this.isHTMLDocument||(!t.getElementsByClassName||this.brokenGEBCN)&&t.querySelectorAll)break t;if(t.getElementsByClassName&&!this.brokenGEBCN){if(x=t.getElementsByClassName(E),n)return x[0]||null;for(k=0;a=x[k++];)y&&v[this.getUID(a)]||s.push(a)}else for(var S=new RegExp("(^|\\s)"+P.escapeRegExp(E)+"(\\s|$)"),x=t.getElementsByTagName("*"),k=0;a=x[k++];)if(className=a.className,className&&S.test(className)){if(n)return a;y&&v[this.getUID(a)]||s.push(a)}}}else{if("*"==E&&this.brokenStarGEBTN)break t;if(x=t.getElementsByTagName(E),n)return x[0]||null;for(k=0;a=x[k++];)y&&v[this.getUID(a)]||s.push(a)}return y&&this.sort(s),n?null:s}t:if(t.querySelectorAll&&!(!this.isHTMLDocument||D[e]||this.brokenMixedCaseQSA||this.brokenCheckedQSA&&-1<e.indexOf(":checked")||this.brokenEmptyAttributeQSA&&A.test(e)||!b&&-1<e.indexOf(",")||P.disableQSA)){var C,O=e,$=t;b||(C=$.getAttribute("id"),slickid="slickid__",$.setAttribute("id",slickid),O="#"+slickid+" "+O,t=$.parentNode);try{if(n)return t.querySelector(O)||null;x=t.querySelectorAll(O)}catch(t){D[e]=1;break t}finally{b||(C?$.setAttribute("id",C):$.removeAttribute("id"),t=$)}if(this.starSelectsClosedQSA)for(k=0;a=x[k++];)!("@"<a.nodeName)||y&&v[this.getUID(a)]||s.push(a);else for(k=0;a=x[k++];)y&&v[this.getUID(a)]||s.push(a);return y&&this.sort(s),s}if(!(o=this.Slick.parse(e)).length)return s}else{if(null==e)return s;if(!e.Slick)return this.contains(t.documentElement||t,e)&&(s?s.push(e):s=e),s;o=e}this.posNTH={},this.posNTHLast={},this.posNTHType={},this.posNTHTypeLast={},this.push=!y&&(n||1==o.length&&1==o.expressions[0].length)?this.pushArray:this.pushUID,null==s&&(s=[]);var I,T,L,M=o.expressions;t:for(k=0;T=M[k];k++)for(r=0;L=T[r];r++){if(!this[c="combinator:"+L.combinator])continue t;if(u=this.isXMLDocument?L.tag:L.tag.toUpperCase(),d=L.id,p=L.classList,m=L.classes,f=L.attributes,g=L.pseudos,L=r===T.length-1,this.bitUniques={},L?(this.uniques=v,this.found=s):(this.uniques={},this.found=[]),0===r){if(this[c](t,u,d,m,f,g,p),n&&L&&s.length)break t}else if(n&&L){for(l=0,h=I.length;l<h;l++)if(this[c](I[l],u,d,m,f,g,p),s.length)break t}else for(l=0,h=I.length;l<h;l++)this[c](I[l],u,d,m,f,g,p);I=this.found}return(y||1<o.expressions.length)&&this.sort(s),n?s[0]||null:s},n.uidx=1,n.uidk="slick-uniqueid",n.getUIDXML=function(t){var e=t.getAttribute(this.uidk);return e||(e=this.uidx++,t.setAttribute(this.uidk,e)),e},n.getUIDHTML=function(t){return t.uniqueNumber||(t.uniqueNumber=this.uidx++)},n.sort=function(t){return this.documentSorter&&t.sort(this.documentSorter),t},n.cacheNTH={},n.matchNTH=/^([+-]?\d*)?([a-z]+)?([+-]\d+)?$/,n.parseNTHArgument=function(t){var e=t.match(this.matchNTH);if(!e)return!1;var i=e[2]||!1,n=e[1]||1;"-"==n&&(n=-1);var s=+e[3]||0;return this.cacheNTH[t]=e="n"==i?{a:n,b:s}:"odd"==i?{a:2,b:1}:"even"==i?{a:2,b:0}:{a:0,b:n}},n.createNTHPseudo=function(r,l,h,c){return function(t,e){var i=this.getUID(t);if(!this[h][i]){var n=t.parentNode;if(!n)return!1;var s=n[r],o=1;if(c)for(var a=t.nodeName;s.nodeName==a&&(this[h][this.getUID(s)]=o++),s=s[l];);else for(;1==s.nodeType&&(this[h][this.getUID(s)]=o++),s=s[l];);}t=this.cacheNTH[e=e||"n"]||this.parseNTHArgument(e);if(!t)return!1;e=t.a,t=t.b,i=this[h][i];if(0==e)return t==i;if(0<e){if(i<t)return!1}else if(t<i)return!1;return(i-t)%e==0}},n.pushArray=function(t,e,i,n,s,o){this.matchSelector(t,e,i,n,s,o)&&this.found.push(t)},n.pushUID=function(t,e,i,n,s,o){var a=this.getUID(t);!this.uniques[a]&&this.matchSelector(t,e,i,n,s,o)&&(this.uniques[a]=!0,this.found.push(t))},n.matchNode=function(t,e){if(this.isHTMLDocument&&this.nativeMatchesSelector)try{return this.nativeMatchesSelector.call(t,e.replace(/\[([^=]+)=\s*([^'"\]]+?)\s*\]/g,'[$1="$2"]'))}catch(t){}e=this.Slick.parse(e);if(!e)return!0;for(var i=e.expressions,n=0,s=0;o=i[s];s++)if(1==o.length){var o=o[0];if(this.matchSelector(t,this.isXMLDocument?o.tag:o.tag.toUpperCase(),o.id,o.classes,o.attributes,o.pseudos))return!0;n++}if(n==e.length)return!1;var a,r=this.search(this.document,e);for(s=0;a=r[s++];)if(a===t)return!0;return!1},n.matchPseudo=function(t,e,i){var n="pseudo:"+e;if(this[n])return this[n](t,i);e=this.getAttribute(t,e);return i?i==e:!!e},n.matchSelector=function(t,e,i,n,s,o){if(e){var a=this.isXMLDocument?t.nodeName:t.nodeName.toUpperCase();if("*"==e){if(a<"@")return!1}else if(a!=e)return!1}if(i&&t.getAttribute("id")!=i)return!1;var r,l,h;if(n)for(r=n.length;r--;)if(!(h=this.getAttribute(t,"class"))||!n[r].regexp.test(h))return!1;if(s)for(r=s.length;r--;)if((l=s[r]).operator?!l.test(this.getAttribute(t,l.key)):!this.hasAttribute(t,l.key))return!1;if(o)for(r=o.length;r--;)if(l=o[r],!this.matchPseudo(t,l.key,l.value))return!1;return!0};var t,i={" ":function(t,e,i,n,s,o,a){var r,l,h;if(this.isHTMLDocument){if(i){if(!(l=this.document.getElementById(i))&&t.all||this.idGetsName&&l&&l.getAttributeNode("id").nodeValue!=i){if(!(h=t.all[i]))return;for(h[0]||(h=[h]),r=0;l=h[r++];){var c=l.getAttributeNode("id");if(c&&c.nodeValue==i){this.push(l,e,null,n,s,o);break}}return}if(l)return this.document===t||this.contains(t,l)?void this.push(l,e,null,n,s,o):void 0;if(this.contains(this.root,t))return}if(n&&t.getElementsByClassName&&!this.brokenGEBCN&&(h=t.getElementsByClassName(a.join(" ")))&&h.length){for(r=0;l=h[r++];)this.push(l,e,i,null,s,o);return}}if((h=t.getElementsByTagName(e))&&h.length)for(this.brokenStarGEBTN||(e=null),r=0;l=h[r++];)this.push(l,e,i,n,s,o)},">":function(t,e,i,n,s,o){if(t=t.firstChild)for(;1==t.nodeType&&this.push(t,e,i,n,s,o),t=t.nextSibling;);},"+":function(t,e,i,n,s,o){for(;t=t.nextSibling;)if(1==t.nodeType){this.push(t,e,i,n,s,o);break}},"^":function(t,e,i,n,s,o){(t=t.firstChild)&&(1==t.nodeType?this.push(t,e,i,n,s,o):this["combinator:+"](t,e,i,n,s,o))},"~":function(t,e,i,n,s,o){for(;t=t.nextSibling;)if(1==t.nodeType){var a=this.getUID(t);if(this.bitUniques[a])break;this.bitUniques[a]=!0,this.push(t,e,i,n,s,o)}},"++":function(t,e,i,n,s,o){this["combinator:+"](t,e,i,n,s,o),this["combinator:!+"](t,e,i,n,s,o)},"~~":function(t,e,i,n,s,o){this["combinator:~"](t,e,i,n,s,o),this["combinator:!~"](t,e,i,n,s,o)},"!":function(t,e,i,n,s,o){for(;t=t.parentNode;)t!==this.document&&this.push(t,e,i,n,s,o)},"!>":function(t,e,i,n,s,o){(t=t.parentNode)!==this.document&&this.push(t,e,i,n,s,o)},"!+":function(t,e,i,n,s,o){for(;t=t.previousSibling;)if(1==t.nodeType){this.push(t,e,i,n,s,o);break}},"!^":function(t,e,i,n,s,o){(t=t.lastChild)&&(1==t.nodeType?this.push(t,e,i,n,s,o):this["combinator:!+"](t,e,i,n,s,o))},"!~":function(t,e,i,n,s,o){for(;t=t.previousSibling;)if(1==t.nodeType){var a=this.getUID(t);if(this.bitUniques[a])break;this.bitUniques[a]=!0,this.push(t,e,i,n,s,o)}}};for(t in i)n["combinator:"+t]=i[t];var s,o={empty:function(t){var e=t.firstChild;return!(e&&1==e.nodeType||(t.innerText||t.textContent||"").length)},not:function(t,e){return!this.matchNode(t,e)},contains:function(t,e){return-1<(t.innerText||t.textContent||"").indexOf(e)},"first-child":function(t){for(;t=t.previousSibling;)if(1==t.nodeType)return!1;return!0},"last-child":function(t){for(;t=t.nextSibling;)if(1==t.nodeType)return!1;return!0},"only-child":function(t){for(var e=t;e=e.previousSibling;)if(1==e.nodeType)return!1;for(var i=t;i=i.nextSibling;)if(1==i.nodeType)return!1;return!0},"nth-child":n.createNTHPseudo("firstChild","nextSibling","posNTH"),"nth-last-child":n.createNTHPseudo("lastChild","previousSibling","posNTHLast"),"nth-of-type":n.createNTHPseudo("firstChild","nextSibling","posNTHType",!0),"nth-last-of-type":n.createNTHPseudo("lastChild","previousSibling","posNTHTypeLast",!0),index:function(t,e){return this["pseudo:nth-child"](t,""+(e+1))},even:function(t){return this["pseudo:nth-child"](t,"2n")},odd:function(t){return this["pseudo:nth-child"](t,"2n+1")},"first-of-type":function(t){for(var e=t.nodeName;t=t.previousSibling;)if(t.nodeName==e)return!1;return!0},"last-of-type":function(t){for(var e=t.nodeName;t=t.nextSibling;)if(t.nodeName==e)return!1;return!0},"only-of-type":function(t){for(var e=t,i=t.nodeName;e=e.previousSibling;)if(e.nodeName==i)return!1;for(var n=t;n=n.nextSibling;)if(n.nodeName==i)return!1;return!0},enabled:function(t){return!t.disabled},disabled:function(t){return t.disabled},checked:function(t){return t.checked||t.selected},focus:function(t){return this.isHTMLDocument&&this.document.activeElement===t&&(t.href||t.type||this.hasAttribute(t,"tabindex"))},root:function(t){return t===this.root},selected:function(t){return t.selected}};for(s in o)n["pseudo:"+s]=o[s];var a=n.attributeGetters={for:function(){return"htmlFor"in this?this.htmlFor:this.getAttribute("for")},href:function(){return"href"in this?this.getAttribute("href",2):this.getAttribute("href")},style:function(){return this.style?this.style.cssText:this.getAttribute("style")},tabindex:function(){var t=this.getAttributeNode("tabindex");return t&&t.specified?t.nodeValue:null},type:function(){return this.getAttribute("type")},maxlength:function(){var t=this.getAttributeNode("maxLength");return t&&t.specified?t.nodeValue:null}};a.MAXLENGTH=a.maxLength=a.maxlength;var P=n.Slick=this.Slick||{};P.version="1.1.7",P.search=function(t,e,i){return n.search(t,e,i)},P.find=function(t,e){return n.search(t,e,null,!0)},P.contains=function(t,e){return n.setDocument(t),n.contains(t,e)},P.getAttribute=function(t,e){return n.setDocument(t),n.getAttribute(t,e)},P.hasAttribute=function(t,e){return n.setDocument(t),n.hasAttribute(t,e)},P.match=function(t,e){return!(!t||!e)&&(!e||e===t||(n.setDocument(t),n.matchNode(t,e)))},P.defineAttributeGetter=function(t,e){return n.attributeGetters[t]=e,this},P.lookupAttributeGetter=function(t){return n.attributeGetters[t]},P.definePseudo=function(t,i){return n["pseudo:"+t]=function(t,e){return i.call(t,e)},this},P.lookupPseudo=function(t){var e=n["pseudo:"+t];return e?function(t){return e.call(this,t)}:null},P.override=function(t,e){return n.override(t,e),this},P.isXML=n.isXML,P.uidOf=function(t){return n.getUIDHTML(t)},this.Slick||(this.Slick=P)}.apply("undefined"!=typeof exports?exports:this);var Element=this.Element=function(t,e){var i=Element.Constructors[t];if(i)return i(e);if("string"!=typeof t)return document.id(t).set(e);if(e=e||{},!/^[\w-]+$/.test(t)){i=Slick.parse(t).expressions[0][0];t="*"==i.tag?"div":i.tag,i.id&&null==e.id&&(e.id=i.id);var n=i.attributes;if(n)for(var s,o=0,a=n.length;o<a;o++)null==e[(s=n[o]).key]&&(null!=s.value&&"="==s.operator?e[s.key]=s.value:s.value||s.operator||(e[s.key]=!0));i.classList&&null==e.class&&(e.class=i.classList.join(" "))}return document.newElement(t,e)};Browser.Element&&(Element.prototype=Browser.Element.prototype,Element.prototype._fireEvent=function(i){return function(t,e){return i.call(this,t,e)}}(Element.prototype.fireEvent)),new Type("Element",Element).mirror(function(a){var t;Array.prototype[a]||((t={})[a]=function(){for(var t=[],e=arguments,i=!0,n=0,s=this.length;n<s;n++)var o=this[n],o=t[n]=o[a].apply(o,e),i=i&&"element"==typeOf(o);return i?new Elements(t):t},Elements.implement(t))}),Browser.Element||(Element.parent=Object,Element.Prototype={$constructor:Element,$family:Function.convert("element").hide()},Element.mirror(function(t,e){Element.Prototype[t]=e})),Element.Constructors={};var IFrame=new Type("IFrame",function(){var t=Array.link(arguments,{properties:Type.isObject,iframe:function(t){return null!=t}}),e=t.properties||{};t.iframe&&(s=document.id(t.iframe));var i=e.onload||function(){};delete e.onload,e.id=e.name=[e.id,e.name,s?s.id||s.name:"IFrame_"+String.uniqueID()].pick();function n(){i.call(s.contentWindow)}var s=new Element(s||"iframe",e);return window.frames[e.id]?n():s.addListener("load",n),s}),Elements=this.Elements=function(t){if(t&&t.length)for(var e,i={},n=0;e=t[n++];){var s=Slick.uidOf(e);i[s]||(i[s]=!0,this.push(e))}};Elements.prototype={length:0},Elements.parent=Array,new Type("Elements",Elements).implement({filter:function(e,t){return e?new Elements(Array.filter(this,"string"==typeOf(e)?function(t){return t.match(e)}:e,t)):this}.protect(),push:function(){for(var t=this.length,e=0,i=arguments.length;e<i;e++){var n=document.id(arguments[e]);n&&(this[t++]=n)}return this.length=t}.protect(),unshift:function(){for(var t=[],e=0,i=arguments.length;e<i;e++){var n=document.id(arguments[e]);n&&t.push(n)}return Array.prototype.unshift.apply(this,t)}.protect(),concat:function(){for(var t=new Elements(this),e=0,i=arguments.length;e<i;e++){var n=arguments[e];Type.isEnumerable(n)?t.append(n):t.push(n)}return t}.protect(),append:function(t){for(var e=0,i=t.length;e<i;e++)this.push(t[e]);return this}.protect(),empty:function(){for(;this.length;)delete this[--this.length];return this}.protect()}),function(){var n,i=Array.prototype.splice,t={0:0,1:1,length:2};i.call(t,1,1),1==t[1]&&Elements.implement("splice",function(){for(var t=this.length,e=i.apply(this,arguments);t>=this.length;)delete this[t--];return e}.protect()),Array.forEachMethod(function(t,e){Elements.implement(e,t)}),Array.mirror(Elements);try{n="x"==document.createElement("<input name=x>").name}catch(t){}function s(t){return(""+t).replace(/&/g,"&amp;").replace(/"/g,"&quot;")}var o=function(){var t=document.createElement("style"),e=!1;try{t.innerHTML="#justTesing{margin: 0px;}",e=!!t.innerHTML}catch(t){}return e}();Document.implement({newElement:function(t,e){if(e){if(null!=e.checked&&(e.defaultChecked=e.checked),"checkbox"!=e.type&&"radio"!=e.type||null!=e.value||(e.value="on"),!o&&"style"==t){var i=document.createElement("style");return i.setAttribute("type","text/css"),e.type&&delete e.type,this.id(i).set(e)}n&&(t="<"+t,e.name&&(t+=' name="'+s(e.name)+'"'),e.type&&(t+=' type="'+s(e.type)+'"'),t+=">",delete e.name,delete e.type)}return this.id(this.createElement(t)).set(e)}})}(),function(){var s;Slick.uidOf(window),Slick.uidOf(document),Document.implement({newTextNode:function(t){return this.createTextNode(t)},getDocument:function(){return this},getWindow:function(){return this.window},id:((s={string:function(t,e,i){return(t=Slick.find(i,"#"+t.replace(/(\W)/g,"\\$1")))?s.element(t,e):null},element:function(t,e){var i;return Slick.uidOf(t),e||t.$family||/^(?:object|embed)$/i.test(t.tagName)||(i=t.fireEvent,t._fireEvent=function(t,e){return i(t,e)},Object.append(t,Element.Prototype)),t},object:function(t,e,i){return t.toElement?s.element(t.toElement(i),e):null}}).textnode=s.whitespace=s.window=s.document=function(t){return t},function(t,e,i){if(t&&t.$family&&t.uniqueNumber)return t;var n=typeOf(t);return s[n]?s[n](t,e,i||document):null})}),null==window.$&&Window.implement("$",function(t,e){return document.id(t,e,this.document)}),Window.implement({getDocument:function(){return this.document},getWindow:function(){return this}}),[Document,Element].invoke("implement",{getElements:function(t){return Slick.search(this,t,new Elements)},getElement:function(t){return document.id(Slick.find(this,t))}});var t={contains:function(t){return Slick.contains(this,t)}};document.contains||Document.implement(t),document.createElement("div").contains||Element.implement(t);function i(t,e){if(!t)return e;for(var i=(t=Object.clone(Slick.parse(t))).expressions,n=i.length;n--;)i[n][0].combinator=e;return t}Object.forEach({getNext:"~",getPrevious:"!~",getParent:"!"},function(e,t){Element.implement(t,function(t){return this.getElement(i(t,e))})}),Object.forEach({getAllNext:"~",getAllPrevious:"!~",getSiblings:"~~",getChildren:">",getParents:"!"},function(e,t){Element.implement(t,function(t){return this.getElements(i(t,e))})}),Element.implement({getFirst:function(t){return document.id(Slick.search(this,i(t,">"))[0])},getLast:function(t){return document.id(Slick.search(this,i(t,">")).getLast())},getWindow:function(){return this.ownerDocument.window},getDocument:function(){return this.ownerDocument},getElementById:function(t){return document.id(Slick.find(this,"#"+(""+t).replace(/(\W)/g,"\\$1")))},match:function(t){return!t||Slick.match(this,t)}}),null==window.$$&&Window.implement("$$",function(t){if(1==arguments.length){if("string"==typeof t)return Slick.search(this.document,t,new Elements);if(Type.isEnumerable(t))return new Elements(t)}return new Elements(arguments)});var a={before:function(t,e){var i=e.parentNode;i&&i.insertBefore(t,e)},after:function(t,e){var i=e.parentNode;i&&i.insertBefore(t,e.nextSibling)},bottom:function(t,e){e.appendChild(t)},top:function(t,e){e.insertBefore(t,e.firstChild)}};a.inside=a.bottom;var e,n={},o={},r={};Array.forEach(["type","value","defaultValue","accessKey","cellPadding","cellSpacing","colSpan","frameBorder","rowSpan","tabIndex","useMap"],function(t){r[t.toLowerCase()]=t}),r.html="innerHTML",r.text=null==document.createElement("div").textContent?"innerText":"textContent",Object.forEach(r,function(i,t){o[t]=function(t,e){t[i]=e},n[t]=function(t){return t[i]}}),o.text=(o.text,function(t,e){"style"==t.get("tag")?t.set("html",e):t[r.text]=e}),n.text=(e=n.text,function(t){return"style"==t.get("tag")?t.innerHTML:e(t)});var h={};Array.forEach(["compact","nowrap","ismap","declare","noshade","checked","disabled","readOnly","multiple","selected","noresize","defer","defaultChecked","autofocus","controls","autoplay","loop"],function(i){var t=i.toLowerCase();h[t]=i,o[t]=function(t,e){t[i]=!!e},n[t]=function(t){return!!t[i]}}),Object.append(o,{class:function(t,e){"className"in t?t.className=e||"":t.setAttribute("class",e)},for:function(t,e){"htmlFor"in t?t.htmlFor=e:t.setAttribute("for",e)},style:function(t,e){t.style?t.style.cssText=e:t.setAttribute("style",e)},value:function(t,e){t.value=null!=e?e:""}}),n.class=function(t){return"className"in t?t.className||null:t.getAttribute("class")};var c=document.createElement("button");try{c.type="button"}catch(t){}"button"!=c.type&&(o.type=function(t,e){t.setAttribute("type",e)});var c=null,u=function(){var t=document.createElement("style"),e=!1;try{t.innerHTML="#justTesing{margin: 0px;}",e=!!t.innerHTML}catch(t){}return e}(),t=document.createElement("input");t.value="t",t.type="submit",c="t"!=t.value;try{t.value="",v=(t.type="email")==t.type}catch(t){}t=null,!c&&v||(o.type=function(t,e){try{var i=t.value;t.type=e,t.value=i}catch(t){}});function d(t){var t=(t||"").clean().split(" "),e={};return t.filter(function(t){if(""!==t&&!e[t])return e[t]=t})}function p(t){this.classList.add(t)}function m(t){this.classList.remove(t)}var f=((t=document.createElement("div")).random="attribute")==t.getAttribute("random"),g=((c=document.createElement("div")).innerHTML='<object><param name="should_fix" value="the unknown" /></object>',1!=c.cloneNode(!0).firstChild.childNodes.length),v=!!document.createElement("div").classList;Element.implement({setProperty:function(t,e){var i,n=o[t.toLowerCase()];return n?n(this,e):(f&&(i=this.retrieve("$attributeWhiteList",{})),null==e?(this.removeAttribute(t),f&&delete i[t]):(this.setAttribute(t,""+e),f&&(i[t]=!0))),this},setProperties:function(t){for(var e in t)this.setProperty(e,t[e]);return this},getProperty:function(t){var e=n[t.toLowerCase()];if(e)return e(this);if(f){var e=this.getAttributeNode(t),i=this.retrieve("$attributeWhiteList",{});if(!e)return null;if(e.expando&&!i[t]){e=this.outerHTML;if(e.substr(0,e.search(/\/?['"]?>(?![^<]*<['"])/)).indexOf(t)<0)return null;i[t]=!0}}i=Slick.getAttribute(this,t);return i||Slick.hasAttribute(this,t)?i:null},getProperties:function(){var t=Array.convert(arguments);return t.map(this.getProperty,this).associate(t)},removeProperty:function(t){return this.setProperty(t,null)},removeProperties:function(){return Array.each(arguments,this.removeProperty,this),this},set:function(t,e){var i=Element.Properties[t];i&&i.set?i.set.call(this,e):this.setProperty(t,e)}.overloadSetter(),get:function(t){var e=Element.Properties[t];return e&&e.get?e.get.apply(this):this.getProperty(t)}.overloadGetter(),erase:function(t){var e=Element.Properties[t];return e&&e.erase?e.erase.apply(this):this.removeProperty(t),this},hasClass:v?function(t){return this.classList.contains(t)}:function(t){return d(this.className).contains(t)},addClass:v?function(t){return d(t).forEach(p,this),this}:function(t){return this.className=d(t+" "+this.className).join(" "),this},removeClass:v?function(t){return d(t).forEach(m,this),this}:function(t){var e=d(this.className);return d(t).forEach(e.erase,e),this.className=e.join(" "),this},toggleClass:function(t,e){return(e=null==e?!this.hasClass(t):e)?this.addClass(t):this.removeClass(t)},adopt:function(){var t,e=this,i=Array.flatten(arguments),n=i.length;1<n&&(e=t=document.createDocumentFragment());for(var s=0;s<n;s++){var o=document.id(i[s],!0);o&&e.appendChild(o)}return t&&this.appendChild(t),this},appendText:function(t,e){return this.grab(this.getDocument().newTextNode(t),e)},grab:function(t,e){return a[e||"bottom"](document.id(t,!0),this),this},inject:function(t,e){return a[e||"bottom"](this,document.id(t,!0)),this},replaces:function(t){return(t=document.id(t,!0)).parentNode.replaceChild(this,t),this},wraps:function(t,e){return t=document.id(t,!0),this.replaces(t).grab(t,e)},getSelected:function(){return this.selectedIndex,new Elements(Array.convert(this.options).filter(function(t){return t.selected}))},toQueryString:function(){var i=[];return this.getElements("input, select, textarea").each(function(e){var t=e.type;e.name&&!e.disabled&&"submit"!=t&&"reset"!=t&&"file"!=t&&"image"!=t&&(t="select"==e.get("tag")?e.getSelected().map(function(t){return document.id(t).get("value")}):"radio"!=t&&"checkbox"!=t||e.checked?e.get("value"):null,Array.convert(t).each(function(t){void 0!==t&&i.push(encodeURIComponent(e.name)+"="+encodeURIComponent(t))}))}),i.join("&")}});var y={before:"beforeBegin",after:"afterEnd",bottom:"beforeEnd",top:"afterBegin",inside:"beforeEnd"};Element.implement("appendHTML","insertAdjacentHTML"in document.createElement("div")?function(t,e){return this.insertAdjacentHTML(y[e||"bottom"],t),this}:function(t,e){var t=new Element("div",{html:t}),i=t.childNodes;if(!(n=t.firstChild))return this;if(1<i.length)for(var n=document.createDocumentFragment(),s=0,o=i.length;s<o;s++)n.appendChild(i[s]);return a[e||"bottom"](n,this),this});function b(t){return S[t]||(S[t]={})}function w(t){var e=t.uniqueNumber;return t.removeEvents&&t.removeEvents(),t.clearAttributes&&t.clearAttributes(),null!=e&&(delete E[e],delete S[e]),t}var _,E={},S={},x={input:"checked",option:"selected",textarea:"value"};Element.implement({destroy:function(){var t=w(this).getElementsByTagName("*");return Array.each(t,w),Element.dispose(this),null},empty:function(){return Array.convert(this.childNodes).each(Element.dispose),this},dispose:function(){return this.parentNode?this.parentNode.removeChild(this):this},clone:function(t,e){var i=this.cloneNode(t=!1!==t),n=[i],s=[this];for(t&&(n.append(Array.convert(i.getElementsByTagName("*"))),s.append(Array.convert(this.getElementsByTagName("*")))),p=n.length;p--;){var o=n[p],a=s[p];if(e||o.removeAttribute("id"),o.clearAttributes&&(o.clearAttributes(),o.mergeAttributes(a),o.removeAttribute("uniqueNumber"),o.options))for(var r=o.options,l=a.options,h=r.length;h--;)r[h].selected=l[h].selected;var c=x[a.tagName.toLowerCase()];c&&a[c]&&(o[c]=a[c])}if(g)for(var u=i.getElementsByTagName("object"),d=this.getElementsByTagName("object"),p=u.length;p--;)u[p].outerHTML=d[p].outerHTML;return document.id(i)}}),[Element,Window,Document].invoke("implement",{addListener:function(t,e){return window.attachEvent&&!window.addEventListener&&(E[Slick.uidOf(this)]=this),this.addEventListener?this.addEventListener(t,e,!!arguments[2]):this.attachEvent("on"+t,e),this},removeListener:function(t,e){return this.removeEventListener?this.removeEventListener(t,e,!!arguments[2]):this.detachEvent("on"+t,e),this},retrieve:function(t,e){var i=b(Slick.uidOf(this)),n=i[t];return null!=(n=null!=e&&null==n?i[t]=e:n)?n:null},store:function(t,e){return b(Slick.uidOf(this))[t]=e,this},eliminate:function(t){return delete b(Slick.uidOf(this))[t],this}}),window.attachEvent&&!window.addEventListener&&(_=function(){Object.each(E,w),window.CollectGarbage&&CollectGarbage(),window.removeListener("unload",_)},window.addListener("unload",_)),Element.Properties={},Element.Properties.style={set:function(t){this.style.cssText=t},get:function(){return this.style.cssText},erase:function(){this.style.cssText=""}},Element.Properties.tag={get:function(){return this.tagName.toLowerCase()}},Element.Properties.html={set:function(t){null==t?t="":"array"==typeOf(t)&&(t=t.join("")),this.styleSheet&&!u?this.styleSheet.cssText=t:this.innerHTML=t},erase:function(){this.set("html","")}};var k;if((t=document.createElement("div")).innerHTML="<nav></nav>",!(k=1==t.childNodes.length)){var C="abbr article aside audio canvas datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video".split(" "),O=document.createDocumentFragment();for(l=C.length;l--;)O.createElement(C[l])}var $,I,t=null,c=Function.attempt(function(){return document.createElement("table").innerHTML="<tr><td></td></tr>",!0}),v=document.createElement("tr"),t="<td></td>";v.innerHTML=t,t=v.innerHTML==t,v=null,c&&t&&k||(Element.Properties.html.set=($=Element.Properties.html.set,(I={table:[1,"<table>","</table>"],select:[1,"<select>","</select>"],tbody:[2,"<table><tbody>","</tbody></table>"],tr:[3,"<table><tbody><tr>","</tr></tbody></table>"]}).thead=I.tfoot=I.tbody,function(t){if(this.styleSheet)return $.call(this,t);var e=I[this.get("tag")];if(!(e=!e&&!k?[0,"",""]:e))return $.call(this,t);var i=e[0],n=document.createElement("div"),s=n;for(k||O.appendChild(n),n.innerHTML=[e[1],t,e[2]].flatten().join("");i--;)s=s.firstChild;this.empty().adopt(s.childNodes),k||O.removeChild(n)}));t=document.createElement("form");t.innerHTML="<select><option>s</option></select>","s"!=t.firstChild.value&&(Element.Properties.value={set:function(t){if("select"!=this.get("tag"))return this.setProperty("value",t);var e=this.getElements("option");t=String(t);for(var i=0;i<e.length;i++){var n=e[i],s=n.getAttributeNode("value");if((s&&s.specified?n.value:n.get("text"))===t)return n.selected=!0}},get:function(){var t=this,e=t.get("tag");if("select"!=e&&"option"!=e)return this.getProperty("value");if("select"==e&&!(t=t.getSelected()[0]))return"";e=t.getAttributeNode("value");return e&&e.specified?t.value:t.get("text")}}),t=null,document.createElement("div").getAttributeNode("id")&&(Element.Properties.id={set:function(t){this.id=this.getAttributeNode("id").value=t},get:function(){return this.id||null},erase:function(){this.id=this.getAttributeNode("id").value=""}})}(),function(){var a={},t=this.DOMEvent=new Type("DOMEvent",function(t,e){if(e=e||window,(t=t||e.event).$extended)return t;this.event=t,this.$extended=!0,this.shift=t.shiftKey,this.control=t.ctrlKey,this.alt=t.altKey,this.meta=t.metaKey;for(var i=this.type=t.type,n=t.target||t.srcElement;n&&3==n.nodeType;)n=n.parentNode;if(this.target=document.id(n),0==i.indexOf("key")){var s=this.code=t.which||t.keyCode;this.shift&&"keypress"==i||(this.key=a[s]),"keydown"!=i&&"keyup"!=i||(111<s&&s<124?this.key="f"+(s-111):95<s&&s<106&&(this.key=s-96)),null==this.key&&(this.key=String.fromCharCode(s).toLowerCase())}else if("click"==i||"dblclick"==i||"contextmenu"==i||"wheel"==i||"DOMMouseScroll"==i||0==i.indexOf("mouse")){s=(s=e.document).compatMode&&"CSS1Compat"!=s.compatMode?s.body:s.html;if(this.page={x:null!=t.pageX?t.pageX:t.clientX+s.scrollLeft,y:null!=t.pageY?t.pageY:t.clientY+s.scrollTop},this.client={x:null!=t.pageX?t.pageX-e.pageXOffset:t.clientX,y:null!=t.pageY?t.pageY-e.pageYOffset:t.clientY},"DOMMouseScroll"!=i&&"wheel"!=i&&"mousewheel"!=i||(this.wheel=(e=t).wheelDelta?e.wheelDelta%120==0?e.wheelDelta/120:e.wheelDelta/12:-((e=e.deltaY||e.detail||0)%3==0?e/3:10*e)),this.rightClick=3==t.which||2==t.button,"mouseover"==i||"mouseout"==i||"mouseenter"==i||"mouseleave"==i){for(var o=t.relatedTarget||t[("mouseover"==i||"mouseenter"==i?"from":"to")+"Element"];o&&3==o.nodeType;)o=o.parentNode;this.relatedTarget=document.id(o)}}else 0!=i.indexOf("touch")&&0!=i.indexOf("gesture")||(this.rotation=t.rotation,this.scale=t.scale,this.targetTouches=t.targetTouches,this.changedTouches=t.changedTouches,(t=this.touches=t.touches)&&t[0]&&(t=t[0],this.page={x:t.pageX,y:t.pageY},this.client={x:t.clientX,y:t.clientY}));this.client||(this.client={}),this.page||(this.page={})});t.implement({stop:function(){return this.preventDefault().stopPropagation()},stopPropagation:function(){return this.event.stopPropagation?this.event.stopPropagation():this.event.cancelBubble=!0,this},preventDefault:function(){return this.event.preventDefault?this.event.preventDefault():this.event.returnValue=!1,this}}),t.defineKey=function(t,e){return a[t]=e,this},t.defineKeys=t.defineKey.overloadSetter(!0),t.defineKeys({38:"up",40:"down",37:"left",39:"right",27:"esc",32:"space",8:"backspace",9:"tab",46:"delete",13:"enter"})}(),function(){Element.Properties.events={set:function(t){this.addEvents(t)}},[Element,Window,Document].invoke("implement",{addEvent:function(e,i){var t=this.retrieve("events",{});if(t[e]||(t[e]={keys:[],values:[]}),t[e].keys.contains(i))return this;t[e].keys.push(i);var n=e,s=Element.Events[e],o=i,a=this;s&&(s.onAdd&&s.onAdd.call(this,i,e),s.condition&&(o=function(t){return!s.condition.call(this,t,e)||i.call(this,t)}),s.base&&(n=Function.convert(s.base).call(this,e)));var r=function(){return i.call(a)},l=Element.NativeEvents[n];return l&&this.addListener(n,r=2==l?function(t){t=new DOMEvent(t,a.getWindow()),!1===o.call(a,t)&&t.stop()}:r,arguments[2]),t[e].values.push(r),this},removeEvent:function(t,e){var i=this.retrieve("events");if(!i||!i[t])return this;var n=i[t],s=n.keys.indexOf(e);if(-1==s)return this;i=n.values[s];delete n.keys[s],delete n.values[s];s=Element.Events[t];return s&&(s.onRemove&&s.onRemove.call(this,e,t),s.base&&(t=Function.convert(s.base).call(this,t))),Element.NativeEvents[t]?this.removeListener(t,i,arguments[2]):this},addEvents:function(t){for(var e in t)this.addEvent(e,t[e]);return this},removeEvents:function(e){if("object"==typeOf(e)){for(var t in e)this.removeEvent(t,e[t]);return this}var i=this.retrieve("events");if(!i)return this;if(e)i[e]&&(i[e].keys.each(function(t){this.removeEvent(e,t)},this),delete i[e]);else{for(t in i)this.removeEvents(t);this.eliminate("events")}return this},fireEvent:function(t,e,i){var n=this.retrieve("events");return n&&n[t]&&(e=Array.convert(e),n[t].keys.each(function(t){i?t.delay(i,this,e):t.apply(this,e)},this)),this},cloneEvents:function(t,e){var i=(t=document.id(t)).retrieve("events");if(!i)return this;if(e)i[e]&&i[e].keys.each(function(t){this.addEvent(e,t)},this);else for(var n in i)this.cloneEvents(t,n);return this}}),Element.NativeEvents={click:2,dblclick:2,mouseup:2,mousedown:2,contextmenu:2,wheel:2,mousewheel:2,DOMMouseScroll:2,mouseover:2,mouseout:2,mousemove:2,selectstart:2,selectend:2,keydown:2,keypress:2,keyup:2,orientationchange:2,touchstart:2,touchmove:2,touchend:2,touchcancel:2,gesturestart:2,gesturechange:2,gestureend:2,focus:2,blur:2,change:2,reset:2,select:2,submit:2,paste:2,input:2,load:2,unload:1,beforeunload:2,resize:1,move:1,DOMContentLoaded:1,readystatechange:1,hashchange:1,popstate:2,pageshow:2,pagehide:2,error:1,abort:1,scroll:1,message:2},Element.Events={mousewheel:{base:"onwheel"in document?"wheel":"onmousewheel"in document?"mousewheel":"DOMMouseScroll"}};function t(t){return null==(t=t.relatedTarget)||!!t&&(t!=this&&"xul"!=t.prefix&&"document"!=typeOf(this)&&!this.contains(t))}"onmouseenter"in document.documentElement?(Element.NativeEvents.mouseenter=Element.NativeEvents.mouseleave=2,Element.MouseenterCheck=t):(Element.Events.mouseenter={base:"mouseover",condition:t},Element.Events.mouseleave={base:"mouseout",condition:t}),window.addEventListener||(Element.NativeEvents.propertychange=2,Element.Events.change={base:function(){var t=this.type;return"input"!=this.get("tag")||"radio"!=t&&"checkbox"!=t?"change":"propertychange"},condition:function(t){return"propertychange"!=t.type||"checked"==t.event.propertyName}})}(),function(){var t=!!window.addEventListener;Element.NativeEvents.focusin=Element.NativeEvents.focusout=2;function f(t,e,i,n,s){for(;s&&s!=t;){if(e(s,n))return i.call(s,n,s);s=document.id(s.parentNode)}}function e(c){return{base:"focusin",remove:function(t,e){var i=t.retrieve(u+c+"listeners",{})[e];if(i&&i.forms)for(var n=i.forms.length;n--;)i.forms[n].removeEvent&&i.forms[n].removeEvent(c,i.fns[n])},listen:function(e,i,n,t,s,o){var a,r,l,h="form"==s.get("tag")?s:t.target.getParent("form");h&&(l=(r=(a=e.retrieve(u+c+"listeners",{}))[o]||{forms:[],fns:[]}).forms,t=r.fns,-1==l.indexOf(h)&&(l.push(h),h.addEvent(c,h=function(t){f(e,i,n,t,s)}),t.push(h),a[o]=r,e.store(u+c+"listeners",a)))}}}function i(a){return{base:"focusin",listen:function(e,i,n,t,s){var o={blur:function(){this.removeEvents(o)}};o[a]=function(t){f(e,i,n,t,s)},t.target.addEvents(o)}}}var g={mouseenter:{base:"mouseover",condition:Element.MouseenterCheck},mouseleave:{base:"mouseout",condition:Element.MouseenterCheck},focus:{base:"focus"+(t?"":"in"),capture:!0},blur:{base:t?"blur":"focusout",capture:!0}},u="$delegation:";t||Object.append(g,{submit:e("submit"),reset:e("reset"),change:i("change"),select:i("select")});function n(o,a){return function(t,e,i){if(-1==t.indexOf(":relay"))return o.call(this,t,e,i);var n=Slick.parse(t).expressions[0][0];if("relay"!=n.pseudos[0].key)return o.call(this,t,e,i);var s=n.tag;return n.pseudos.slice(1).each(function(t){s+=":"+t.key+(t.value?"("+t.value+")":"")}),o.call(this,t,e),a.call(this,s,n.pseudos[0].value,e)}}var t=Element.prototype,v=t.addEvent,d=t.removeEvent,p={addEvent:function(i,n,s){var t=this.retrieve("$delegates",{}),e=t[i];if(e)for(var o in e)if(e[o].fn==s&&e[o].match==n)return this;var a=i,r=n,l=s,h=g[i]||{};i=h.base||a,n=function(t){return Slick.match(t,r)};var c,u,d=Element.Events[a];(h.condition||d&&d.condition)&&(c=n,u=h.condition||d.condition,n=function(t,e){return c(t,e)&&u.call(t,e,i)});var p=this,m=String.uniqueID(),d=h.listen?function(t,e){(e=!e&&t&&t.target?t.target:e)&&h.listen(p,n,s,t,e,m)}:function(t,e){(e=!e&&t&&t.target?t.target:e)&&f(p,n,s,t,e)};return(e=e||{})[m]={match:r,fn:l,delegator:d},t[a]=e,v.call(this,i,d,h.capture)},removeEvent:function(t,e,i,n){var s,o,a=this.retrieve("$delegates",{}),r=a[t];if(!r)return this;if(n){var l=t,h=r[n].delegator,c=g[t]||{};return t=c.base||l,c.remove&&c.remove(this,n),delete r[n],a[l]=r,d.call(this,t,h,c.capture)}if(i){for(s in r)if((o=r[s]).match==e&&o.fn==i)return p.removeEvent.call(this,t,e,i,s)}else for(s in r)(o=r[s]).match==e&&p.removeEvent.call(this,t,e,o.fn,s);return this}};[Element,Window,Document].invoke("implement",{addEvent:n(v,p.addEvent),removeEvent:n(d,p.removeEvent)})}(),function(){var t=document.html,e=document.createElement("div");e.style.color="red",e.style.color=null;var n="red"==e.style.color,i="1px solid #123abc";e.style.border=i;var o=e.style.border!=i;e=null;var a=!!window.getComputedStyle,r=null!=document.createElement("div").style.borderRadius;Element.Properties.styles={set:function(t){this.setStyles(t)}};function s(t,e,i){var n=t.style,t=n.filter||t.getComputedStyle("filter")||"";n.filter=(e.test(t)?t.replace(e,i):t+" "+i).trim(),n.filter||n.removeAttribute("filter")}function l(t){return t.replace(f,"$1-").camelCase()}var i=null!=t.style.opacity,e=null!=t.style.filter,h=/alpha\(opacity=([\d.]+)\)/i,c=i?function(t,e){t.style.opacity=e}:e?function(t,e){t.currentStyle&&t.currentStyle.hasLayout||(t.style.zoom=1),null==e||1==e?(s(t,h,""),1==e&&1!=u(t)&&s(t,h,"alpha(opacity=100)")):s(t,h,"alpha(opacity="+(100*e).limit(0,100).round()+")")}:function(t,e){t.store("$opacity",e),t.style.visibility=0<e||null==e?"visible":"hidden"},u=i?function(t){t=t.style.opacity||t.getComputedStyle("opacity");return""==t?1:t.toFloat()}:e?function(t){var e,t=t.style.filter||t.getComputedStyle("filter");return null==(e=t?t.match(h):e)||null==t?1:e[1]/100}:function(t){var e=t.retrieve("$opacity");return e=null==e?"hidden"==t.style.visibility?0:1:e},d=null==t.style.cssFloat?"styleFloat":"cssFloat",p={left:"0%",top:"0%",center:"50%",right:"100%",bottom:"100%"},m=null!=t.style.backgroundPositionX,f=/^-(ms)-/;Element.implement({getComputedStyle:function(t){if(!a&&this.currentStyle)return this.currentStyle[l(t)];var e=Element.getDocument(this).defaultView,e=e?e.getComputedStyle(this,null):null;return e?e.getPropertyValue(t==d?"float":t.hyphenate()):""},setStyle:function(t,e){return"opacity"==t?(null!=e&&(e=parseFloat(e)),c(this,e)):(t=l("float"==t?d:t),"string"!=typeOf(e)?(i=(Element.Styles[t]||"@").split(" "),e=Array.convert(e).map(function(t,e){return i[e]?"number"==typeOf(t)?i[e].replace("@",Math.round(t)):t:""}).join(" ")):e==String(Number(e))&&(e=Math.round(e)),(""==(this.style[t]=e)||null==e)&&n&&this.style.removeAttribute&&(e=this.style,"backgroundPosition"==(t=t)&&(e.removeAttribute(t+"X"),t+="Y"),e.removeAttribute(t))),this;var i},getStyle:function(t){if("opacity"==t)return u(this);if(t=l("float"==t?d:t),r&&-1!=t.indexOf("borderRadius"))return["borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"].map(function(t){return this.style[t]||"0px"},this).join(" ");var e,i=this.style[t];if(!i||"zIndex"==t){if(Element.ShortStyles.hasOwnProperty(t)){for(var n in i=[],Element.ShortStyles[t])i.push(this.getStyle(n));return i.join(" ")}i=this.getComputedStyle(t)}if(m&&/^backgroundPosition[XY]?$/.test(t))return i.replace(/(top|right|bottom|left)/g,function(t){return p[t]})||"0px";if(!i&&"backgroundPosition"==t)return"0px 0px";if(!i||(e=(i=String(i)).match(/rgba?\([\d\s,]+\)/))&&(i=i.replace(e[0],e[0].rgbToHex())),!a&&!this.style[t]){if(/^(height|width)$/.test(t)&&!/px$/.test(i)){var s=0;return("width"==t?["left","right"]:["top","bottom"]).each(function(t){s+=this.getStyle("border-"+t+"-width").toInt()+this.getStyle("padding-"+t).toInt()},this),this["offset"+t.capitalize()]-s+"px"}if(/^border(.+)Width|margin|padding/.test(t)&&isNaN(parseFloat(i)))return"0px"}return o&&/^border(Top|Right|Bottom|Left)?$/.test(t)&&/^#/.test(i)?i.replace(/^(.+)\s(.+)\s(.+)$/,"$2 $3 $1"):i},setStyles:function(t){for(var e in t)this.setStyle(e,t[e]);return this},getStyles:function(){var e={};return Array.flatten(arguments).each(function(t){e[t]=this.getStyle(t)},this),e}}),Element.Styles={left:"@px",top:"@px",bottom:"@px",right:"@px",width:"@px",height:"@px",maxWidth:"@px",maxHeight:"@px",minWidth:"@px",minHeight:"@px",backgroundColor:"rgb(@, @, @)",backgroundSize:"@px",backgroundPosition:"@px @px",color:"rgb(@, @, @)",fontSize:"@px",letterSpacing:"@px",lineHeight:"@px",clip:"rect(@px @px @px @px)",margin:"@px @px @px @px",padding:"@px @px @px @px",border:"@px @ rgb(@, @, @) @px @ rgb(@, @, @) @px @ rgb(@, @, @)",borderWidth:"@px @px @px @px",borderStyle:"@ @ @ @",borderColor:"rgb(@, @, @) rgb(@, @, @) rgb(@, @, @) rgb(@, @, @)",zIndex:"@",zoom:"@",fontWeight:"@",textIndent:"@px",opacity:"@",borderRadius:"@px @px @px @px"},Element.ShortStyles={margin:{},padding:{},border:{},borderWidth:{},borderStyle:{},borderColor:{}},["Top","Right","Bottom","Left"].each(function(i){var n=Element.ShortStyles,s=Element.Styles;["margin","padding"].each(function(t){var e=t+i;n[t][e]=s[e]="@px"});var t="border"+i;n.border[t]=s[t]="@px @ rgb(@, @, @)";var e=t+"Width",o=t+"Style",a=t+"Color";n[t]={},n.borderWidth[e]=n[t][e]=s[e]="@px",n.borderStyle[o]=n[t][o]=s[o]="@",n.borderColor[a]=n[t][a]=s[a]="rgb(@, @, @)"}),m&&(Element.ShortStyles.backgroundPosition={backgroundPositionX:"@",backgroundPositionY:"@"})}(),function(){var t=document.createElement("div"),e=document.createElement("div");t.style.height="0",t.appendChild(e);function i(t){return"static"!=r(t,"position")||l(t)}function n(t){return i(t)||/^(?:table|td|th)$/i.test(t.tagName)}var e=e.offsetParent===t,t=null,s=["height","paddingTop","paddingBottom","borderTopWidth","borderBottomWidth"],o=["width","paddingLeft","paddingRight","borderLeftWidth","borderRightWidth"];Element.implement({scrollTo:function(t,e){return l(this)?this.getWindow().scrollTo(t,e):(this.scrollLeft=t,this.scrollTop=e),this},getSize:function(){if(l(this))return this.getWindow().getSize();if(!window.getComputedStyle)return{x:this.offsetWidth,y:this.offsetHeight};if("svg"==this.get("tag"))return t=this,e=window.getComputedStyle(t),i={x:0,y:0},s.each(function(t){i.y+=parseFloat(e[t])}),o.each(function(t){i.x+=parseFloat(e[t])}),i;var t,e,i;try{var n=this.getBoundingClientRect();return{x:n.width,y:n.height}}catch(t){return{x:0,y:0}}},getScrollSize:function(){return l(this)?this.getWindow().getScrollSize():{x:this.scrollWidth,y:this.scrollHeight}},getScroll:function(){return l(this)?this.getWindow().getScroll():{x:this.scrollLeft,y:this.scrollTop}},getScrolls:function(){for(var t=this.parentNode,e={x:0,y:0};t&&!l(t);)e.x+=t.scrollLeft,e.y+=t.scrollTop,t=t.parentNode;return e},getOffsetParent:e?function(){var t=this;if(l(t)||"fixed"==r(t,"position"))return null;for(var e="static"==r(t,"position")?n:i;t=t.parentNode;)if(e(t))return t;return null}:function(){if(l(this)||"fixed"==r(this,"position"))return null;try{return this.offsetParent}catch(t){}return null},getOffsets:function(){if(this.getBoundingClientRect){var t=this.getBoundingClientRect(),e=document.id(this.getDocument().documentElement),i=e.getScroll(),n=this.getScrolls(),s="fixed"==r(this,"position");return{x:t.left.toFloat()+n.x+(s?0:i.x)-e.clientLeft,y:t.top.toFloat()+n.y+(s?0:i.y)-e.clientTop}}var o=this,a={x:0,y:0};if(l(this))return a;for(;o&&!l(o);)a.x+=o.offsetLeft,a.y+=o.offsetTop,o=o.offsetParent;return a},getPosition:function(t){var e=this.getOffsets(),i=this.getScrolls(),e={x:e.x-i.x,y:e.y-i.y};if(t=t&&document.id(t)){i=t.getPosition();return{x:e.x-i.x-a(t,"border-left-width"),y:e.y-i.y-a(t,"border-top-width")}}return e},getCoordinates:function(t){if(l(this))return this.getWindow().getCoordinates();var e=this.getPosition(t),t=this.getSize(),t={left:e.x,top:e.y,width:t.x,height:t.y};return t.right=t.left+t.width,t.bottom=t.top+t.height,t},computePosition:function(t){return{left:t.x-a(this,"margin-left"),top:t.y-a(this,"margin-top")}},setPosition:function(t){return this.setStyles(this.computePosition(t))}}),[Document,Window].invoke("implement",{getSize:function(){var t=h(this);return{x:t.clientWidth,y:t.clientHeight}},getScroll:function(){var t=this.getWindow(),e=h(this);return{x:t.pageXOffset||e.scrollLeft,y:t.pageYOffset||e.scrollTop}},getScrollSize:function(){var t=h(this),e=this.getSize(),i=this.getDocument().body;return{x:Math.max(t.scrollWidth,i.scrollWidth,e.x),y:Math.max(t.scrollHeight,i.scrollHeight,e.y)}},getPosition:function(){return{x:0,y:0}},getCoordinates:function(){var t=this.getSize();return{top:0,left:0,bottom:t.y,right:t.x,height:t.y,width:t.x}}});var r=Element.getComputedStyle;function a(t,e){return r(t,e).toInt()||0}function l(t){return/^(?:body|html)$/i.test(t.tagName)}function h(t){t=t.getDocument();return t.compatMode&&"CSS1Compat"!=t.compatMode?t.body:t.html}}(),Element.alias({position:"setPosition"}),[Window,Document,Element].invoke("implement",{getHeight:function(){return this.getSize().y},getWidth:function(){return this.getSize().x},getScrollTop:function(){return this.getScroll().y},getScrollLeft:function(){return this.getScroll().x},getScrollHeight:function(){return this.getScrollSize().y},getScrollWidth:function(){return this.getScrollSize().x},getTop:function(){return this.getPosition().y},getLeft:function(){return this.getPosition().x}}),function(){var n=this.Fx=new Class({Implements:[Chain,Events,Options,Class.Thenable],options:{fps:60,unit:!1,duration:500,frames:null,frameSkip:!0,link:"ignore"},initialize:function(t){this.subject=this.subject||this,this.setOptions(t)},getTransition:function(){return function(t){return-(Math.cos(Math.PI*t)-1)/2}},step:function(t){var e;this.options.frameSkip?(e=(null!=this.time?t-this.time:0)/this.frameInterval,this.time=t,this.frame+=e):this.frame++,this.frame<this.frames?(e=this.transition(this.frame/this.frames),this.set(this.compute(this.from,this.to,e))):(this.frame=this.frames,this.set(this.compute(this.from,this.to,1)),this.stop())},set:function(t){return t},compute:function(t,e,i){return n.compute(t,e,i)},check:function(){if(!this.isRunning())return!0;switch(this.options.link){case"cancel":return this.cancel(),!0;case"chain":return this.chain(this.caller.pass(arguments,this)),!1}return!1},start:function(t,e){if(!this.check(t,e))return this;this.from=t,this.to=e,this.frame=this.options.frameSkip?0:-1,this.time=null,this.transition=this.getTransition();var i=this.options.frames,t=this.options.fps,e=this.options.duration;return this.duration=n.Durations[e]||e.toInt(),this.frameInterval=1e3/t,this.frames=i||Math.round(this.duration/this.frameInterval),"pending"!==this.getThenableState()&&this.resetThenable(this.subject),this.fireEvent("start",this.subject),a.call(this,t),this},stop:function(){return this.isRunning()&&(this.time=null,t.call(this,this.options.fps),this.frames==this.frame?(this.fireEvent("complete",this.subject),this.callChain()||this.fireEvent("chainComplete",this.subject)):this.fireEvent("stop",this.subject),this.resolve(this.subject===this?null:this.subject)),this},cancel:function(){return this.isRunning()&&(this.time=null,t.call(this,this.options.fps),this.frame=this.frames,this.fireEvent("cancel",this.subject).clearChain(),this.reject(this.subject)),this},pause:function(){return this.isRunning()&&(this.time=null,t.call(this,this.options.fps)),this},resume:function(){return this.isPaused()&&a.call(this,this.options.fps),this},isRunning:function(){var t=i[this.options.fps];return t&&t.contains(this)},isPaused:function(){return this.frame<this.frames&&!this.isRunning()}});n.compute=function(t,e,i){return(e-t)*i+t},n.Durations={short:250,normal:500,long:1e3};var i={},s={},o=function(){for(var t=Date.now(),e=this.length;e--;){var i=this[e];i&&i.step(t)}},a=function(t){var e=i[t]||(i[t]=[]);e.push(this),s[t]||(s[t]=o.periodical(Math.round(1e3/t),e))},t=function(t){var e=i[t];e&&(e.erase(this),!e.length&&s[t]&&(delete i[t],s[t]=clearInterval(s[t])))}}(),Fx.CSS=new Class({Extends:Fx,prepare:function(t,e,i){var n,s,o=(i=Array.convert(i))[0],a=i[1];return null==a&&(a=o,o=t.getStyle(e),(n=this.options.unit)&&o&&"string"==typeof o&&o.slice(-n.length)!=n&&0!=parseFloat(o)&&(t.setStyle(e,a+n),s=t.getComputedStyle(e),/px$/.test(s)||null==(s=t.style[("pixel-"+e).camelCase()])&&(i=t.style.left,t.style.left=a+n,s=t.style.pixelLeft,t.style.left=i),o=(a||1)/(parseFloat(s)||1)*(parseFloat(o)||0),t.setStyle(e,o+n))),{from:this.parse(o),to:this.parse(a)}},parse:function(t){return(t="string"==typeof(t=Function.convert(t)())?t.split(" "):Array.convert(t)).map(function(i){i=String(i);var n=!1;return Object.each(Fx.CSS.Parsers,function(t){var e;n||(!(e=t.parse(i))&&0!==e||(n={value:e,parser:t}))}),n=n||{value:i,parser:Fx.CSS.Parsers.String}})},compute:function(e,i,n){var s=[];return Math.min(e.length,i.length).times(function(t){s.push({value:e[t].parser.compute(e[t].value,i[t].value,n),parser:e[t].parser})}),s.$family=Function.convert("fx:css:value"),s},serve:function(t,e){"fx:css:value"!=typeOf(t)&&(t=this.parse(t));var i=[];return t.each(function(t){i=i.concat(t.parser.serve(t.value,e))}),i},render:function(t,e,i,n){t.setStyle(e,this.serve(i,n))},search:function(t){if(Fx.CSS.Cache[t])return Fx.CSS.Cache[t];function n(t){Array.each(t,function(i){var t;i.media?n(i.rules||i.cssRules):!i.style||(t=i.selectorText?i.selectorText.replace(/^\w+/,function(t){return t.toLowerCase()}):null)&&e.test(t)&&Object.each(Element.Styles,function(t,e){i.style[e]&&!Element.ShortStyles[e]&&(t=String(i.style[e]),s[e]=/^rgb/.test(t)?t.rgbToHex():t)})})}var s={},e=new RegExp("^"+t.escapeRegExp()+"$");return Array.each(document.styleSheets,function(t){var e=t.href;e&&-1<e.indexOf("://")&&-1==e.indexOf(document.domain)||(t=t.rules||t.cssRules,n(t))}),Fx.CSS.Cache[t]=s}}),Fx.CSS.Cache={},Fx.CSS.Parsers={Color:{parse:function(t){return t.match(/^#[0-9a-f]{3,6}$/i)?t.hexToRgb(!0):!!(t=t.match(/(\d+),\s*(\d+),\s*(\d+)/))&&[t[1],t[2],t[3]]},compute:function(i,n,s){return i.map(function(t,e){return Math.round(Fx.compute(i[e],n[e],s))})},serve:function(t){return t.map(Number)}},Number:{parse:parseFloat,compute:Fx.compute,serve:function(t,e){return e?t+e:t}},String:{parse:Function.convert(!1),compute:function(t,e){return e},serve:function(t){return t}}},Fx.Morph=new Class({Extends:Fx.CSS,initialize:function(t,e){this.element=this.subject=document.id(t),this.parent(e)},set:function(t){for(var e in t="string"==typeof t?this.search(t):t)this.render(this.element,e,t[e],this.options.unit);return this},compute:function(t,e,i){var n,s={};for(n in t)s[n]=this.parent(t[n],e[n],i);return s},start:function(t){if(!this.check(t))return this;var e,i={},n={};for(e in t="string"==typeof t?this.search(t):t){var s=this.prepare(this.element,e,t[e]);i[e]=s.from,n[e]=s.to}return this.parent(i,n)}}),Element.Properties.morph={set:function(t){return this.get("morph").cancel().setOptions(t),this},get:function(){var t=this.retrieve("morph");return t||(t=new Fx.Morph(this,{link:"cancel"}),this.store("morph",t)),t}},Element.implement({morph:function(t){return this.get("morph").start(t),this}}),Fx.implement({getTransition:function(){var t,e=this.options.transition||Fx.Transitions.Sine.easeInOut;return"string"==typeof e&&(t=e.split(":"),e=(e=Fx.Transitions)[t[0]]||e[t[0].capitalize()],t[1]&&(e=e["ease"+t[1].capitalize()+(t[2]?t[2].capitalize():"")])),e}}),Fx.Transition=function(e,i){i=Array.convert(i);function t(t){return e(t,i)}return Object.append(t,{easeIn:t,easeOut:function(t){return 1-e(1-t,i)},easeInOut:function(t){return(t<=.5?e(2*t,i):2-e(2*(1-t),i))/2}})},Fx.Transitions={linear:function(t){return t}},Fx.Transitions.extend=function(t){for(var e in t)Fx.Transitions[e]=new Fx.Transition(t[e])},Fx.Transitions.extend({Pow:function(t,e){return Math.pow(t,e&&e[0]||6)},Expo:function(t){return Math.pow(2,8*(t-1))},Circ:function(t){return 1-Math.sin(Math.acos(t))},Sine:function(t){return 1-Math.cos(t*Math.PI/2)},Back:function(t,e){return e=e&&e[0]||1.618,Math.pow(t,2)*((e+1)*t-e)},Bounce:function(t){for(var e,i=0,n=1;;i+=n,n/=2){1;if((7-4*i)/11<=t){e=n*n-Math.pow((11-6*i-11*t)/4,2);break}}return e},Elastic:function(t,e){return Math.pow(2,10*--t)*Math.cos(20*t*Math.PI*(e&&e[0]||1)/3)}}),["Quad","Cubic","Quart","Quint"].each(function(t,e){Fx.Transitions[t]=new Fx.Transition(function(t){return Math.pow(t,e+2)})}),Fx.Tween=new Class({Extends:Fx.CSS,initialize:function(t,e){this.element=this.subject=document.id(t),this.parent(e)},set:function(t,e){return 1==arguments.length&&(e=t,t=this.property||this.options.property),this.render(this.element,t,e,this.options.unit),this},start:function(t,e,i){if(!this.check(t,e,i))return this;var n=Array.flatten(arguments);this.property=this.options.property||n.shift();n=this.prepare(this.element,this.property,n);return this.parent(n.from,n.to)}}),Element.Properties.tween={set:function(t){return this.get("tween").cancel().setOptions(t),this},get:function(){var t=this.retrieve("tween");return t||(t=new Fx.Tween(this,{link:"cancel"}),this.store("tween",t)),t}},Element.implement({tween:function(t,e,i){return this.get("tween").start(t,e,i),this},fade:function(){var t,e=this.get("tween"),i=["opacity"].append(arguments);switch(null==i[1]&&(i[1]="toggle"),i[1]){case"in":s="start",i[1]=1;break;case"out":s="start",i[1]=0;break;case"show":s="set",i[1]=1;break;case"hide":s="set",i[1]=0;break;case"toggle":var n=this.retrieve("fade:flag",1==this.getStyle("opacity")),s="start";i[1]=n?0:1,this.store("fade:flag",!n),t=!0;break;default:s="start"}t||this.eliminate("fade:flag"),e[s].apply(e,i);var o=i[i.length-1];return"set"==s?this.setStyle("visibility",0==o?"hidden":"visible"):0!=o?e.$chain.length?e.chain(function(){this.element.setStyle("visibility","visible"),this.callChain()}):this.setStyle("visibility","visible"):e.chain(function(){this.element.getStyle("opacity")||(this.element.setStyle("visibility","hidden"),this.callChain())}),this},highlight:function(t,e){e=e||("transparent"==(e=this.retrieve("highlight:original",this.getStyle("background-color")))?"#fff":e);var i=this.get("tween");return i.start("background-color",t||"#ffff88",e).chain(function(){this.setStyle("background-color",this.retrieve("highlight:original")),i.callChain()}.bind(this)),this}}),function(){function i(){}var a="onprogress"in new Browser.Request,t=this.Request=this.$Request=new Class({Implements:[Chain,Events,Options,Class.Thenable],options:{url:"",data:"",headers:{"X-Requested-With":"XMLHttpRequest",Accept:"text/javascript, text/html, application/xml, text/xml, */*"},async:!0,format:!1,method:"post",link:"ignore",isSuccess:null,emulation:!0,urlEncoded:!0,encoding:"utf-8",evalScripts:!1,evalResponse:!1,timeout:0,noCache:!1},initialize:function(t){this.xhr=new Browser.Request,this.setOptions(t),this.headers=this.options.headers},onStateChange:function(){var e=this.xhr;4==e.readyState&&this.running&&(this.running=!1,this.status=0,Function.attempt(function(){var t=e.status;this.status=1223==t?204:t}.bind(this)),e.onreadystatechange=i,a&&(e.onprogress=e.onloadstart=i),this.timer&&(clearTimeout(this.timer),delete this.timer),this.response={text:this.xhr.responseText||"",xml:this.xhr.responseXML},this.options.isSuccess.call(this,this.status)?this.success(this.response.text,this.response.xml):this.failure())},isSuccess:function(){var t=this.status;return 200<=t&&t<300},isRunning:function(){return!!this.running},processScripts:function(t){return this.options.evalResponse||/(ecma|java)script/.test(this.getHeader("Content-type"))?Browser.exec(t):t.stripScripts(this.options.evalScripts)},success:function(t,e){this.onSuccess(this.processScripts(t),e),this.resolve({text:t,xml:e})},onSuccess:function(){this.fireEvent("complete",arguments).fireEvent("success",arguments).callChain()},failure:function(){this.onFailure(),this.reject({reason:"failure",xhr:this.xhr})},onFailure:function(){this.fireEvent("complete").fireEvent("failure",this.xhr)},loadstart:function(t){this.fireEvent("loadstart",[t,this.xhr])},progress:function(t){this.fireEvent("progress",[t,this.xhr])},timeout:function(){this.fireEvent("timeout",this.xhr),this.reject({reason:"timeout",xhr:this.xhr})},setHeader:function(t,e){return this.headers[t]=e,this},getHeader:function(t){return Function.attempt(function(){return this.xhr.getResponseHeader(t)}.bind(this))},check:function(){if(!this.running)return!0;switch(this.options.link){case"cancel":return this.cancel(),!0;case"chain":return this.chain(this.caller.pass(arguments,this)),!1}return!1},send:function(t){if(!this.check(t))return this;this.options.isSuccess=this.options.isSuccess||this.isSuccess,this.running=!0;var e=typeOf(t);"string"!=e&&"element"!=e||(t={data:t});var i,e=this.options,n=(t=Object.append({data:e.data,url:e.url,method:e.method},t)).data,e=String(t.url),t=t.method.toLowerCase();switch(typeOf(n)){case"element":n=document.id(n).toQueryString();break;case"object":case"hash":n=Object.toQueryString(n)}this.options.format&&(i="format="+this.options.format,n=n?i+"&"+n:i),this.options.emulation&&!["get","post"].contains(t)&&(i="_method="+t,n=n?i+"&"+n:i,t="post"),this.options.urlEncoded&&["post","put"].contains(t)&&(s=this.options.encoding?"; charset="+this.options.encoding:"",this.headers["Content-type"]="application/x-www-form-urlencoded"+s);var s=(e=e||document.location.pathname).lastIndexOf("/");-1<s&&-1<(s=e.indexOf("#"))&&(e=e.substr(0,s)),this.options.noCache&&(e+=(-1<e.indexOf("?")?"&":"?")+String.uniqueID()),!n||"get"!=t&&"delete"!=t||(e+=(-1<e.indexOf("?")?"&":"?")+n,n=null);var o=this.xhr;return a&&(o.onloadstart=this.loadstart.bind(this),o.onprogress=this.progress.bind(this)),o.open(t.toUpperCase(),e,this.options.async,this.options.user,this.options.password),this.options.withCredentials&&"withCredentials"in o&&(o.withCredentials=!0),o.onreadystatechange=this.onStateChange.bind(this),Object.each(this.headers,function(e,i){try{o.setRequestHeader(i,e)}catch(t){this.fireEvent("exception",[i,e]),this.reject({reason:"exception",xhr:o,exception:t})}},this),"pending"!==this.getThenableState()&&this.resetThenable({reason:"send"}),this.fireEvent("request"),o.send(n),this.options.async?this.options.timeout&&(this.timer=this.timeout.delay(this.options.timeout,this)):this.onStateChange(),this},cancel:function(){if(!this.running)return this;this.running=!1;var t=this.xhr;return t.abort(),this.timer&&(clearTimeout(this.timer),delete this.timer),t.onreadystatechange=i,a&&(t.onprogress=t.onloadstart=i),this.xhr=new Browser.Request,this.fireEvent("cancel"),this.reject({reason:"cancel",xhr:t}),this}}),e={};["get","post","put","delete","patch","head","GET","POST","PUT","DELETE","PATCH","HEAD"].each(function(i){e[i]=function(t){var e={method:i};return null!=t&&(e.data=t),this.send(e)}}),t.implement(e),Element.Properties.send={set:function(t){return this.get("send").cancel().setOptions(t),this},get:function(){var t=this.retrieve("send");return t||(t=new $Request({data:this,link:"cancel",method:this.get("method")||"post",url:this.get("action")}),this.store("send",t)),t}},Element.implement({send:function(t){var e=this.get("send");return e.send({data:this,url:t||e.options.url}),this}})}(),Request.HTML=new Class({Extends:Request,options:{update:!1,append:!1,evalScripts:!0,filter:!1,headers:{Accept:"text/html, application/xml, text/xml, */*"}},success:function(t){var e=this.options,i=this.response;i.html=t.stripScripts(function(t){i.javascript=t});t=i.html.match(/<body[^>]*>([\s\S]*?)<\/body>/i);t&&(i.html=t[1]);var n,t=new Element("div").set("html",i.html);i.tree=t.childNodes,i.elements=t.getElements(e.filter||"*"),e.filter&&(i.tree=i.elements),e.update?(n=document.id(e.update).empty(),e.filter?n.adopt(i.elements):n.set("html",i.html)):e.append&&(n=document.id(e.append),e.filter?i.elements.reverse().inject(n):n.adopt(t.getChildren())),e.evalScripts&&Browser.exec(i.javascript),this.onSuccess(i.tree,i.elements,i.html,i.javascript),this.resolve({tree:i.tree,elements:i.elements,html:i.html,javascript:i.javascript})}}),Element.Properties.load={set:function(t){return this.get("load").cancel().setOptions(t),this},get:function(){var t=this.retrieve("load");return t||(t=new $Request.HTML({data:this,link:"cancel",update:this,method:"get"}),this.store("load",t)),t}},Element.implement({load:function(){return this.get("load").send(Array.link(arguments,{data:Type.isObject,url:Type.isString})),this}}),"undefined"==typeof JSON&&(this.JSON={}),function(){var special={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},escape=function(t){return special[t]||"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)};JSON.validate=function(t){return t=t.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""),/^[\],:{}\s]*$/.test(t)},JSON.encode=JSON.stringify?function(t){return JSON.stringify(t)}:function(t){switch(t&&t.toJSON&&(t=t.toJSON()),typeOf(t)){case"string":return'"'+t.replace(/[\x00-\x1f\\"]/g,escape)+'"';case"array":return"["+t.map(JSON.encode).clean()+"]";case"object":case"hash":var i=[];return Object.each(t,function(t,e){t=JSON.encode(t);t&&i.push(JSON.encode(e)+":"+t)}),"{"+i+"}";case"number":case"boolean":return""+t;case"null":return"null"}return null},JSON.secure=!0,JSON.decode=function(string,secure){if(!string||"string"!=typeOf(string))return null;if(null==secure&&(secure=JSON.secure),secure){if(JSON.parse)return JSON.parse(string);if(!JSON.validate(string))throw new Error("JSON could not decode the input; security is enabled and the value is not secure.")}return eval("("+string+")")}}(),Request.JSON=new Class({Extends:Request,options:{secure:!0},initialize:function(t){this.parent(t),Object.append(this.headers,{Accept:"application/json","X-Request":"JSON"})},success:function(e){var t;try{t=this.response.json=JSON.decode(e,this.options.secure)}catch(t){return void this.fireEvent("error",[e,t])}null==t?this.failure():(this.onSuccess(t,e),this.resolve({json:t,text:e}))}});var Cookie=new Class({Implements:Options,options:{path:"/",domain:!1,duration:!1,secure:!1,document:document,encode:!0,httpOnly:!1},initialize:function(t,e){this.key=t,this.setOptions(e)},write:function(t){var e;return this.options.encode&&(t=encodeURIComponent(t)),this.options.domain&&(t+="; domain="+this.options.domain),this.options.path&&(t+="; path="+this.options.path),this.options.duration&&((e=new Date).setTime(e.getTime()+24*this.options.duration*60*60*1e3),t+="; expires="+e.toGMTString()),this.options.secure&&(t+="; secure"),this.options.httpOnly&&(t+="; HttpOnly"),this.options.document.cookie=this.key+"="+t,this},read:function(){var t=this.options.document.cookie.match("(?:^|;)\\s*"+this.key.escapeRegExp()+"=([^;]*)");return t?decodeURIComponent(t[1]):null},dispose:function(){return new Cookie(this.key,Object.merge({},this.options,{duration:-1})).write(""),this}});Cookie.write=function(t,e,i){return new Cookie(t,i).write(e)},Cookie.read=function(t){return new Cookie(t).read()},Cookie.dispose=function(t,e){return new Cookie(t,e).dispose()},function(e,i){function t(){for(var t=l.length;t--;)if(l[t]())return c(),!0;return!1}function n(){clearTimeout(r),t()||(r=setTimeout(n,10))}var s,o,a,r,l=[],h=i.createElement("div"),c=function(){clearTimeout(r),s||(Browser.loaded=s=!0,i.removeListener("DOMContentLoaded",c).removeListener("readystatechange",t),i.fireEvent("domready"),e.fireEvent("domready")),i=e=h=null};i.addListener("DOMContentLoaded",c);function u(){try{return h.doScroll(),!0}catch(t){}return!1}h.doScroll&&!u()&&(l.push(u),a=!0),i.readyState&&l.push(function(){var t=i.readyState;return"loaded"==t||"complete"==t}),"onreadystatechange"in i?i.addListener("readystatechange",t):a=!0,a&&n(),Element.Events.domready={onAdd:function(t){s&&t.call(this)}},Element.Events.load={base:"load",onAdd:function(t){o&&this==e&&t.call(this)},condition:function(){return this==e&&(c(),delete Element.Events.load),!0}},e.addEvent("load",function(){o=!0})}(window,document),MooTools.More={version:"1.6.0",build:"45b71db70f879781a7e0b0d3fb3bb1307c2521eb"},function(){var t={wait:function(t){return this.chain(function(){return this.callChain.delay(null==t?500:t,this),this}.bind(this))}};Chain.implement(t),this.Fx&&Fx.implement(t),this.Element&&Element.implement&&this.Fx&&Element.implement({chains:function(t){return Array.convert(t||["tween","morph","reveal"]).each(function(t){(t=this.get(t))&&t.setOptions({link:"chain"})},this),this},pauseFx:function(t,e){return this.chains(e).get(e||"tween").wait(t),this}})}(),Class.Mutators.Binds=function(t){return this.prototype.initialize||this.implement("initialize",function(){}),Array.convert(t).concat(this.prototype.Binds||[])},Class.Mutators.initialize=function(t){return function(){return Array.convert(this.Binds).each(function(t){var e=this[t];e&&(this[t]=e.bind(this))},this),t.apply(this,arguments)}},Class.Occlude=new Class({occlude:function(t,e){var i=(e=document.id(e||this.element)).retrieve(t||this.property);return i&&!this.occluded?this.occluded=i:(this.occluded=!1,e.store(t||this.property,this),this.occluded)}}),Class.refactor=function(e,t){return Object.each(t,function(i,t){var n=(n=e.prototype[t])&&n.$origin||n||function(){};e.implement(t,"function"==typeof i?function(){var t=this.previous;this.previous=n;var e=i.apply(this,arguments);return this.previous=t,e}:i)}),e},function(){Events.Pseudos=function(r,c,o){function u(i){return{store:i.store?function(t,e){i.store(n+t,e)}:function(t,e){(i._monitorEvents||(i._monitorEvents={}))[t]=e},retrieve:i.retrieve?function(t,e){return i.retrieve(n+t,e)}:function(t,e){return i._monitorEvents&&i._monitorEvents[t]||e}}}function d(t){if(-1==t.indexOf(":")||!r)return null;for(var e=Slick.parse(t).expressions[0][0],i=e.pseudos,n=i.length,s=[];n--;){var o=i[n].key,a=r[o];null!=a&&s.push({event:e.tag,value:i[n].value,pseudo:o,original:t,listener:a})}return s.length?s:null}var n="_monitorEvents:";return{addEvent:function(t,e,i){var n=d(t);if(!n)return c.call(this,t,e,i);var s=u(this),o=s.retrieve(t,[]),a=n[0].event,r=Array.slice(arguments,2),l=e,h=this;return n.each(function(t){var e=t.listener,i=l;0==e?a+=":"+t.pseudo+"("+t.value+")":l=function(){e.call(h,t,i,arguments,l)}}),o.include({type:a,event:e,monitor:l}),s.store(t,o),t!=a&&c.apply(this,[t,e].concat(r)),c.apply(this,[a,l].concat(r))},removeEvent:function(t,i){if(!d(t))return o.call(this,t,i);var e=u(this),n=e.retrieve(t);if(!n)return this;var s=Array.slice(arguments,2);return o.apply(this,[t,i].concat(s)),n.each(function(t,e){i&&t.event!=i||o.apply(this,[t.type,t.monitor].concat(s)),delete n[e]},this),e.store(t,n),this}}};var i={once:function(t,e,i,n){e.apply(this,i),this.removeEvent(t.event,n).removeEvent(t.original,e)},throttle:function(t,e,i){e._throttled||(e.apply(this,i),e._throttled=setTimeout(function(){e._throttled=!1},t.value||250))},pause:function(t,e,i){clearTimeout(e._pause),e._pause=e.delay(t.value||250,this,i)}};Events.definePseudo=function(t,e){return i[t]=e,this},Events.lookupPseudo=function(t){return i[t]};var t=Events.prototype;Events.implement(Events.Pseudos(i,t.addEvent,t.removeEvent)),["Request","Fx"].each(function(t){this[t]&&this[t].implement(Events.prototype)})}(),function(){var e=this.Drag=new Class({Implements:[Events,Options],options:{snap:6,unit:"px",grid:!1,style:!0,limit:!1,handle:!1,invert:!1,unDraggableTags:["button","input","a","textarea","select","option"],preventDefault:!1,stopPropagation:!1,compensateScroll:!1,modifiers:{x:"left",y:"top"}},initialize:function(){var t=Array.link(arguments,{options:Type.isObject,element:function(t){return null!=t}});this.element=document.id(t.element),this.document=this.element.getDocument(),this.setOptions(t.options||{});t=typeOf(this.options.handle);this.handles=("array"==t||"collection"==t?$$(this.options.handle):document.id(this.options.handle))||this.element,this.mouse={now:{},pos:{}},this.value={start:{},now:{}},this.offsetParent=function(t){t=t.getOffsetParent();return!t||/^(?:body|html)$/i.test(t.tagName)?window:document.id(t)}(this.element),this.selection="selectstart"in document?"selectstart":"mousedown",this.compensateScroll={start:{},diff:{},last:{}},!("ondragstart"in document)||"FileReader"in window||e.ondragstartFixed||(document.ondragstart=Function.convert(!1),e.ondragstartFixed=!0),this.bound={start:this.start.bind(this),check:this.check.bind(this),drag:this.drag.bind(this),stop:this.stop.bind(this),cancel:this.cancel.bind(this),eventStop:Function.convert(!1),scrollListener:this.scrollListener.bind(this)},this.attach()},attach:function(){return this.handles.addEvent("mousedown",this.bound.start),this.handles.addEvent("touchstart",this.bound.start),this.options.compensateScroll&&this.offsetParent.addEvent("scroll",this.bound.scrollListener),this},detach:function(){return this.handles.removeEvent("mousedown",this.bound.start),this.handles.removeEvent("touchstart",this.bound.start),this.options.compensateScroll&&this.offsetParent.removeEvent("scroll",this.bound.scrollListener),this},scrollListener:function(){var t,e;this.mouse.start&&(t=this.offsetParent.getScroll(),"absolute"==this.element.getStyle("position")?(e=this.sumValues(t,this.compensateScroll.last,-1),this.mouse.now=this.sumValues(this.mouse.now,e,1)):this.compensateScroll.diff=this.sumValues(t,this.compensateScroll.start,-1),this.offsetParent!=window&&(this.compensateScroll.diff=this.sumValues(this.compensateScroll.start,t,-1)),this.compensateScroll.last=t,this.render(this.options))},sumValues:function(t,e,i){var n,s={},o=this.options;for(n in o.modifiers)o.modifiers[n]&&(s[n]=t[n]+e[n]*i);return s},start:function(t){if(!this.options.unDraggableTags.contains(t.target.get("tag"))){var e=this.options;if(!t.rightClick){e.preventDefault&&t.preventDefault(),e.stopPropagation&&t.stopPropagation(),this.compensateScroll.start=this.compensateScroll.last=this.offsetParent.getScroll(),this.compensateScroll.diff={x:0,y:0},this.mouse.start=t.page,this.fireEvent("beforeStart",this.element);var i=e.limit;this.limit={x:[],y:[]};var n,s,o=this.offsetParent==window?null:this.offsetParent;for(n in e.modifiers)if(e.modifiers[n]){var a=this.element.getStyle(e.modifiers[n]);if(a&&!a.match(/px$/)&&(a=(s=s||this.element.getCoordinates(o))[e.modifiers[n]]),e.style?this.value.now[n]=(a||0).toInt():this.value.now[n]=this.element[e.modifiers[n]],e.invert&&(this.value.now[n]*=-1),this.mouse.pos[n]=t.page[n]-this.value.now[n],i&&i[n])for(var r=2;r--;){var l=i[n][r];!l&&0!==l||(this.limit[n][r]="function"==typeof l?l():l)}}"number"==typeOf(this.options.grid)&&(this.options.grid={x:this.options.grid,y:this.options.grid});var h={mousemove:this.bound.check,mouseup:this.bound.cancel,touchmove:this.bound.check,touchend:this.bound.cancel};h[this.selection]=this.bound.eventStop,this.document.addEvents(h)}}},check:function(t){this.options.preventDefault&&t.preventDefault(),Math.round(Math.sqrt(Math.pow(t.page.x-this.mouse.start.x,2)+Math.pow(t.page.y-this.mouse.start.y,2)))>this.options.snap&&(this.cancel(),this.document.addEvents({mousemove:this.bound.drag,mouseup:this.bound.stop,touchmove:this.bound.drag,touchend:this.bound.stop}),this.fireEvent("start",[this.element,t]).fireEvent("snap",this.element))},drag:function(t){var e=this.options;e.preventDefault&&t.preventDefault(),this.mouse.now=this.sumValues(t.page,this.compensateScroll.diff,-1),this.render(e),this.fireEvent("drag",[this.element,t])},render:function(t){for(var e in t.modifiers)t.modifiers[e]&&(this.value.now[e]=this.mouse.now[e]-this.mouse.pos[e],t.invert&&(this.value.now[e]*=-1),t.limit&&this.limit[e]&&((this.limit[e][1]||0===this.limit[e][1])&&this.value.now[e]>this.limit[e][1]?this.value.now[e]=this.limit[e][1]:(this.limit[e][0]||0===this.limit[e][0])&&this.value.now[e]<this.limit[e][0]&&(this.value.now[e]=this.limit[e][0])),t.grid[e]&&(this.value.now[e]-=(this.value.now[e]-(this.limit[e][0]||0))%t.grid[e]),t.style?this.element.setStyle(t.modifiers[e],this.value.now[e]+t.unit):this.element[t.modifiers[e]]=this.value.now[e])},cancel:function(t){this.document.removeEvents({mousemove:this.bound.check,mouseup:this.bound.cancel,touchmove:this.bound.check,touchend:this.bound.cancel}),t&&(this.document.removeEvent(this.selection,this.bound.eventStop),this.fireEvent("cancel",this.element))},stop:function(t){var e={mousemove:this.bound.drag,mouseup:this.bound.stop,touchmove:this.bound.drag,touchend:this.bound.stop};e[this.selection]=this.bound.eventStop,this.document.removeEvents(e),this.mouse.start=null,t&&this.fireEvent("complete",[this.element,t])}})}(),Element.implement({makeResizable:function(t){var e=new Drag(this,Object.merge({modifiers:{x:"width",y:"height"}},t));return this.store("resizer",e),e.addEvent("drag",function(){this.fireEvent("resize",e)}.bind(this))}}),Drag.Move=new Class({Extends:Drag,options:{droppables:[],container:!1,precalculate:!1,includeMargins:!0,checkDroppables:!0},initialize:function(t,e){var i;this.parent(t,e),t=this.element,this.droppables=$$(this.options.droppables),this.setContainer(this.options.container),this.options.style&&("left"==this.options.modifiers.x&&"top"==this.options.modifiers.y&&(i=t.getOffsetParent(),e=t.getStyles("left","top"),!i||"auto"!=e.left&&"auto"!=e.top||t.setPosition(t.getPosition(i))),"static"==t.getStyle("position")&&t.setStyle("position","absolute")),this.addEvent("start",this.checkDroppables,!0),this.overed=null},setContainer:function(t){this.container=document.id(t),this.container&&"element"!=typeOf(this.container)&&(this.container=document.id(this.container.getDocument().body))},start:function(t){this.container&&(this.options.limit=this.calculateLimit()),this.options.precalculate&&(this.positions=this.droppables.map(function(t){return t.getCoordinates()})),this.parent(t)},calculateLimit:function(){var e=this.element,i=this.container,n=document.id(e.getOffsetParent())||document.body,t=i.getCoordinates(n),s={},o={},a={},r={},l={},h=n.getScroll();["top","right","bottom","left"].each(function(t){s[t]=e.getStyle("margin-"+t).toInt(),o[t]=e.getStyle("border-"+t).toInt(),a[t]=i.getStyle("margin-"+t).toInt(),r[t]=i.getStyle("border-"+t).toInt(),l[t]=n.getStyle("padding-"+t).toInt()},this);var c=e.offsetWidth+s.left+s.right,u=e.offsetHeight+s.top+s.bottom,d=0+h.x,p=0+h.y,c=t.right-r.right-c+h.x,u=t.bottom-r.bottom-u+h.y;return this.options.includeMargins?(d+=s.left,p+=s.top):(c+=s.right,u+=s.bottom),"relative"==e.getStyle("position")?((h=e.getCoordinates(n)).left-=e.getStyle("left").toInt(),h.top-=e.getStyle("top").toInt(),d-=h.left,p-=h.top,"relative"!=i.getStyle("position")&&(d+=r.left,p+=r.top),c+=s.left-h.left,u+=s.top-h.top,i!=n&&(d+=a.left+l.left,!l.left&&d<0&&(d=0),p+=n==document.body?0:a.top+l.top,!l.top&&p<0&&(p=0))):(d-=s.left,p-=s.top,i!=n&&(d+=t.left+r.left,p+=t.top+r.top)),{x:[d,c],y:[p,u]}},getDroppableCoordinates:function(t){var e=t.getCoordinates();return"fixed"==t.getStyle("position")&&(t=window.getScroll(),e.left+=t.x,e.right+=t.x,e.top+=t.y,e.bottom+=t.y),e},checkDroppables:function(){var t=this.droppables.filter(function(t,e){t=this.positions?this.positions[e]:this.getDroppableCoordinates(t);e=this.mouse.now;return e.x>t.left&&e.x<t.right&&e.y<t.bottom&&e.y>t.top},this).getLast();this.overed!=t&&(this.overed&&this.fireEvent("leave",[this.element,this.overed]),t&&this.fireEvent("enter",[this.element,t]),this.overed=t)},drag:function(t){this.parent(t),this.options.checkDroppables&&this.droppables.length&&this.checkDroppables()},stop:function(t){return this.checkDroppables(),this.fireEvent("drop",[this.element,this.overed,t]),this.overed=null,this.parent(t)}}),Element.implement({makeDraggable:function(t){t=new Drag.Move(this,t);return this.store("dragger",t),t}}),function(){function s(t){return!(t&&!t.offsetHeight&&!t.offsetWidth)}Element.implement({measure:function(t){if(s(this))return t.call(this);for(var e=this.getParent(),i=[];!s(e)&&e!=document.body;)i.push(e.expose()),e=e.getParent();var n=this.expose(),t=t.call(this);return n(),i.each(function(t){t()}),t},expose:function(){if("none"!=this.getStyle("display"))return function(){};var t=this.style.cssText;return this.setStyles({display:"block",position:"absolute",visibility:"hidden"}),function(){this.style.cssText=t}.bind(this)},getDimensions:function(t){t=Object.merge({computeSize:!1},t);function e(t,e){return e.computeSize?t.getComputedSize(e):t.getSize()}var i={x:0,y:0},n=this.getParent("body");if(n&&"none"==this.getStyle("display"))i=this.measure(function(){return e(this,t)});else if(n)try{i=e(this,t)}catch(t){}return Object.append(i,i.x||0===i.x?{width:i.x,height:i.y}:{x:i.width,y:i.height})},getComputedSize:function(t){t=Object.merge({styles:["padding","border"],planes:{height:["top","bottom"],width:["left","right"]},mode:"both"},t);var n,i,e,s,o={},a={width:0,height:0};return"vertical"==t.mode?(delete a.width,delete t.planes.width):"horizontal"==t.mode&&(delete a.height,delete t.planes.height),i=t.styles,e=t.planes,s=[],Object.each(e,function(t){Object.each(t,function(e){i.each(function(t){s.push(t+"-"+e+("border"==t?"-width":""))})})}),s.each(function(t){o[t]=this.getStyle(t).toInt()},this),Object.each(t.planes,function(t,e){var s=e.capitalize(),i=this.getStyle(e);"auto"!=i||n||(n=this.getDimensions()),i=o[e]="auto"==i?n[e]:i.toInt(),a["total"+s]=i,t.each(function(t){var i,n,e=(i=t,n=0,Object.each(o,function(t,e){e.test(i)&&(n+=t.toInt())}),n);a["computed"+t.capitalize()]=e,a["total"+s]+=e})},this),Object.append(a,o)}})}(),function(){this.Slider=new Class({Implements:[Events,Options],Binds:["clickedElement","draggedKnob","scrolledElement"],options:{onTick:function(t){this.setKnobPosition(t)},initialStep:0,snap:!1,offset:0,range:!1,wheel:!1,steps:100,mode:"horizontal"},initialize:function(t,e,i){this.setOptions(i),i=this.options,this.element=document.id(t),e=this.knob=document.id(e),this.previousChange=this.previousEnd=this.step=i.initialStep||(i.range?i.range[0]:0);var n={},t={x:!1,y:!1};switch(i.mode){case"vertical":this.axis="y",this.property="top",this.offset="offsetHeight";break;case"horizontal":this.axis="x",this.property="left",this.offset="offsetWidth"}this.setSliderDimensions(),this.setRange(i.range,null,!0),"static"==e.getStyle("position")&&e.setStyle("position","relative"),e.setStyle(this.property,-i.offset),t[this.axis]=this.property,n[this.axis]=[-i.offset,this.full-i.offset];t={snap:0,limit:n,modifiers:t,onDrag:this.draggedKnob,onStart:this.draggedKnob,onBeforeStart:function(){this.isDragging=!0}.bind(this),onCancel:function(){this.isDragging=!1}.bind(this),onComplete:function(){this.isDragging=!1,this.draggedKnob(),this.end()}.bind(this)};i.snap&&this.setSnap(t),this.drag=new Drag(e,t),null!=i.initialStep&&this.set(i.initialStep,!0),this.attach()},attach:function(){return this.element.addEvent("mousedown",this.clickedElement),this.options.wheel&&this.element.addEvent("mousewheel",this.scrolledElement),this.drag.attach(),this},detach:function(){return this.element.removeEvent("mousedown",this.clickedElement).removeEvent("mousewheel",this.scrolledElement),this.drag.detach(),this},autosize:function(){return this.setSliderDimensions().setKnobPosition(this.toPosition(this.step)),this.drag.options.limit[this.axis]=[-this.options.offset,this.full-this.options.offset],this.options.snap&&this.setSnap(),this},setSnap:function(t){return(t=t||this.drag.options).grid=Math.ceil(this.stepWidth),t.limit[this.axis][1]=this.element[this.offset],this},setKnobPosition:function(t){return this.options.snap&&(t=this.toPosition(this.step)),this.knob.setStyle(this.property,t),this},setSliderDimensions:function(){return this.full=this.element.measure(function(){return this.half=this.knob[this.offset]/2,this.element[this.offset]-this.knob[this.offset]+2*this.options.offset}.bind(this)),this},set:function(t,e){return 0<this.range^t<this.min||(t=this.min),0<this.range^t>this.max||(t=this.max),this.step=t.round(this.modulus.decimalLength),e?this.checkStep().setKnobPosition(this.toPosition(this.step)):this.checkStep().fireEvent("tick",this.toPosition(this.step)).fireEvent("move").end(),this},setRange:function(t,e,i){this.min=Array.pick([t[0],0]),this.max=Array.pick([t[1],this.options.steps]),this.range=this.max-this.min,this.steps=this.options.steps||this.full;this.stepSize=Math.abs(this.range)/this.steps;return this.stepWidth=this.stepSize*this.full/Math.abs(this.range),this.setModulus(),t&&this.set(Array.pick([e,this.step]).limit(this.min,this.max),i),this},setModulus:function(){for(var t=((this.stepSize+"").split(".")[1]||[]).length,e="1";t--;)e+="0";this.modulus={multiplier:e.toInt(10),decimalLength:e.length-1}},clickedElement:function(t){var e;this.isDragging||t.target==this.knob||(e=this.range<0?-1:1,t=(t=t.page[this.axis]-this.element.getPosition()[this.axis]-this.half).limit(-this.options.offset,this.full-this.options.offset),this.step=(this.min+e*this.toStep(t)).round(this.modulus.decimalLength),this.checkStep().fireEvent("tick",t).fireEvent("move").end())},scrolledElement:function(t){var e="horizontal"==this.options.mode?t.wheel<0:0<t.wheel;this.set(this.step+(e?-1:1)*this.stepSize),t.stop()},draggedKnob:function(){var t=this.range<0?-1:1,e=(e=this.drag.value.now[this.axis]).limit(-this.options.offset,this.full-this.options.offset);this.step=(this.min+t*this.toStep(e)).round(this.modulus.decimalLength),this.checkStep(),this.fireEvent("move")},checkStep:function(){var t=this.step;return this.previousChange!=t&&(this.previousChange=t,this.fireEvent("change",t)),this},end:function(){var t=this.step;return this.previousEnd!==t&&(this.previousEnd=t,this.fireEvent("complete",t+"")),this},toStep:function(t){t=(t+this.options.offset)*this.stepSize/this.full*this.steps;return this.options.steps?(t-t*this.modulus.multiplier%(this.stepSize*this.modulus.multiplier)/this.modulus.multiplier).round(this.modulus.decimalLength):t},toPosition:function(t){return this.full*Math.abs(this.min-t)/(this.steps*this.stepSize)-this.options.offset||0}})}(),function(){this.Sortables=new Class({Implements:[Events,Options],options:{opacity:1,clone:!1,revert:!1,handle:!1,dragOptions:{},unDraggableTags:["button","input","a","textarea","select","option"]},initialize:function(t,e){this.setOptions(e),this.elements=[],this.lists=[],this.idle=!0,this.addLists($$(document.id(t)||t)),this.options.clone||(this.options.revert=!1),this.options.revert&&(this.effect=new Fx.Morph(null,Object.merge({duration:250,link:"cancel"},this.options.revert)))},attach:function(){return this.addLists(this.lists),this},detach:function(){return this.lists=this.removeLists(this.lists),this},addItems:function(){return Array.flatten(arguments).each(function(e){this.elements.push(e);var t=e.retrieve("sortables:start",function(t){this.start.call(this,t,e)}.bind(this));(this.options.handle&&e.getElement(this.options.handle)||e).addEvent("mousedown",t)},this),this},addLists:function(){return Array.flatten(arguments).each(function(t){this.lists.include(t),this.addItems(t.getChildren())},this),this},removeItems:function(){return $$(Array.flatten(arguments).map(function(t){this.elements.erase(t);var e=t.retrieve("sortables:start");return(this.options.handle&&t.getElement(this.options.handle)||t).removeEvent("mousedown",e),t},this))},removeLists:function(){return $$(Array.flatten(arguments).map(function(t){return this.lists.erase(t),this.removeItems(t.getChildren()),t},this))},getDroppableCoordinates:function(t){var e=t.getOffsetParent(),i=t.getPosition(e),n=window.getScroll(),t=e.getScroll();return i.x+=t.x,i.y+=t.y,"fixed"==e.getStyle("position")&&(i.x-=n.x,i.y-=n.y),i},getClone:function(t,i){if(!this.options.clone)return new Element(i.tagName).inject(document.body);if("function"==typeOf(this.options.clone))return this.options.clone.call(this,t,i,this.list);t=i.clone(!0).setStyles({margin:0,position:"absolute",visibility:"hidden",width:i.getStyle("width")}).addEvent("mousedown",function(t){i.fireEvent("mousedown",t)});return t.get("html").test("radio")&&t.getElements("input[type=radio]").each(function(t,e){t.set("name","clone_"+e),t.get("checked")&&i.getElements("input[type=radio]")[e].set("checked",!0)}),t.inject(this.list).setPosition(this.getDroppableCoordinates(this.element))},getDroppables:function(){var t=this.list.getChildren().erase(this.clone).erase(this.element);return this.options.constrain||t.append(this.lists).erase(this.list),t},insert:function(t,e){var i="inside";this.lists.contains(e)?(this.list=e,this.drag.droppables=this.getDroppables()):i=this.element.getAllPrevious().contains(e)?"before":"after",this.element.inject(e,i),this.fireEvent("sort",[this.element,this.clone])},start:function(t,e){!this.idle||t.rightClick||!this.options.handle&&this.options.unDraggableTags.contains(t.target.get("tag"))||(this.idle=!1,this.element=e,this.opacity=e.getStyle("opacity"),this.list=e.getParent(),this.clone=this.getClone(t,e),this.drag=new Drag.Move(this.clone,Object.merge({droppables:this.getDroppables()},this.options.dragOptions)).addEvents({onSnap:function(){t.stop(),this.clone.setStyle("visibility","visible"),this.element.setStyle("opacity",this.options.opacity||0),this.fireEvent("start",[this.element,this.clone])}.bind(this),onEnter:this.insert.bind(this),onCancel:this.end.bind(this),onComplete:this.end.bind(this)}),this.clone.inject(this.element,"before"),this.drag.start(t))},end:function(){this.drag.detach(),this.element.setStyle("opacity",this.opacity);var t,e,i,n,s=this;this.effect?(t=this.element.getStyles("width","height"),i=(e=this.clone).computePosition(this.getDroppableCoordinates(e)),n=function(){this.removeEvent("cancel",n),e.destroy(),s.reset()},this.effect.element=e,this.effect.start({top:i.top,left:i.left,width:t.width,height:t.height,opacity:.25}).addEvent("cancel",n).chain(n)):(this.clone.destroy(),s.reset())},reset:function(){this.idle=!0,this.fireEvent("complete",this.element)},serialize:function(){var e=Array.link(arguments,{modifier:Type.isFunction,index:function(t){return null!=t}}),t=this.lists.map(function(t){return t.getChildren().map(e.modifier||function(t){return t.get("id")},this)},this),i=e.index;return((i=1==this.lists.length?0:i)||0===i)&&0<=i&&i<this.lists.length?t[i]:t}})}(),function(){for(var i={relay:!1},t=["once","throttle","pause"],e=t.length;e--;)i[t[e]]=Events.lookupPseudo(t[e]);DOMEvent.definePseudo=function(t,e){return i[t]=e,this};var n=Element.prototype;[Element,Window,Document].invoke("implement",Events.Pseudos(i,n.addEvent,n.removeEvent))}(),function(){var a="$moo:keys-pressed",r="$moo:keys-keyup";DOMEvent.definePseudo("keys",function(t,e,i){var n=i[0],s=[],o=this.retrieve(a,[]),t=t.value;"+"!=t?s.append(t.replace("++",function(){return s.push("+"),""}).split("+")):s=["+"],o.include(n.key),s.every(function(t){return o.contains(t)})&&e.apply(this,i),this.store(a,o),this.retrieve(r)||this.store(r,i=function(t){!function(){o=this.retrieve(a,[]).erase(t.key),this.store(a,o)}.delay(0,this)}).addEvent("keyup",i)}),DOMEvent.defineKeys({16:"shift",17:"control",18:"alt",20:"capslock",33:"pageup",34:"pagedown",35:"end",36:"home",144:"numlock",145:"scrolllock",186:";",187:"=",188:",",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",107:"+",109:"-",189:"-"})}(),function(){function t(t,e){var i,n=t;for(i in e)n=n.replace(e[i],i);return n}function i(t,e){return t=t||(e?"":"\\w+"),new RegExp(e?"<"+t+"(?!\\w)[^>]*>([\\s\\S]*?)</"+t+"(?!\\w)>":"</?"+t+"/?>|<"+t+"[\\s|/][^>]*>","gi")}var e={a:/[àáâãäåăą]/g,A:/[ÀÁÂÃÄÅĂĄ]/g,c:/[ćčç]/g,C:/[ĆČÇ]/g,d:/[ďđ]/g,D:/[ĎÐ]/g,e:/[èéêëěę]/g,E:/[ÈÉÊËĚĘ]/g,g:/[ğ]/g,G:/[Ğ]/g,i:/[ìíîï]/g,I:/[ÌÍÎÏ]/g,l:/[ĺľł]/g,L:/[ĹĽŁ]/g,n:/[ñňń]/g,N:/[ÑŇŃ]/g,o:/[òóôõöøő]/g,O:/[ÒÓÔÕÖØ]/g,r:/[řŕ]/g,R:/[ŘŔ]/g,s:/[ššş]/g,S:/[ŠŞŚ]/g,t:/[ťţ]/g,T:/[ŤŢ]/g,u:/[ùúûůüµ]/g,U:/[ÙÚÛŮÜ]/g,y:/[ÿý]/g,Y:/[ŸÝ]/g,z:/[žźż]/g,Z:/[ŽŹŻ]/g,th:/[þ]/g,TH:/[Þ]/g,dh:/[ð]/g,DH:/[Ð]/g,ss:/[ß]/g,oe:/[œ]/g,OE:/[Œ]/g,ae:/[æ]/g,AE:/[Æ]/g},n={" ":/[\xa0\u2002\u2003\u2009]/g,"*":/[\xb7]/g,"'":/[\u2018\u2019]/g,'"':/[\u201c\u201d]/g,"...":/[\u2026]/g,"-":/[\u2013]/g,"&raquo;":/[\uFFFD]/g},s={ms:1,s:1e3,m:6e4,h:36e5},o=/(\d*.?\d+)([msh]+)/;String.implement({standardize:function(){return t(this,e)},repeat:function(t){return new Array(t+1).join(this)},pad:function(t,e,i){if(this.length>=t)return this;t=(null==e?" ":""+e).repeat(t-this.length).substr(0,t-this.length);return i&&"right"!=i?"left"==i?t+this:t.substr(0,(t.length/2).floor())+this+t.substr(0,(t.length/2).ceil()):this+t},getTags:function(t,e){return this.match(i(t,e))||[]},stripTags:function(t,e){return this.replace(i(t,e),"")},tidy:function(){return t(this,n)},truncate:function(t,e,i){var n,s=this;return null==e&&1==arguments.length&&(e="…"),s.length>t&&(s=s.substring(0,t),!i||-1!=(n=s.lastIndexOf(i))&&(s=s.substr(0,n)),e&&(s+=e)),s},ms:function(){var t=o.exec(this);return null==t?Number(this):Number(t[1])*s[t[2]]}})}(),Element.implement({tidy:function(){this.set("value",this.get("value").tidy())},getTextInRange:function(t,e){return this.get("value").substring(t,e)},getSelectedText:function(){return this.setSelectionRange?this.getTextInRange(this.getSelectionStart(),this.getSelectionEnd()):document.selection.createRange().text},getSelectedRange:function(){if(null!=this.selectionStart)return{start:this.selectionStart,end:this.selectionEnd};var t={start:0,end:0},e=this.getDocument().selection.createRange();if(!e||e.parentElement()!=this)return t;var i,n,s=e.duplicate();return"text"==this.type?(t.start=0-s.moveStart("character",-1e5),t.end=t.start+e.text.length):(n=(i=this.get("value")).length,s.moveToElementText(this),s.setEndPoint("StartToEnd",e),s.text.length&&(n-=i.match(/[\n\r]*$/)[0].length),t.end=n-s.text.length,s.setEndPoint("StartToStart",e),t.start=n-s.text.length),t},getSelectionStart:function(){return this.getSelectedRange().start},getSelectionEnd:function(){return this.getSelectedRange().end},setCaretPosition:function(t){return"end"==t&&(t=this.get("value").length),this.selectRange(t,t),this},getCaretPosition:function(){return this.getSelectedRange().start},selectRange:function(t,e){var i;return this.setSelectionRange?(this.focus(),this.setSelectionRange(t,e)):(e=(i=this.get("value")).substr(t,e-t).replace(/\r/g,"").length,t=i.substr(0,t).replace(/\r/g,"").length,(i=this.createTextRange()).collapse(!0),i.moveEnd("character",t+e),i.moveStart("character",t),i.select()),this},insertAtCursor:function(t,e){var i=this.getSelectedRange(),n=this.get("value");return this.set("value",n.substring(0,i.start)+t+n.substring(i.end,n.length)),!1!==e?this.selectRange(i.start,i.start+t.length):this.setCaretPosition(i.start+t.length),this},insertAroundCursor:function(t,e){t=Object.append({before:"",defaultMiddle:"",after:""},t);var i=this.getSelectedText()||t.defaultMiddle,n=this.getSelectedRange(),s=this.get("value");return n.start==n.end?(this.set("value",s.substring(0,n.start)+t.before+i+t.after+s.substring(n.end,s.length)),this.selectRange(n.start+t.before.length,n.end+t.before.length+i.length)):(i=s.substring(n.start,n.end),this.set("value",s.substring(0,n.start)+t.before+i+t.after+s.substring(n.end,s.length)),t=n.start+t.before.length,!1!==e?this.selectRange(t,t+i.length):this.setCaretPosition(t+s.length)),this}}),function(){var r=!1,l=!1;Element.implement({pin:function(t,e){if(l||(i=new Element("div").setStyles({position:"fixed",top:0,right:0}).inject(document.body),r=0===i.offsetTop,i.dispose(),l=!0),"none"==this.getStyle("display"))return this;var i=window.getScroll();if(!1!==t){var n,s,o,a=this.getPosition();this.retrieve("pin:_pinned")||(t={top:a.y-i.y,left:a.x-i.x,margin:"0px",padding:"0px"},r&&!e?this.setStyle("position","fixed").setStyles(t):(n=this.getOffsetParent(),s=this.getPosition(n),o=this.getStyles("left","top"),(n&&"auto"==o.left||"auto"==o.top)&&this.setPosition(s),"static"==this.getStyle("position")&&this.setStyle("position","absolute"),s={x:o.left.toInt()-i.x,y:o.top.toInt()-i.y},o=function(){var t;this.retrieve("pin:_pinned")&&(t=window.getScroll(),this.setStyles({left:s.x+t.x,top:s.y+t.y}))}.bind(this),this.store("pin:_scrollFixer",o),window.addEvent("scroll",o)),this.store("pin:_pinned",!0))}else{if(!this.retrieve("pin:_pinned"))return this;"static"!=(n=this.getParent()).getComputedStyle("position")||n.getOffsetParent();a=this.getPosition(),this.store("pin:_pinned",!1),(o=this.retrieve("pin:_scrollFixer"))?(this.store("pin:_scrollFixer",null),window.removeEvent("scroll",o)):this.setStyles({position:"absolute",top:a.y+i.y,left:a.x+i.x}),this.removeClass("isPinned")}return this},unpin:function(){return this.pin(!1)},togglePin:function(){return this.pin(!this.retrieve("pin:_pinned"))}})}(),function(i){var s=Element.Position={options:{relativeTo:document.body,position:{x:"center",y:"center"},offset:{x:0,y:0}},getOptions:function(t,e){return e=Object.merge({},s.options,e),s.setPositionOption(e),s.setEdgeOption(e),s.setOffsetOption(t,e),s.setDimensionsOption(t,e),e},setPositionOption:function(t){t.position=s.getCoordinateFromValue(t.position)},setEdgeOption:function(t){var e=s.getCoordinateFromValue(t.edge);t.edge=e||("center"==t.position.x&&"center"==t.position.y?{x:"center",y:"center"}:{x:"left",y:"top"})},setOffsetOption:function(t,e){var i,n=t.measure(function(){return document.id(this.getOffsetParent())});n&&n!=t.getDocument().body&&(i=n.getScroll(),t=n.measure(function(){var t,e=this.getPosition();return"fixed"==this.getStyle("position")&&(t=window.getScroll(),e.x+=t.x,e.y+=t.y),e}),e.offset={parentPositioned:n!=document.id(e.relativeTo),x:e.offset.x-t.x+i.x,y:e.offset.y-t.y+i.y})},setDimensionsOption:function(t,e){e.dimensions=t.getDimensions({computeSize:!0,styles:["padding","border","margin"]})},getPosition:function(t,e){var i={};e=s.getOptions(t,e);var n=document.id(e.relativeTo)||document.body;s.setPositionCoordinates(e,i,n),e.edge&&s.toEdge(i,e);t=e.offset;return i.left=(0<=i.x||t.parentPositioned||e.allowNegative?i.x:0).toInt(),i.top=(0<=i.y||t.parentPositioned||e.allowNegative?i.y:0).toInt(),s.toMinMax(i,e),!e.relFixedPosition&&"fixed"!=n.getStyle("position")||s.toRelFixedPosition(n,i),e.ignoreScroll&&s.toIgnoreScroll(n,i),e.ignoreMargins&&s.toIgnoreMargins(i,e),i.left=Math.ceil(i.left),i.top=Math.ceil(i.top),delete i.x,delete i.y,i},setPositionCoordinates:function(t,e,i){var n=t.offset.y,s=t.offset.x,o=i==document.body?window.getScroll():i.getPosition(),a=o.y,r=o.x,l=window.getSize();switch(t.position.x){case"left":e.x=r+s;break;case"right":e.x=r+s+i.offsetWidth;break;default:e.x=r+(i==document.body?l.x:i.offsetWidth)/2+s}switch(t.position.y){case"top":e.y=a+n;break;case"bottom":e.y=a+n+i.offsetHeight;break;default:e.y=a+(i==document.body?l.y:i.offsetHeight)/2+n}},toMinMax:function(i,n){var s,o={left:"x",top:"y"};["minimum","maximum"].each(function(e){["left","top"].each(function(t){null!=(s=n[e]?n[e][o[t]]:null)&&("minimum"==e?i[t]<s:i[t]>s)&&(i[t]=s)})})},toRelFixedPosition:function(t,e){var i=window.getScroll();e.top+=i.y,e.left+=i.x},toIgnoreScroll:function(t,e){t=t.getScroll();e.top-=t.y,e.left-=t.x},toIgnoreMargins:function(t,e){t.left+="right"==e.edge.x?e.dimensions["margin-right"]:"center"!=e.edge.x?-e.dimensions["margin-left"]:-e.dimensions["margin-left"]+(e.dimensions["margin-right"]+e.dimensions["margin-left"])/2,t.top+="bottom"==e.edge.y?e.dimensions["margin-bottom"]:"center"!=e.edge.y?-e.dimensions["margin-top"]:-e.dimensions["margin-top"]+(e.dimensions["margin-bottom"]+e.dimensions["margin-top"])/2},toEdge:function(t,e){var i={},n=e.dimensions,e=e.edge;switch(e.x){case"left":i.x=0;break;case"right":i.x=-n.x-n.computedRight-n.computedLeft;break;default:i.x=-Math.round(n.totalWidth/2)}switch(e.y){case"top":i.y=0;break;case"bottom":i.y=-n.y-n.computedTop-n.computedBottom;break;default:i.y=-Math.round(n.totalHeight/2)}t.x+=i.x,t.y+=i.y},getCoordinateFromValue:function(t){return"string"!=typeOf(t)?t:{x:(t=t.toLowerCase()).test("left")?"left":t.test("right")?"right":"center",y:t.test(/upper|top/)?"top":t.test("bottom")?"bottom":"center"}}};Element.implement({position:function(t){if(t&&(null!=t.x||null!=t.y))return i?i.apply(this,arguments):this;var e=this.setStyle("position","absolute").calculatePosition(t);return t&&t.returnPos?e:this.setStyles(e)},calculatePosition:function(t){return s.getPosition(this,t)}})}(Element.prototype.position),Element.implement({isDisplayed:function(){return"none"!=this.getStyle("display")},isVisible:function(){var t=this.offsetWidth,e=this.offsetHeight;return(0!=t||0!=e)&&(0<t&&0<e||"none"!=this.style.display)},toggle:function(){return this[this.isDisplayed()?"hide":"show"]()},hide:function(){var t;try{t=this.getStyle("display")}catch(t){}return"none"==t?this:this.store("element:_originalDisplay",t||"").setStyle("display","none")},show:function(t){return!t&&this.isDisplayed()?this:(t=t||this.retrieve("element:_originalDisplay")||"block",this.setStyle("display","none"==t?"block":t))},swapClass:function(t,e){return this.removeClass(t).addClass(e)}}),Document.implement({clearSelection:function(){if(window.getSelection){var t=window.getSelection();t&&t.removeAllRanges&&t.removeAllRanges()}else if(document.selection&&document.selection.empty)try{document.selection.empty()}catch(t){}}}),Elements.from=function(t,e){var i,e=(t=e||null==e?t.stripScripts():t).match(/^\s*(?:<!--.*?-->\s*)*<(t[dhr]|tbody|tfoot|thead)/i);return e&&(i=new Element("table"),e=e[1].toLowerCase(),["td","th","tr"].contains(e)&&(i=new Element("tbody").inject(i),"tr"!=e&&(i=new Element("tr").inject(i)))),(i||new Element("div")).set("html",t).getChildren()},function(){var i=this.IframeShim=new Class({Implements:[Options,Events,Class.Occlude],options:{className:"iframeShim",src:'javascript:false;document.write("");',display:!1,zIndex:null,margin:0,offset:{x:0,y:0},browsers:!1},property:"IframeShim",initialize:function(t,e){return this.element=document.id(t),this.occlude()?this.occluded:(this.setOptions(e),this.makeShim(),this)},makeShim:function(){var t,e;this.options.browsers?((e=this.element.getStyle("zIndex").toInt())||(e=1,"static"!=(t=this.element.getStyle("position"))&&t||this.element.setStyle("position","relative"),this.element.setStyle("zIndex",e)),e=(null!=this.options.zIndex||0===this.options.zIndex)&&e>this.options.zIndex?this.options.zIndex:e-1,this.shim=new Element("iframe",{src:this.options.src,scrolling:"no",frameborder:0,styles:{zIndex:e=e<0?1:e,position:"absolute",border:"none",filter:"progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)"},class:this.options.className}).store("IframeShim",this),e=function(){this.shim.inject(this.element,"after"),this[this.options.display?"show":"hide"](),this.fireEvent("inject")}.bind(this),i.ready?e():window.addEvent("load",e)):this.position=this.hide=this.show=this.dispose=Function.convert(this)},position:function(){if(!i.ready||!this.shim)return this;var t=this.element.measure(function(){return this.getSize()});return null!=this.options.margin&&(t.x=t.x-2*this.options.margin,t.y=t.y-2*this.options.margin,this.options.offset.x+=this.options.margin,this.options.offset.y+=this.options.margin),this.shim.set({width:t.x,height:t.y}).position({relativeTo:this.element,offset:this.options.offset}),this},hide:function(){return this.shim&&this.shim.setStyle("display","none"),this},show:function(){return this.shim&&this.shim.setStyle("display","block"),this.position()},dispose:function(){return this.shim&&this.shim.dispose(),this},destroy:function(){return this.shim&&this.shim.destroy(),this}})}(),window.addEvent("load",function(){IframeShim.ready=!0}),function(){this.Mask=new Class({Implements:[Options,Events],Binds:["position"],options:{style:{},class:"mask",maskMargins:!1,useIframeShim:!0,iframeShimOptions:{}},initialize:function(t,e){this.target=document.id(t)||document.id(document.body),this.target.store("mask",this),this.setOptions(e),this.render(),this.inject()},render:function(){this.element=new Element("div",{class:this.options.class,id:this.options.id||"mask-"+String.uniqueID(),styles:Object.merge({},this.options.style,{display:"none"}),events:{click:function(t){this.fireEvent("click",t),this.options.hideOnClick&&this.hide()}.bind(this)}}),this.hidden=!0},toElement:function(){return this.element},inject:function(t,e){e=e||(this.options.inject?this.options.inject.where:"")||(this.target==document.body?"inside":"after"),t=t||this.options.inject&&this.options.inject.target||this.target,this.element.inject(t,e),this.options.useIframeShim&&(this.shim=new IframeShim(this.element,this.options.iframeShimOptions),this.addEvents({show:this.shim.show.bind(this.shim),hide:this.shim.hide.bind(this.shim),destroy:this.shim.destroy.bind(this.shim)}))},position:function(){return this.resize(this.options.width,this.options.height),this.element.position({relativeTo:this.target,position:"topLeft",ignoreMargins:!this.options.maskMargins,ignoreScroll:this.target==document.body}),this},resize:function(t,e){var i={styles:["padding","border"]};this.options.maskMargins&&i.styles.push("margin");var n=this.target.getComputedSize(i);return this.target==document.body&&(this.element.setStyles({width:0,height:0}),i=window.getScrollSize(),n.totalHeight<i.y&&(n.totalHeight=i.y),n.totalWidth<i.x&&(n.totalWidth=i.x)),this.element.setStyles({width:Array.pick([t,n.totalWidth,n.x]),height:Array.pick([e,n.totalHeight,n.y])}),this},show:function(){return this.hidden&&(window.addEvent("resize",this.position),this.position(),this.showMask.apply(this,arguments)),this},showMask:function(){this.element.setStyle("display","block"),this.hidden=!1,this.fireEvent("show")},hide:function(){return this.hidden?this:(window.removeEvent("resize",this.position),this.hideMask.apply(this,arguments),this.options.destroyOnHide?this.destroy():this)},hideMask:function(){this.element.setStyle("display","none"),this.hidden=!0,this.fireEvent("hide")},toggle:function(){this[this.hidden?"show":"hide"]()},destroy:function(){this.hide(),this.element.destroy(),this.fireEvent("destroy"),this.target.eliminate("mask")}})}(),Element.Properties.mask={set:function(t){var e=this.retrieve("mask");return e&&e.destroy(),this.eliminate("mask").store("mask:options",t)},get:function(){var t=this.retrieve("mask");return t||(t=new Mask(this,this.retrieve("mask:options")),this.store("mask",t)),t}},Element.implement({mask:function(t){return t&&this.set("mask",t),this.get("mask").show(),this},unmask:function(){return this.get("mask").hide(),this}}),function(){this.Spinner=new Class({Extends:this.Mask,Implements:Chain,options:{class:"spinner",containerPosition:{},content:{class:"spinner-content"},messageContainer:{class:"spinner-msg"},img:{class:"spinner-img"},fxOptions:{link:"chain"}},initialize:function(t,e){this.target=document.id(t)||document.id(document.body),this.target.store("spinner",this),this.setOptions(e),this.render(),this.inject();e=function(){this.active=!1}.bind(this);this.addEvents({hide:e,show:e})},render:function(){this.parent(),this.element.set("id",this.options.id||"spinner-"+String.uniqueID()),this.content=document.id(this.options.content)||new Element("div",this.options.content),this.content.inject(this.element),this.options.message&&(this.msg=document.id(this.options.message)||new Element("p",this.options.messageContainer).appendText(this.options.message),this.msg.inject(this.content)),this.options.img&&(this.img=document.id(this.options.img)||new Element("div",this.options.img),this.img.inject(this.content)),this.element.set("tween",this.options.fxOptions)},show:function(t){return this.active?this.chain(this.show.bind(this)):this.hidden?(this.target.set("aria-busy","true"),this.active=!0,this.parent(t)):(this.callChain.delay(20,this),this)},showMask:function(t){var e=function(){this.content.position(Object.merge({relativeTo:this.element},this.options.containerPosition))}.bind(this);t?(this.parent(),e()):(this.options.style.opacity||(this.options.style.opacity=this.element.getStyle("opacity").toFloat()),this.element.setStyles({display:"block",opacity:0}).tween("opacity",this.options.style.opacity),e(),this.hidden=!1,this.fireEvent("show"),this.callChain())},hide:function(t){return this.active?this.chain(this.hide.bind(this)):this.hidden?(this.callChain.delay(20,this),this):(this.target.set("aria-busy","false"),this.active=!0,this.parent(t))},hideMask:function(t){if(t)return this.parent();this.element.tween("opacity",0).get("tween").chain(function(){this.element.setStyle("display","none"),this.hidden=!0,this.fireEvent("hide"),this.callChain()}.bind(this))},destroy:function(){this.content.destroy(),this.parent(),this.target.eliminate("spinner")}})}(),Request=Class.refactor(Request,{options:{useSpinner:!1,spinnerOptions:{},spinnerTarget:!1},initialize:function(t){this._send=this.send,this.send=function(t){var e=this.getSpinner();return e?e.chain(this._send.pass(t,this)).show():this._send(t),this},this.previous(t)},getSpinner:function(){var t,e;return this.spinner||(t=document.id(this.options.spinnerTarget)||document.id(this.options.update),this.options.useSpinner&&t&&(t.set("spinner",this.options.spinnerOptions),e=this.spinner=t.get("spinner"),["complete","exception","cancel"].each(function(t){this.addEvent(t,e.hide.bind(e))},this))),this.spinner}}),Element.Properties.spinner={set:function(t){var e=this.retrieve("spinner");return e&&e.destroy(),this.eliminate("spinner").store("spinner:options",t)},get:function(){var t=this.retrieve("spinner");return t||(t=new Spinner(this,this.retrieve("spinner:options")),this.store("spinner",t)),t}},Element.implement({spin:function(t){return t&&this.set("spinner",t),this.get("spinner").show(),this},unspin:function(){return this.get("spinner").hide(),this}}),function(){function l(t){return decodeURIComponent(t.replace(/\+/g," "))}String.implement({parseQueryString:function(a,i){null==a&&(a=!0),null==i&&(i=!0);var t=this.split(/[&;]/),r={};return t.length&&t.each(function(t){var e=t.indexOf("=")+1,n=e?t.substr(e):"",s=e?t.substr(0,e-1).match(/([^\]\[]+|(\B)(?=\]))/g):[t],o=r;s&&(i&&(n=l(n)),s.each(function(t,e){a&&(t=l(t));var i=o[t];e<s.length-1?o=o[t]=i||{}:"array"==typeOf(i)?i.push(n):o[t]=null!=i?[i,n]:n}))}),r},cleanQueryString:function(n){return this.split("&").filter(function(t){var e=t.indexOf("="),i=e<0?"":t.substr(0,e),e=t.substr(e+1);return n?n.call(null,i,e):e||0===e}).join("&")}})}(),window.Form||(window.Form={}),Form.Request=new Class({Binds:["onSubmit","onFormValidate"],Implements:[Options,Events,Class.Occlude],options:{requestOptions:{evalScripts:!0,useSpinner:!0,emulation:!1,link:"ignore"},sendButtonClicked:!0,extraData:{},resetForm:!0},property:"form.request",initialize:function(t,e,i){if(this.element=document.id(t),this.occlude())return this.occluded;this.setOptions(i).setTarget(e).attach()},setTarget:function(t){return this.target=document.id(t),this.request?this.request.setOptions({update:this.target}):this.makeRequest(),this},toElement:function(){return this.element},makeRequest:function(){var o=this;return this.request=new $Request.HTML(Object.merge({update:this.target,emulation:!1,spinnerTarget:this.element,method:this.element.get("method")||"post"},this.options.requestOptions)).addEvents({success:function(e,i,n,s){["complete","success"].each(function(t){o.fireEvent(t,[o.target,e,i,n,s])})},failure:function(){o.fireEvent("complete",arguments).fireEvent("failure",arguments)},exception:function(){o.fireEvent("failure",arguments)}}),this.attachReset()},attachReset:function(){return this.options.resetForm&&this.request.addEvent("success",function(){Function.attempt(function(){this.element.reset()}.bind(this)),window.OverText&&OverText.update()}.bind(this)),this},attach:function(t){var e=0!=t?"addEvent":"removeEvent";this.element[e]("click:relay(button, input[type=submit])",this.saveClickedButton.bind(this));t=this.element.retrieve("validator");return t?t[e]("onFormValidate",this.onFormValidate):this.element[e]("submit",this.onSubmit),this},detach:function(){return this.attach(!1)},enable:function(){return this.attach()},disable:function(){return this.detach()},onFormValidate:function(t,e,i){var n;i&&(n=this.element.retrieve("validator"),(t||n&&!n.options.stopOnFailure)&&(i.stop(),this.send()))},onSubmit:function(t){var e=this.element.retrieve("validator");if(e)return this.element.removeEvent("submit",this.onSubmit),e.addEvent("onFormValidate",this.onFormValidate),void e.validate(t);t&&t.stop(),this.send()},saveClickedButton:function(t,e){var i=e.get("name");i&&this.options.sendButtonClicked&&(this.options.extraData[i]=e.get("value")||!0,this.clickedCleaner=function(){delete this.options.extraData[i],this.clickedCleaner=function(){}}.bind(this))},clickedCleaner:function(){},send:function(){var t=this.element.toQueryString().trim(),e=Object.toQueryString(this.options.extraData);return t?t+="&"+e:t=e,this.fireEvent("send",[this.element,t.parseQueryString()]),this.request.send({data:t,url:this.options.requestOptions.url||this.element.get("action")}),this.clickedCleaner(),this}}),Element.implement("formUpdate",function(t,e){var i=this.retrieve("form.request");return i?(t&&i.setTarget(t),e&&i.setOptions(e).makeRequest()):i=new Form.Request(this,t,e),i.send(),this}),function(){function n(t){var e,i=t.options.hideInputs;return window.OverText&&(e=[null],OverText.each(function(t){e.include("."+t.options.labelClass)}),e&&(i+=e.join(", "))),i?t.element.getElements(i):null}Fx.Reveal=new Class({Extends:Fx.Morph,options:{link:"cancel",styles:["padding","border","margin"],transitionOpacity:"opacity"in document.documentElement,mode:"vertical",display:function(){return"tr"!=this.element.get("tag")?"block":"table-row"},opacity:1,hideInputs:"opacity"in document.documentElement?null:"select, input, textarea, object, embed"},dissolve:function(){var t,i,e;return this.hiding||this.showing?"chain"==this.options.link?this.chain(this.dissolve.bind(this)):"cancel"!=this.options.link||this.hiding||(this.cancel(),this.dissolve()):"none"!=this.element.getStyle("display")?(this.hiding=!0,this.showing=!1,this.hidden=!0,this.cssText=this.element.style.cssText,t=this.element.getComputedSize({styles:this.options.styles,mode:this.options.mode}),this.options.transitionOpacity&&(t.opacity=this.options.opacity),i={},Object.each(t,function(t,e){i[e]=[t,0]}),this.element.setStyles({display:Function.convert(this.options.display).call(this),overflow:"hidden"}),(e=n(this))&&e.setStyle("visibility","hidden"),this.$chain.unshift(function(){this.hidden&&(this.hiding=!1,this.element.style.cssText=this.cssText,this.element.setStyle("display","none"),e&&e.setStyle("visibility","visible")),this.fireEvent("hide",this.element),this.callChain()}.bind(this)),this.start(i)):(this.callChain.delay(10,this),this.fireEvent("complete",this.element),this.fireEvent("hide",this.element)),this},reveal:function(){var t,i,e;return this.showing||this.hiding?"chain"==this.options.link?this.chain(this.reveal.bind(this)):"cancel"!=this.options.link||this.showing||(this.cancel(),this.reveal()):"none"==this.element.getStyle("display")?(this.hiding=!1,this.showing=!0,this.hidden=!1,this.cssText=this.element.style.cssText,this.element.measure(function(){t=this.element.getComputedSize({styles:this.options.styles,mode:this.options.mode})}.bind(this)),null!=this.options.heightOverride&&(t.height=this.options.heightOverride.toInt()),null!=this.options.widthOverride&&(t.width=this.options.widthOverride.toInt()),this.options.transitionOpacity&&(this.element.setStyle("opacity",0),t.opacity=this.options.opacity),i={height:0,display:Function.convert(this.options.display).call(this)},Object.each(t,function(t,e){i[e]=0}),i.overflow="hidden",this.element.setStyles(i),(e=n(this))&&e.setStyle("visibility","hidden"),this.$chain.unshift(function(){this.element.style.cssText=this.cssText,this.element.setStyle("display",Function.convert(this.options.display).call(this)),this.hidden||(this.showing=!1),e&&e.setStyle("visibility","visible"),this.callChain(),this.fireEvent("show",this.element)}.bind(this)),this.start(t)):(this.callChain(),this.fireEvent("complete",this.element),this.fireEvent("show",this.element)),this},toggle:function(){return"none"==this.element.getStyle("display")?this.reveal():this.dissolve(),this},cancel:function(){return this.parent.apply(this,arguments),null!=this.cssText&&(this.element.style.cssText=this.cssText),this.hiding=!1,this.showing=!1,this}}),Element.Properties.reveal={set:function(t){return this.get("reveal").cancel().setOptions(t),this},get:function(){var t=this.retrieve("reveal");return t||(t=new Fx.Reveal(this),this.store("reveal",t)),t}},Element.Properties.dissolve=Element.Properties.reveal,Element.implement({reveal:function(t){return this.get("reveal").setOptions(t).reveal(),this},dissolve:function(t){return this.get("reveal").setOptions(t).dissolve(),this},nix:function(t){var e=Array.link(arguments,{destroy:Type.isBoolean,options:Type.isObject});return this.get("reveal").setOptions(t).dissolve().chain(function(){this[e.destroy?"destroy":"dispose"]()}.bind(this)),this},wink:function(){var t=Array.link(arguments,{duration:Type.isNumber,options:Type.isObject}),e=this.get("reveal").setOptions(t.options);e.reveal().chain(function(){!function(){e.dissolve()}.delay(t.duration||2e3)})}})}(),Form.Request.Append=new Class({Extends:Form.Request,options:{useReveal:!0,revealOptions:{},inject:"bottom"},makeRequest:function(){this.request=new $Request.HTML(Object.merge({url:this.element.get("action"),method:this.element.get("method")||"post",spinnerTarget:this.element},this.options.requestOptions,{evalScripts:!1})).addEvents({success:function(t,e,i,n){var s=Elements.from(i),o=1==s.length?s[0]:new Element("div",{styles:{display:"none"}}).adopt(s);o.inject(this.target,this.options.inject),this.options.requestOptions.evalScripts&&Browser.exec(n),this.fireEvent("beforeEffect",o);s=function(){this.fireEvent("success",[o,this.target,t,e,i,n])}.bind(this);this.options.useReveal?(o.set("reveal",this.options.revealOptions).get("reveal").chain(s),o.reveal()):s()}.bind(this),failure:function(t){this.fireEvent("failure",t)}.bind(this)}),this.attachReset()}}),function(){function n(t){return null!=t}var s=Object.prototype.hasOwnProperty;Object.extend({getFromPath:function(t,e){for(var i=0,n=(e="string"==typeof e?e.split("."):e).length;i<n;i++){if(!s.call(t,e[i]))return null;t=t[e[i]]}return t},cleanValues:function(t,e){for(var i in e=e||n,t)e(t[i])||delete t[i];return t},erase:function(t,e){return s.call(t,e)&&delete t[e],t},run:function(t){var e,i=Array.slice(arguments,1);for(e in t)t[e].apply&&t[e].apply(t,i);return t}})}(),function(){function n(t){return instanceOf(t,a.Set)?t:h[t]}var o=null,h={},a=this.Locale={define:function(t,e,i,n){var s;return instanceOf(t,a.Set)?(s=t.name)&&(h[s]=t):(h[s=t]||(h[s]=new a.Set(s)),t=h[s]),e&&t.define(e,i,n),o=o||t,t},use:function(t){return(t=n(t))&&(o=t,this.fireEvent("change",t)),this},getCurrent:function(){return o},get:function(t,e){return o?o.get(t,e):""},inherit:function(t,e,i){return(t=n(t))&&t.inherit(e,i),this},list:function(){return Object.keys(h)}};Object.append(a,new Events),a.Set=new Class({sets:{},inherits:{locales:[],sets:{}},initialize:function(t){this.name=t||""},define:function(t,e,i){var n=(n=this.sets[t])||{};return e&&("object"==typeOf(e)?n=Object.merge(n,e):n[e]=i),this.sets[t]=n,this},get:function(t,e,i){var n=Object.getFromPath(this.sets,t);if(null!=n){var s=typeOf(n);return"function"==s?n=n.apply(null,Array.convert(e)):"object"==s&&(n=Object.clone(n)),n}var s=t.indexOf("."),s=s<0?t:t.substr(0,s),o=(this.inherits.sets[s]||[]).combine(this.inherits.locales).include("en-US");i=i||[];for(var a=0,r=o.length;a<r;a++)if(!i.contains(o[a])){i.include(o[a]);var l=h[o[a]];if(l&&null!=(n=l.get(t,e,i)))return n}return""},inherit:function(t,e){t=Array.convert(t),e&&!this.inherits.sets[e]&&(this.inherits.sets[e]=[]);for(var i=t.length;i--;)(e?this.inherits.sets[e]:this.inherits.locales).unshift(t[i]);return this}})}(),Locale.define("en-US","Date",{months:["January","February","March","April","May","June","July","August","September","October","November","December"],months_abbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],days_abbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dateOrder:["month","date","year"],shortDate:"%m/%d/%Y",shortTime:"%I:%M%p",AM:"AM",PM:"PM",firstDayOfWeek:0,ordinal:function(t){return 3<t&&t<21?"th":["th","st","nd","rd","th"][Math.min(t%10,4)]},lessThanMinuteAgo:"less than a minute ago",minuteAgo:"about a minute ago",minutesAgo:"{delta} minutes ago",hourAgo:"about an hour ago",hoursAgo:"about {delta} hours ago",dayAgo:"1 day ago",daysAgo:"{delta} days ago",weekAgo:"1 week ago",weeksAgo:"{delta} weeks ago",monthAgo:"1 month ago",monthsAgo:"{delta} months ago",yearAgo:"1 year ago",yearsAgo:"{delta} years ago",lessThanMinuteUntil:"less than a minute from now",minuteUntil:"about a minute from now",minutesUntil:"{delta} minutes from now",hourUntil:"about an hour from now",hoursUntil:"about {delta} hours from now",dayUntil:"1 day from now",daysUntil:"{delta} days from now",weekUntil:"1 week from now",weeksUntil:"{delta} weeks from now",monthUntil:"1 month from now",monthsUntil:"{delta} months from now",yearUntil:"1 year from now",yearsUntil:"{delta} years from now"}),Fx.Move=new Class({Extends:Fx.Morph,options:{relativeTo:document.body,position:"center",edge:!1,offset:{x:0,y:0}},start:function(t){var e=this.element,i=e.getStyles("top","left");return"auto"!=i.top&&"auto"!=i.left||e.setPosition(e.getPosition(e.getOffsetParent())),this.parent(e.position(Object.merge({},this.options,t,{returnPos:!0})))}}),Element.Properties.move={set:function(t){return this.get("move").cancel().setOptions(t),this},get:function(){var t=this.retrieve("move");return t||(t=new Fx.Move(this,{link:"cancel"}),this.store("move",t)),t}},Element.implement({move:function(t){return this.get("move").start(t),this}}),Fx.Scroll=new Class({Extends:Fx,options:{offset:{x:0,y:0},wheelStops:!0},initialize:function(t,e){var i,n;this.element=this.subject=document.id(t),this.parent(e),"element"!=typeOf(this.element)&&(this.element=document.id(this.element.getDocument().body)),this.options.wheelStops&&(i=this.element,n=this.cancel.pass(!1,this),this.addEvent("start",function(){i.addEvent("mousewheel",n)},!0),this.addEvent("complete",function(){i.removeEvent("mousewheel",n)},!0))},set:function(){var t=Array.flatten(arguments);return this.element.scrollTo(t[0],t[1]),this},compute:function(e,i,n){return[0,1].map(function(t){return Fx.compute(e[t],i[t],n)})},start:function(t,e){if(!this.check(t,e))return this;var i=this.element.getScroll();return this.parent([i.x,i.y],[t,e])},calculateScroll:function(t,e){var i,n=this.element,s=n.getScrollSize(),o=n.getScroll(),a=n.getSize(),r=this.options.offset,l={x:t,y:e};for(i in l)l[i]||0===l[i]||(l[i]=o[i]),"number"!=typeOf(l[i])&&(l[i]=s[i]-a[i]),l[i]+=r[i];return[l.x,l.y]},toTop:function(){return this.start.apply(this,this.calculateScroll(!1,0))},toLeft:function(){return this.start.apply(this,this.calculateScroll(0,!1))},toRight:function(){return this.start.apply(this,this.calculateScroll("right",!1))},toBottom:function(){return this.start.apply(this,this.calculateScroll(!1,"bottom"))},toElement:function(t,i){i=i?Array.convert(i):["x","y"];var n=/^(?:body|html)$/i.test(this.element.tagName)?{x:0,y:0}:this.element.getScroll(),t=Object.map(document.id(t).getPosition(this.element),function(t,e){return!!i.contains(e)&&t+n[e]});return this.start.apply(this,this.calculateScroll(t.x,t.y))},toElementEdge:function(t,e,i){e=e?Array.convert(e):["x","y"],t=document.id(t);var n={},s=t.getPosition(this.element),t=t.getSize(),o=this.element.getScroll(),a=this.element.getSize(),r={x:s.x+t.x,y:s.y+t.y};return["x","y"].each(function(t){e.contains(t)&&(r[t]>o[t]+a[t]&&(n[t]=r[t]-a[t]),s[t]<o[t]&&(n[t]=s[t])),null==n[t]&&(n[t]=o[t]),i&&i[t]&&(n[t]=n[t]+i[t])},this),n.x==o.x&&n.y==o.y||this.start(n.x,n.y),this},toElementCenter:function(t,e,i){e=e?Array.convert(e):["x","y"],t=document.id(t);var n={},s=t.getPosition(this.element),o=t.getSize(),a=this.element.getScroll(),r=this.element.getSize();return["x","y"].each(function(t){e.contains(t)&&(n[t]=s[t]-(r[t]-o[t])/2),null==n[t]&&(n[t]=a[t]),i&&i[t]&&(n[t]=n[t]+i[t])},this),n.x==a.x&&n.y==a.y||this.start(n.x,n.y),this}}),Fx.Slide=new Class({Extends:Fx,options:{mode:"vertical",wrapper:!1,hideOverflow:!0,resetHeight:!1},initialize:function(t,e){t=this.element=this.subject=document.id(t),this.parent(e),e=this.options;var i=t.retrieve("wrapper"),n=t.getStyles("margin","position","overflow");e.hideOverflow&&(n=Object.append(n,{overflow:"hidden"})),i=(i=e.wrapper?document.id(e.wrapper).setStyles(n):i)||new Element("div",{styles:n}).wraps(t),t.store("wrapper",i).setStyle("margin",0),"visible"==t.getStyle("overflow")&&t.setStyle("overflow","hidden"),this.now=[],this.open=!0,this.wrapper=i,this.addEvent("complete",function(){this.open=0!=i["offset"+this.layout.capitalize()],this.open&&this.options.resetHeight&&i.setStyle("height","")},!0)},vertical:function(){this.margin="margin-top",this.layout="height",this.offset=this.element.offsetHeight},horizontal:function(){this.margin="margin-left",this.layout="width",this.offset=this.element.offsetWidth},set:function(t){return this.element.setStyle(this.margin,t[0]),this.wrapper.setStyle(this.layout,t[1]),this},compute:function(e,i,n){return[0,1].map(function(t){return Fx.compute(e[t],i[t],n)})},start:function(t,e){if(!this.check(t,e))return this;this[e||this.options.mode]();var i,e=this.element.getStyle(this.margin).toInt(),n=this.wrapper.getStyle(this.layout).toInt(),s=[[e,n],[0,this.offset]],o=[[e,n],[-this.offset,0]];switch(t){case"in":i=s;break;case"out":i=o;break;case"toggle":i=0==n?s:o}return this.parent(i[0],i[1])},slideIn:function(t){return this.start("in",t)},slideOut:function(t){return this.start("out",t)},hide:function(t){return this[t||this.options.mode](),this.open=!1,this.set([-this.offset,0])},show:function(t){return this[t||this.options.mode](),this.open=!0,this.set([0,this.offset])},toggle:function(t){return this.start("toggle",t)}}),Element.Properties.slide={set:function(t){return this.get("slide").cancel().setOptions(t),this},get:function(){var t=this.retrieve("slide");return t||(t=new Fx.Slide(this,{link:"cancel"}),this.store("slide",t)),t}},Element.implement({slide:function(t,e){t=t||"toggle";var i,n=this.get("slide");switch(t){case"hide":n.hide(e);break;case"show":n.show(e);break;case"toggle":var s=this.retrieve("slide:flag",n.open);n[s?"slideOut":"slideIn"](e),this.store("slide:flag",!s),i=!0;break;default:n.start(t,e)}return i||this.eliminate("slide:flag"),this}}),function(){var n=this.Keyboard=new Class({Extends:Events,Implements:[Options],options:{defaultEventType:"keydown",active:!1,manager:null,events:{},nonParsedEvents:["activate","deactivate","onactivate","ondeactivate","changed","onchanged"]},initialize:function(t){t&&t.manager&&(this._manager=t.manager,delete t.manager),this.setOptions(t),this._setup()},addEvent:function(t,e,i){return this.parent(n.parse(t,this.options.defaultEventType,this.options.nonParsedEvents),e,i)},removeEvent:function(t,e){return this.parent(n.parse(t,this.options.defaultEventType,this.options.nonParsedEvents),e)},toggleActive:function(){return this[this.isActive()?"deactivate":"activate"]()},activate:function(t){if(t){if(t.isActive())return this;this._activeKB&&t!=this._activeKB&&(this.previous=this._activeKB,this.previous.fireEvent("deactivate")),this._activeKB=t.fireEvent("activate"),n.manager.fireEvent("changed")}else this._manager&&this._manager.activate(this);return this},isActive:function(){return this._manager?this._manager._activeKB==this:n.manager==this},deactivate:function(t){return t?t===this._activeKB&&(this._activeKB=null,t.fireEvent("deactivate"),n.manager.fireEvent("changed")):this._manager&&this._manager.deactivate(this),this},relinquish:function(){return this.isActive()&&this._manager&&this._manager.previous?this._manager.activate(this._manager.previous):this.deactivate(),this},manage:function(t){return t._manager&&t._manager.drop(t),this._instances.push(t),(t._manager=this)._activeKB||this.activate(t),this},drop:function(t){return t.relinquish(),this._instances.erase(t),this._activeKB==t&&(this.previous&&this._instances.contains(this.previous)?this.activate(this.previous):this._activeKB=this._instances[0]),this},trace:function(){n.trace(this)},each:function(t){n.each(this,t)},_instances:[],_disable:function(t){this._activeKB==t&&(this._activeKB=null)},_setup:function(){this.addEvents(this.options.events),n.manager&&!this._manager&&n.manager.manage(this),this.options.active?this.activate():this.relinquish()},_handle:function(t,e){var i;t.preventKeyboardPropagation||((i=!!this._manager)&&this._activeKB&&(this._activeKB._handle(t,e),t.preventKeyboardPropagation)||(this.fireEvent(e,t),!i&&this._activeKB&&this._activeKB._handle(t,e)))}}),a={},r=["shift","control","alt","meta"],l=/^(?:shift|control|ctrl|alt|meta)$/;n.parse=function(t,i,e){return e&&e.contains(t.toLowerCase())?t:(t=t.toLowerCase().replace(/^(keyup|keydown):/,function(t,e){return i=e,""}),a[t]||("+"!=t?(s={},t.split("+").each(function(t){l.test(t)?s[t]=!0:n=t}),s.control=s.control||s.ctrl,o=[],r.each(function(t){s[t]&&o.push(t)}),n&&o.push(n),a[t]=o.join("+")):a[t]=t),i+":keys("+a[t]+")");var n,s,o},n.each=function(t,e){for(var i=t||n.manager;i;)e(i),i=i._activeKB},n.stop=function(t){t.preventKeyboardPropagation=!0},n.manager=new n({active:!0}),n.trace=function(t){t=t||n.manager;window.console&&console.log;n.each(t,function(t){})};function t(e){var i=[];r.each(function(t){e[t]&&i.push(t)}),l.test(e.key)||i.push(e.key),n.manager._handle(e,e.type+":keys("+i.join("+")+")")}document.addEvents({keyup:t,keydown:t})}(),Keyboard.prototype.options.nonParsedEvents.combine(["rebound","onrebound"]),Keyboard.implement({addShortcut:function(t,e){return this._shortcuts=this._shortcuts||[],this._shortcutIndex=this._shortcutIndex||{},e.getKeyboard=Function.convert(this),e.name=t,this._shortcutIndex[t]=e,this._shortcuts.push(e),e.keys&&this.addEvent(e.keys,e.handler),this},addShortcuts:function(t){for(var e in t)this.addShortcut(e,t[e]);return this},removeShortcut:function(t){var e=this.getShortcut(t);return e&&e.keys&&(this.removeEvent(e.keys,e.handler),delete this._shortcutIndex[t],this._shortcuts.erase(e)),this},removeShortcuts:function(t){return t.each(this.removeShortcut,this),this},getShortcuts:function(){return this._shortcuts||[]},getShortcut:function(t){return(this._shortcutIndex||{})[t]}}),Keyboard.rebind=function(e,t){Array.convert(t).each(function(t){t.getKeyboard().removeEvent(t.keys,t.handler),t.getKeyboard().addEvent(e,t.handler),t.keys=e,t.getKeyboard().fireEvent("rebound")})},Keyboard.getActiveShortcuts=function(t){var e=[],i=[];return Keyboard.each(t,[].push.bind(e)),e.each(function(t){i.extend(t.getShortcuts())}),i},Keyboard.getShortcut=function(e,t,i){var n=(i=i||{}).many?[]:null,i=i.many?function(t){t=t.getShortcut(e);t&&n.push(t)}:function(t){n=n||t.getShortcut(e)};return Keyboard.each(t,i),n},Keyboard.getShortcuts=function(t,e){return Keyboard.getShortcut(t,e,{many:!0})},function(){this.Scroller=new Class({Implements:[Events,Options],options:{area:20,velocity:1,onChange:function(t,e){this.element.scrollTo(t,e)},fps:50},initialize:function(t,e){this.setOptions(e),this.element=document.id(t),this.docBody=document.id(this.element.getDocument().body),this.listener="element"!=typeOf(this.element)?this.docBody:this.element,this.timer=null,this.bound={attach:this.attach.bind(this),detach:this.detach.bind(this),getCoords:this.getCoords.bind(this)}},start:function(){return this.listener.addEvents({mouseover:this.bound.attach,mouseleave:this.bound.detach}),this},stop:function(){return this.listener.removeEvents({mouseover:this.bound.attach,mouseleave:this.bound.detach}),this.detach(),this.timer=clearInterval(this.timer),this},attach:function(){this.listener.addEvent("mousemove",this.bound.getCoords)},detach:function(){this.listener.removeEvent("mousemove",this.bound.getCoords),this.timer=clearInterval(this.timer)},getCoords:function(t){this.page="body"==this.listener.get("tag")?t.client:t.page,this.timer||(this.timer=this.scroll.periodical(Math.round(1e3/this.options.fps),this))},scroll:function(){var t,e=this.element.getSize(),i=this.element.getScroll(),n=this.element!=this.docBody&&this.element!=window?this.element.getOffsets():{x:0,y:0},s=this.element.getScrollSize(),o={x:0,y:0},a=this.options.area.top||this.options.area,r=this.options.area.bottom||this.options.area;for(t in this.page)this.page[t]<a+n[t]&&0!=i[t]?o[t]=(this.page[t]-a-n[t])*this.options.velocity:this.page[t]+r>e[t]+n[t]&&i[t]+e[t]!=s[t]&&(o[t]=(this.page[t]-e[t]+r-n[t])*this.options.velocity),o[t]=o[t].round();(o.y||o.x)&&this.fireEvent("change",[i.x+o.x,i.y+o.y])}})}(),Locale.define("EU","Number",{decimal:",",group:".",currency:{prefix:"€ "}}),function(){var i={json:JSON.decode};Locale.Set.defineParser=function(t,e){i[t]=e},Locale.Set.from=function(t,e){if(instanceOf(t,Locale.Set))return t;e||"string"!=typeOf(t)||(e="json"),i[e]&&(t=i[e](t));e=new Locale.Set;return e.sets=t.sets||{},t.inherits&&(e.inherits.locales=Array.convert(t.inherits.locales),e.inherits.sets=t.inherits.sets||{}),e}}(),Locale.define("de-DE","Date",{months:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],months_abbr:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],days:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],days_abbr:["So","Mo","Di","Mi","Do","Fr","Sa"],dateOrder:["date","month","year"],shortDate:"%d.%m.%Y",shortTime:"%H:%M",AM:"vormittags",PM:"nachmittags",firstDayOfWeek:1,ordinal:".",lessThanMinuteAgo:"vor weniger als einer Minute",minuteAgo:"vor einer Minute",minutesAgo:"vor {delta} Minuten",hourAgo:"vor einer Stunde",hoursAgo:"vor {delta} Stunden",dayAgo:"vor einem Tag",daysAgo:"vor {delta} Tagen",weekAgo:"vor einer Woche",weeksAgo:"vor {delta} Wochen",monthAgo:"vor einem Monat",monthsAgo:"vor {delta} Monaten",yearAgo:"vor einem Jahr",yearsAgo:"vor {delta} Jahren",lessThanMinuteUntil:"in weniger als einer Minute",minuteUntil:"in einer Minute",minutesUntil:"in {delta} Minuten",hourUntil:"in ca. einer Stunde",hoursUntil:"in ca. {delta} Stunden",dayUntil:"in einem Tag",daysUntil:"in {delta} Tagen",weekUntil:"in einer Woche",weeksUntil:"in {delta} Wochen",monthUntil:"in einem Monat",monthsUntil:"in {delta} Monaten",yearUntil:"in einem Jahr",yearsUntil:"in {delta} Jahren"}),Locale.define("de-DE").inherit("EU","Number"),Locale.define("en-GB","Date",{dateOrder:["date","month","year"],shortDate:"%d/%m/%Y",shortTime:"%H:%M"}).inherit("en-US","Date"),Locale.define("en-US","Number",{decimal:".",group:",",currency:{prefix:"$ "}}),Locale.define("nl-NL","Date",{months:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],months_abbr:["jan","feb","mrt","apr","mei","jun","jul","aug","sep","okt","nov","dec"],days:["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"],days_abbr:["zo","ma","di","wo","do","vr","za"],dateOrder:["date","month","year"],shortDate:"%d-%m-%Y",shortTime:"%H:%M",AM:"AM",PM:"PM",firstDayOfWeek:1,ordinal:"e",lessThanMinuteAgo:"minder dan een minuut geleden",minuteAgo:"ongeveer een minuut geleden",minutesAgo:"{delta} minuten geleden",hourAgo:"ongeveer een uur geleden",hoursAgo:"ongeveer {delta} uur geleden",dayAgo:"een dag geleden",daysAgo:"{delta} dagen geleden",weekAgo:"een week geleden",weeksAgo:"{delta} weken geleden",monthAgo:"een maand geleden",monthsAgo:"{delta} maanden geleden",yearAgo:"een jaar geleden",yearsAgo:"{delta} jaar geleden",lessThanMinuteUntil:"over minder dan een minuut",minuteUntil:"over ongeveer een minuut",minutesUntil:"over {delta} minuten",hourUntil:"over ongeveer een uur",hoursUntil:"over {delta} uur",dayUntil:"over ongeveer een dag",daysUntil:"over {delta} dagen",weekUntil:"over een week",weeksUntil:"over {delta} weken",monthUntil:"over een maand",monthsUntil:"over {delta} maanden",yearUntil:"over een jaar",yearsUntil:"over {delta} jaar"}),Locale.define("nl-NL").inherit("EU","Number"),Request.JSONP=new Class({Implements:[Chain,Events,Options],options:{onRequest:function(t){this.options.log&&window.console&&console.log},onError:function(t){this.options.log&&window.console&&console.warn},url:"",callbackKey:"callback",injectScript:document.head,data:"",link:"ignore",timeout:0,log:!1},initialize:function(t){this.setOptions(t)},send:function(t){if(!Request.prototype.check.call(this,t))return this;this.running=!0;var e=typeOf(t);"string"!=e&&"element"!=e||(t={data:t});var i=(t=Object.merge(this.options,t||{})).data;switch(typeOf(i)){case"element":i=document.id(i).toQueryString();break;case"object":case"hash":i=Object.toQueryString(i)}var n=this.index=Request.JSONP.counter++,s="request_"+n,o=t.url+(t.url.test("\\?")?"&":"?")+t.callbackKey+"=Request.JSONP.request_map.request_"+n+(i?"&"+i:"");2083<o.length&&this.fireEvent("error",o),Request.JSONP.request_map[s]=function(){delete Request.JSONP.request_map[s],this.success(arguments,n)}.bind(this);e=this.getScript(o).inject(t.injectScript);return this.fireEvent("request",[o,e]),t.timeout&&this.timeout.delay(t.timeout,this),this},getScript:function(t){return this.script||(this.script=new Element("script",{type:"text/javascript",async:!0,src:t})),this.script},success:function(t){this.running&&this.clear().fireEvent("complete",t).fireEvent("success",t).callChain()},cancel:function(){return this.running&&this.clear().fireEvent("cancel"),this},isRunning:function(){return!!this.running},clear:function(){return this.running=!1,this.script&&(this.script.destroy(),this.script=null),this},timeout:function(){return this.running&&(this.running=!1,this.fireEvent("timeout",[this.script.get("src"),this.script]).fireEvent("failure").cancel()),this}}),Request.JSONP.counter=0,Request.JSONP.request_map={},Request.implement({options:{initialDelay:5e3,delay:5e3,limit:6e4},startTimer:function(t){function e(){this.running||this.send({data:t})}return this.lastDelay=this.options.initialDelay,this.timer=e.delay(this.lastDelay,this),this.completeCheck=function(t){clearTimeout(this.timer),this.lastDelay=t?this.options.delay:(this.lastDelay+this.options.delay).min(this.options.limit),this.timer=e.delay(this.lastDelay,this)},this.addEvent("complete",this.completeCheck)},stopTimer:function(){return clearTimeout(this.timer),this.removeEvent("complete",this.completeCheck)}}),Array.implement({min:function(){return Math.min.apply(null,this)},max:function(){return Math.max.apply(null,this)},average:function(){return this.length?this.sum()/this.length:0},sum:function(){var t=0,e=this.length;if(e)for(;e--;)null!=this[e]&&(t+=parseFloat(this[e]));return t},unique:function(){return[].combine(this)},shuffle:function(){for(var t=this.length;t&&--t;){var e=this[t],i=Math.floor(Math.random()*(t+1));this[t]=this[i],this[i]=e}return this},reduce:function(t,e){for(var i=0,n=this.length;i<n;i++)i in this&&(e=void 0===e?this[i]:t.call(null,e,this[i],i,this));return e},reduceRight:function(t,e){for(var i=this.length;i--;)i in this&&(e=void 0===e?this[i]:t.call(null,e,this[i],i,this));return e},pluck:function(e){return this.map(function(t){return t[e]})}}),function(){var i;this.Hash||(i=this.Hash=new Type("Hash",function(t){for(var e in t="hash"==typeOf(t)?Object.clone(t.getClean()):t)this[e]=t[e];return this}),this.$H=function(t){return new i(t)},i.implement({forEach:function(t,e){Object.forEach(this,t,e)},getClean:function(){var t,e={};for(t in this)this.hasOwnProperty(t)&&(e[t]=this[t]);return e},getLength:function(){var t,e=0;for(t in this)this.hasOwnProperty(t)&&e++;return e}}),i.alias("each","forEach"),i.implement({has:Object.prototype.hasOwnProperty,keyOf:function(t){return Object.keyOf(this,t)},hasValue:function(t){return Object.contains(this,t)},extend:function(t){return i.each(t||{},function(t,e){i.set(this,e,t)},this),this},combine:function(t){return i.each(t||{},function(t,e){i.include(this,e,t)},this),this},erase:function(t){return this.hasOwnProperty(t)&&delete this[t],this},get:function(t){return this.hasOwnProperty(t)?this[t]:null},set:function(t,e){return this[t]&&!this.hasOwnProperty(t)||(this[t]=e),this},empty:function(){return i.each(this,function(t,e){delete this[e]},this),this},include:function(t,e){return null==this[t]&&(this[t]=e),this},map:function(t,e){return new i(Object.map(this,t,e))},filter:function(t,e){return new i(Object.filter(this,t,e))},every:function(t,e){return Object.every(this,t,e)},some:function(t,e){return Object.some(this,t,e)},getKeys:function(){return Object.keys(this)},getValues:function(){return Object.values(this)},toQueryString:function(t){return Object.toQueryString(this,t)}}),i.alias({indexOf:"keyOf",contains:"hasValue"}))}(),Hash.implement({getFromPath:function(t){return Object.getFromPath(this,t)},cleanValues:function(t){return new Hash(Object.cleanValues(this,t))},run:function(){Object.run(arguments)}}),Number.implement({format:function(e){var t=this;e=e?Object.clone(e):{};function i(t){return null!=e[t]?e[t]:Locale.get("Number."+t)}var n,s=t<0,o=i("decimal"),a=i("precision"),r=i("group"),l=i("decimals");s&&(null==(n=i("negative")||{}).prefix&&null==n.suffix&&(n.prefix="-"),["prefix","suffix"].each(function(t){n[t]&&(e[t]=i(t)+n[t])}),t=-t);var h=i("prefix"),s=i("suffix");if(""!==l&&0<=l&&l<=20&&(t=t.toFixed(l)),1<=a&&a<=21&&(t=(+t).toPrecision(a)),t+="",!1===i("scientific")&&-1<t.indexOf("e")){var a=t.split("e"),c=+a[1],t=a[0].replace(".","");if(c<0){for(c=-c-1,-1<(u=a[0].indexOf("."))&&(c-=u-1);c--;)t="0"+t;t="0."+t}else for(-1<(u=a[0].lastIndexOf("."))&&(c-=a[0].length-u-1);c--;)t+="0"}if("."!=o&&(t=t.replace(".",o)),r){for(var u=-1<(u=t.lastIndexOf(o))?u:t.length,d=t.substring(u),p=u;p--;)(u-p-1)%3==0&&p!=u-1&&(d=r+d),d=t.charAt(p)+d;t=d}return h&&(t=h+t),s&&(t+=s),t},formatCurrency:function(t){var e=Locale.get("Number.currency")||{};return null==e.scientific&&(e.scientific=!1),e.decimals=null!=t?t:null==e.decimals?2:e.decimals,this.format(e)},formatPercentage:function(t){var e=Locale.get("Number.percentage")||{};return null==e.suffix&&(e.suffix="%"),e.decimals=null!=t?t:null==e.decimals?2:e.decimals,this.format(e)}}),function(){function t(){return this.get("value")}var s=this.URI=new Class({Implements:Options,options:{},regex:/^(?:(\w+):)?(?:\/\/(?:(?:([^:@\/]*):?([^:@\/]*))?@)?(\[[A-Fa-f0-9:]+\]|[^:\/?#]*)(?::(\d*))?)?(\.\.?$|(?:[^?#\/]*\/)*)([^?#]*)(?:\?([^#]*))?(?:#(.*))?/,parts:["scheme","user","password","host","port","directory","file","query","fragment"],schemes:{http:80,https:443,ftp:21,rtsp:554,mms:1755,file:0},initialize:function(t,e){this.setOptions(e);e=this.options.base||s.base;(t=t||e)&&t.parsed?this.parsed=Object.clone(t.parsed):this.set("value",t.href||t.toString(),!!e&&new s(e))},parse:function(t,e){t=t.match(this.regex);return!!t&&(t.shift(),this.merge(t.associate(this.parts),e))},merge:function(e,i){return!!(e&&e.scheme||i&&i.scheme)&&(i&&this.parts.every(function(t){return!e[t]&&(e[t]=i[t]||"",!0)}),e.port=e.port||this.schemes[e.scheme.toLowerCase()],e.directory=e.directory?this.parseDirectory(e.directory,i?i.directory:""):"/",e)},parseDirectory:function(t,e){if(!(t=("/"==t.substr(0,1)?"":e||"/")+t).test(s.regs.directoryDot))return t;var i=[];return t.replace(s.regs.endSlash,"").split("/").each(function(t){".."==t&&0<i.length?i.pop():"."!=t&&i.push(t)}),i.join("/")+"/"},combine:function(t){return t.value||t.scheme+"://"+(t.user?t.user+(t.password?":"+t.password:"")+"@":"")+(t.host||"")+(t.port&&t.port!=this.schemes[t.scheme]?":"+t.port:"")+(t.directory||"/")+(t.file||"")+(t.query?"?"+t.query:"")+(t.fragment?"#"+t.fragment:"")},set:function(t,e,i){var n;return"value"==t?(n=(n=e.match(s.regs.scheme))&&n[1])&&null==this.schemes[n.toLowerCase()]?this.parsed={scheme:n,value:e}:this.parsed=this.parse(e,(i||this).parsed)||(n?{scheme:n,value:e}:{value:e}):"data"==t?this.setData(e):this.parsed[t]=e,this},get:function(t,e){switch(t){case"value":return this.combine(this.parsed,!!e&&e.parsed);case"data":return this.getData()}return this.parsed[t]||""},go:function(){document.location.href=this.toString()},toURI:function(){return this},getData:function(t,e){e=this.get(e||"query");if(!e&&0!==e)return t?null:{};e=e.parseQueryString();return t?e[t]:e},setData:function(t,e,i){var n;return"string"==typeof t?((n=this.getData())[arguments[0]]=e,t=n):e&&(t=Object.merge(this.getData(null,i),t)),this.set(i||"query",Object.toQueryString(t))},clearData:function(t){return this.set(t||"query","")},toString:t,valueOf:t});s.regs={endSlash:/\/$/,scheme:/^(\w+):/,directoryDot:/\.\/|\.$/},s.base=new s(Array.convert(document.getElements("base[href]",!0)).getLast(),{base:document.location}),String.implement({toURI:function(t){return new s(this,t)}})}(),URI=Class.refactor(URI,{combine:function(t,e){if(!e||t.scheme!=e.scheme||t.host!=e.host||t.port!=e.port)return this.previous.apply(this,arguments);var i=t.file+(t.query?"?"+t.query:"")+(t.fragment?"#"+t.fragment:"");if(!e.directory)return(t.directory||(t.file?"":"./"))+i;for(var n=e.directory.split("/"),s=t.directory.split("/"),o="",a=0,r=0;r<n.length&&r<s.length&&n[r]==s[r];r++);for(a=0;a<n.length-r-1;a++)o+="../";for(a=r;a<s.length-1;a++)o+=s[a]+"/";return(o||(t.file?"":"./"))+i},toAbsolute:function(t){return(t=new URI(t))&&t.set("directory","").set("file",""),this.toRelative(t)},toRelative:function(t){return this.get("value",new URI(t))}}),function(){var o=this.Asset={javascript:function(t,e){e=e||{};var i=new Element("script",{src:t,type:"text/javascript"}),t=e.document||document,n=e.onload||e.onLoad;return delete e.onload,delete e.onLoad,delete e.document,n&&(i.addEventListener?i.addEvent("load",n):i.addEvent("readystatechange",function(){["loaded","complete"].contains(this.readyState)&&n.call(this)})),i.set(e).inject(t.head)},css:function(t,e){var n=(e=e||{}).onload||e.onLoad,i=e.document||document,s=e.timeout||3e3;["onload","onLoad","document"].each(function(t){delete e[t]});var o,a,r,l=new Element("link",{type:"text/css",rel:"stylesheet",media:"screen",href:t}).setProperties(e).inject(i.head);return n&&(o=!1,a=0,r=function(){for(var t=document.styleSheets,e=0;e<t.length;e++){var i=t[e],i=i.ownerNode||i.owningElement;if(i&&i==l)return o=!0,n.call(l)}if(a++,!o&&a<s/50)return setTimeout(r,50)},setTimeout(r,0)),l},image:function(t,s){s=s||{};var o=new Image,a=document.id(o)||new Element("img");return["load","abort","error"].each(function(t){var e="on"+t,i="on"+t.capitalize(),n=s[e]||s[i]||function(){};delete s[i],delete s[e],o[e]=function(){o&&(a.parentNode||(a.width=o.width,a.height=o.height),o=o.onload=o.onabort=o.onerror=null,n.delay(1,a,a),a.fireEvent(t,a,1))}}),o.src=a.src=t,o&&o.complete&&o.onload.delay(1),a.set(s)},images:function(i,n){i=Array.convert(i);function t(){}var s=0;return n=Object.merge({onComplete:t,onProgress:t,onError:t,properties:{}},n),new Elements(i.map(function(t,e){return o.image(t,Object.append(n.properties,{onload:function(){s++,n.onProgress.call(this,s,e,t),s==i.length&&n.onComplete()},onerror:function(){s++,n.onError.call(this,s,e,t),s==i.length&&n.onComplete()}}))}))}}}(),function(){var s=this.Color=new Type("Color",function(t,e){switch(3<=arguments.length?(e="rgb",t=Array.slice(arguments,0,3)):"string"==typeof t&&(t=t.match(/rgb/)?t.rgbToHex().hexToRgb(!0):t.match(/hsb/)?t.hsbToRgb():t.hexToRgb(!0)),e=e||"rgb"){case"hsb":var i=t;(t=t.hsbToRgb()).hsb=i;break;case"hex":t=t.hexToRgb(!0)}return t.rgb=t.slice(0,3),t.hsb=t.hsb||t.rgbToHsb(),t.hex=t.rgbToHex(),Object.append(t,this)});s.implement({mix:function(){var t=Array.slice(arguments),i="number"==typeOf(t.getLast())?t.pop():50,n=this.slice();return t.each(function(t){t=new s(t);for(var e=0;e<3;e++)n[e]=Math.round(n[e]/100*(100-i)+t[e]/100*i)}),new s(n,"rgb")},invert:function(){return new s(this.map(function(t){return 255-t}))},setHue:function(t){return new s([t,this.hsb[1],this.hsb[2]],"hsb")},setSaturation:function(t){return new s([this.hsb[0],t,this.hsb[2]],"hsb")},setBrightness:function(t){return new s([this.hsb[0],this.hsb[1],t],"hsb")}}),this.$RGB=function(t,e,i){return new s([t,e,i],"rgb")},this.$HSB=function(t,e,i){return new s([t,e,i],"hsb")},this.$HEX=function(t){return new s(t,"hex")},Array.implement({rgbToHsb:function(){var t,e,i=this[0],n=this[1],s=this[2],o=0,a=Math.max(i,n,s),r=a-Math.min(i,n,s),l=a/255,h=0!=a?r/a:0;return 0!=h&&(t=(a-i)/r,e=(a-n)/r,r=(a-s)/r,o=i==a?r-e:n==a?2+t-r:4+e-t,(o/=6)<0&&o++),[Math.round(360*o),Math.round(100*h),Math.round(100*l)]},hsbToRgb:function(){var t=Math.round(this[2]/100*255);if(0==this[1])return[t,t,t];var e=this[0]%360,i=e%60,n=Math.round(this[2]*(100-this[1])/1e4*255),s=Math.round(this[2]*(6e3-this[1]*i)/6e5*255),o=Math.round(this[2]*(6e3-this[1]*(60-i))/6e5*255);switch(Math.floor(e/60)){case 0:return[t,o,n];case 1:return[s,t,n];case 2:return[n,t,o];case 3:return[n,s,t];case 4:return[o,n,t];case 5:return[t,n,s]}return!1}}),String.implement({rgbToHsb:function(){var t=this.match(/\d{1,3}/g);return t?t.rgbToHsb():null},hsbToRgb:function(){var t=this.match(/\d{1,3}/g);return t?t.hsbToRgb():null}})}(),function(){this.Group=new Class({initialize:function(){this.instances=Array.flatten(arguments)},addEvent:function(i,n){var s=this.instances,o=s.length,a=o,r=new Array(o),l=this;s.each(function(t,e){t.addEvent(i,function(){r[e]||a--,r[e]=arguments,a||(n.call(l,s,t,r),a=o,r=new Array(o))})})}})}(),Hash.Cookie=new Class({Extends:Cookie,options:{autoSave:!0},initialize:function(t,e){this.parent(t,e),this.load()},save:function(){var t=JSON.encode(this.hash);return!(!t||4096<t.length)&&("{}"==t?this.dispose():this.write(t),!0)},load:function(){return this.hash=new Hash(JSON.decode(this.read(),!0)),this}}),Hash.each(Hash.prototype,function(e,t){"function"==typeof e&&Hash.Cookie.implement(t,function(){var t=e.apply(this.hash,arguments);return this.options.autoSave&&this.save(),t})}),function(){var a=this.Date,i=a.Methods={ms:"Milliseconds",year:"FullYear",min:"Minutes",mo:"Month",sec:"Seconds",hr:"Hours"};["Date","Day","FullYear","Hours","Milliseconds","Minutes","Month","Seconds","Time","TimezoneOffset","Week","Timezone","GMTOffset","DayOfYear","LastMonth","LastDayOfMonth","UTCDate","UTCDay","UTCFullYear","AMPM","Ordinal","UTCHours","UTCMilliseconds","UTCMinutes","UTCMonth","UTCSeconds","UTCMilliseconds"].each(function(t){a.Methods[t.toLowerCase()]=t});var n=function(t,e,i){return 1!=e&&t<Math.pow(10,e-1)?(i||"0")+n(t,e-1,i):t};a.implement({set:function(t,e){t=t.toLowerCase();t=i[t]&&"set"+i[t];return t&&this[t]&&this[t](e),this}.overloadSetter(),get:function(t){t=t.toLowerCase();t=i[t]&&"get"+i[t];return t&&this[t]?this[t]():null}.overloadGetter(),clone:function(){return new a(this.get("time"))},increment:function(t,e){switch(e=null!=e?e:1,t=t||"day"){case"year":return this.increment("month",12*e);case"month":var i=this.get("date");return this.set("date",1).set("mo",this.get("mo")+e),this.set("date",i.min(this.get("lastdayofmonth")));case"week":return this.increment("day",7*e);case"day":return this.set("date",this.get("date")+e)}if(!a.units[t])throw new Error(t+" is not a supported interval");return this.set("time",this.get("time")+e*a.units[t]())},decrement:function(t,e){return this.increment(t,-1*(null!=e?e:1))},isLeapYear:function(){return a.isLeapYear(this.get("year"))},clearTime:function(){return this.set({hr:0,min:0,sec:0,ms:0})},diff:function(t,e){return(((t="string"==typeOf(t)?a.parse(t):t)-this)/a.units[e||"day"](3,3)).round()},getLastDayOfMonth:function(){return a.daysInMonth(this.get("mo"),this.get("year"))},getDayOfYear:function(){return(a.UTC(this.get("year"),this.get("mo"),this.get("date")+1)-a.UTC(this.get("year"),0,1))/a.units.day()},setDay:function(t,e){null==e&&""===(e=a.getMsg("firstDayOfWeek"))&&(e=1),t=(7+a.parseDay(t,!0)-e)%7;e=(7+this.get("day")-e)%7;return this.increment("day",t-e)},getWeek:function(t){null==t&&""===(t=a.getMsg("firstDayOfWeek"))&&(t=1);var e=this,i=(7+e.get("day")-t)%7,n=0;if(1==t){var s=e.get("month"),o=e.get("date")-i;if(11==s&&28<o)return 1;0==s&&o<-2&&(e=new a(e).decrement("day",i),i=0),4<(o=new a(e.get("year"),0,1).get("day")||7)&&(n=-7)}else o=new a(e.get("year"),0,1).get("day");return n+=e.get("dayofyear"),n+=6-i,(n+=(7+o-t)%7)/7},getOrdinal:function(t){return a.getMsg("ordinal",t||this.get("date"))},getTimezone:function(){return this.toString().replace(/^.*? ([A-Z]{3}).[0-9]{4}.*$/,"$1").replace(/^.*?\(([A-Z])[a-z]+ ([A-Z])[a-z]+ ([A-Z])[a-z]+\)$/,"$1$2$3")},getGMTOffset:function(){var t=this.get("timezoneOffset");return(0<t?"-":"+")+n((t.abs()/60).floor(),2)+n(t%60,2)},setAMPM:function(t){t=t.toUpperCase();var e=this.get("hr");return 11<e&&"AM"==t?this.decrement("hour",12):e<12&&"PM"==t?this.increment("hour",12):this},getAMPM:function(){return this.get("hr")<12?"AM":"PM"},parse:function(t){return this.set("time",a.parse(t)),this},isValid:function(t){return t=t||this,"date"==typeOf(t)&&!isNaN(t.valueOf())},format:function(t){if(!this.isValid())return"invalid date";if("function"==typeof(t="string"==typeof(t=t||"%x %X")?r[t.toLowerCase()]||t:t))return t(this);var i=this;return t.replace(/%([a-z%])/gi,function(t,e){switch(e){case"a":return a.getMsg("days_abbr")[i.get("day")];case"A":return a.getMsg("days")[i.get("day")];case"b":return a.getMsg("months_abbr")[i.get("month")];case"B":return a.getMsg("months")[i.get("month")];case"c":return i.format("%a %b %d %H:%M:%S %Y");case"d":return n(i.get("date"),2);case"e":return n(i.get("date"),2," ");case"H":return n(i.get("hr"),2);case"I":return n(i.get("hr")%12||12,2);case"j":return n(i.get("dayofyear"),3);case"k":return n(i.get("hr"),2," ");case"l":return n(i.get("hr")%12||12,2," ");case"L":return n(i.get("ms"),3);case"m":return n(i.get("mo")+1,2);case"M":return n(i.get("min"),2);case"o":return i.get("ordinal");case"p":return a.getMsg(i.get("ampm"));case"s":return Math.round(i/1e3);case"S":return n(i.get("seconds"),2);case"T":return i.format("%H:%M:%S");case"U":return n(i.get("week"),2);case"w":return i.get("day");case"x":return i.format(a.getMsg("shortDate"));case"X":return i.format(a.getMsg("shortTime"));case"y":return i.get("year").toString().substr(2);case"Y":return i.get("year");case"z":return i.get("GMTOffset");case"Z":return i.get("Timezone")}return e})},toISOString:function(){return this.format("iso8601")}}).alias({toJSON:"toISOString",compare:"diff",strftime:"format"});function s(t,e,i){var n=-1,s=a.getMsg(t);switch(typeOf(e)){case"object":n=s[e.get(t)];break;case"number":if(!(n=s[e]))throw new Error("Invalid "+t+" index: "+e);break;case"string":var o=e.escapeRegExp(),o=s.filter(function(t){return this.test(t)},new RegExp("^"+o,"i"));if(!o.length)throw new Error("Invalid "+t+" string");if(1<o.length)throw new Error("Ambiguous "+t);n=o[0]}return i?s.indexOf(n):n}var e=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],o=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],r={db:"%Y-%m-%d %H:%M:%S",compact:"%Y%m%dT%H%M%S",short:"%d %b %H:%M",long:"%B %d, %Y %H:%M",rfc822:function(t){return e[t.get("day")]+t.format(", %d ")+o[t.get("month")]+t.format(" %Y %H:%M:%S %Z")},rfc2822:function(t){return e[t.get("day")]+t.format(", %d ")+o[t.get("month")]+t.format(" %Y %H:%M:%S %z")},iso8601:function(t){return t.getUTCFullYear()+"-"+n(t.getUTCMonth()+1,2)+"-"+n(t.getUTCDate(),2)+"T"+n(t.getUTCHours(),2)+":"+n(t.getUTCMinutes(),2)+":"+n(t.getUTCSeconds(),2)+"."+n(t.getUTCMilliseconds(),3)+"Z"}},l=[],h=a.parse,c=1900,u=70;a.extend({getMsg:function(t,e){return Locale.get("Date."+t,e)},units:{ms:Function.convert(1),second:Function.convert(1e3),minute:Function.convert(6e4),hour:Function.convert(36e5),day:Function.convert(864e5),week:Function.convert(6084e5),month:function(t,e){var i=new a;return 864e5*a.daysInMonth(null!=t?t:i.get("mo"),null!=e?e:i.get("year"))},year:function(t){return t=t||(new a).get("year"),a.isLeapYear(t)?316224e5:31536e6}},daysInMonth:function(t,e){return[31,a.isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},isLeapYear:function(t){return t%4==0&&t%100!=0||t%400==0},parse:function(i){var n,t=typeOf(i);return"number"==t?new a(i):"string"!=t?i:(i=i.clean()).length?(l.some(function(t){var e=t.re.exec(i);return!!e&&(n=t.handler(e))}),n=n&&n.isValid()||(n=new a(h(i)))&&n.isValid()?n:new a(i.toInt())):null},parseDay:function(t,e){return s("days",t,e)},parseMonth:function(t,e){try{return s("months",t,e)}catch(t){}return s("months_abbr",t,e)},parseUTC:function(t){t=new a(t),t=a.UTC(t.get("year"),t.get("mo"),t.get("date"),t.get("hr"),t.get("min"),t.get("sec"),t.get("ms"));return new a(t)},orderIndex:function(t){return a.getMsg("dateOrder").indexOf(t)+1},defineFormat:function(t,e){return r[t]=e,this},defineParser:function(t){return l.push(t.re&&t.handler?t:g(t)),this},defineParsers:function(){return Array.flatten(arguments).each(a.defineParser),this},define2DigitYearStart:function(t){return c=t-(u=t%100),this}}).extend({defineFormats:a.defineFormat.overloadSetter()});var d,p=function(t){return new RegExp("(?:"+a.getMsg(t).map(function(t){return t.substr(0,3)+"\\.?"}).join("|")+")[a-z]*")},m=function(t){switch(t){case"T":return"%H:%M:%S";case"x":return(1==a.orderIndex("month")?"%m[-./]%d":"%d[-./]%m")+"([-./]%y)?";case"X":return"%H([.:]%M)?([.:]%S([.:]%s)?)? ?%p? ?%z?"}return null},f={d:/[0-2]?[0-9]|3[01]/,H:/[01]?[0-9]|2[0-3]/,I:/0?[1-9]|1[0-2]/,M:/[0-5]?\d/,s:/\d+/,o:/[a-z]*/,p:/[ap]\.?m\.?/,y:/\d{2}|\d{4}/,Y:/\d{4}/,z:/Z|[+-]\d{2}(?::?\d{2})?/};f.m=f.I,f.S=f.M;var g=function(t){if(!d)return{format:t};var s=[],e=(t.source||t).replace(/%([a-z])/gi,function(t,e){return m(e)||t}).replace(/\((?!\?)/g,"(?:").replace(/ (?!\?|\*)/g,",? ").replace(/%([a-z%])/gi,function(t,e){var i=f[e];return i?(s.push(e),"("+i.source+")"):e}).replace(/\[a-z\]/gi,"[a-z\\u00c0-\\uffff;&]");return{format:t,re:new RegExp("^"+e+"$","i"),handler:function(t){t=t.slice(1).associate(s);var e,i=(new a).clearTime(),n=t.y||t.Y;for(e in null!=n&&v.call(i,"y",n),"d"in t&&v.call(i,"d",1),("m"in t||t.b||t.B)&&v.call(i,"m",1),t)v.call(i,e,t[e]);return i}}},v=function(t,e){if(!e)return this;switch(t){case"a":case"A":return this.set("day",a.parseDay(e,!0));case"b":case"B":return this.set("mo",a.parseMonth(e,!0));case"d":return this.set("date",e);case"H":case"I":return this.set("hr",e);case"m":return this.set("mo",e-1);case"M":return this.set("min",e);case"p":return this.set("ampm",e.replace(/\./g,""));case"S":return this.set("sec",e);case"s":return this.set("ms",1e3*("0."+e));case"w":return this.set("day",e);case"Y":return this.set("year",e);case"y":return(e=+e)<100&&(e+=c+(e<u?100:0)),this.set("year",e);case"z":var i=((i=(e="Z"==e?"+00":e).match(/([+-])(\d{2}):?(\d{2})?/))[1]+"1")*(60*i[2]+(+i[3]||0))+this.getTimezoneOffset();return this.set("time",this-6e4*i)}return this};a.defineParsers("%Y([-./]%m([-./]%d((T| )%X)?)?)?","%Y%m%d(T%H(%M%S?)?)?","%x( %X)?","%d%o( %b( %Y)?)?( %X)?","%b( %d%o)?( %Y)?( %X)?","%Y %b( %d%o( %X)?)?","%o %b %d %X %z %Y","%T","%H:%M( ?%p)?"),Locale.addEvent("change",function(t){Locale.get("Date")&&(d=t,f.a=f.A=p("days"),f.b=p("months_abbr"),f.B=p("months"),l.each(function(t,e){t.format&&(l[e]=g(t.format))}))}).fireEvent("change",Locale.getCurrent())}(),Date.implement({timeDiffInWords:function(t){return Date.distanceOfTimeInWords(this,t||new Date)},timeDiff:function(t,e){for(var i,n,s=(((t=null==t?new Date:t)-this)/1e3).floor().abs(),o=[],a=[60,60,24,365,0],r=["s","m","h","d","y"],l=0;l<a.length&&(!l||s);l++)i=s,(n=a[l])&&(i=s%n,s=(s/n).floor()),o.unshift(i+(r[l]||""));return o.join(e||":")}}).extend({distanceOfTimeInWords:function(t,e){return Date.getTimePhrase(((e-t)/1e3).toInt())},getTimePhrase:function(t){var e=t<0?"Until":"Ago";t<0&&(t*=-1);var i,n={minute:60,hour:60,day:24,week:7,month:52/12,year:12,eon:1/0},s="lessThanMinute";for(i in n){var o=n[i];if(t<1.5*o){.75*o<t&&(s=i);break}t/=o,s=i+"s"}return t=t.round(),Date.getMsg(s+e,t).substitute({delta:t})}}).defineParsers({re:/^(?:tod|tom|yes)/i,handler:function(t){var e=(new Date).clearTime();switch(t[0]){case"tom":return e.increment();case"yes":return e.decrement();default:return e}}},{re:/^(next|last) ([a-z]+)$/i,handler:function(t){var e=(new Date).clearTime(),i=e.getDay(),n=Date.parseDay(t[2],!0),s=n-i;return n<=i&&(s+=7),"last"==t[1]&&(s-=7),e.set("date",e.getDate()+s)}}).alias("timeAgoInWords","timeDiffInWords"),function(){"use strict";var l=Object.prototype.hasOwnProperty;var t=function(){try{return!!Object.defineProperty({},"a",{})}catch(t){return!1}}(),r=(t||Object.prototype.__defineGetter__,t?Object.defineProperty:function(t,e,i){"get"in i&&t.__defineGetter__?t.__defineGetter__(e,i.get):(!l.call(t,e)||"value"in i)&&(t[e]=i.value)}),o=Object.create||function(t,e){var i,n;function s(){}for(n in s.prototype=t,i=new s,e)l.call(e,n)&&r(i,n,e[n]);return i},s=e;function e(t,e,i){this.locales=t,this.formats=e,this.pluralFn=i}function a(t){this.id=t}function h(t,e,i,n,s){this.id=t,this.useOrdinal=e,this.offset=i,this.options=n,this.pluralFn=s}function i(t,e,i,n){this.id=t,this.offset=e,this.numberFormat=i,this.string=n}function c(t,e){this.id=t,this.options=e}e.prototype.compile=function(t){return this.pluralStack=[],this.currentPlural=null,this.pluralNumberFormat=null,this.compileMessage(t)},e.prototype.compileMessage=function(t){if(!t||"messageFormatPattern"!==t.type)throw new Error('Message AST is not of type: "messageFormatPattern"');for(var e,i=t.elements,n=[],s=0,o=i.length;s<o;s+=1)switch((e=i[s]).type){case"messageTextElement":n.push(this.compileMessageText(e));break;case"argumentElement":n.push(this.compileArgument(e));break;default:throw new Error("Message element does not have a valid type")}return n},e.prototype.compileMessageText=function(t){return this.currentPlural&&/(^|[^\\])#/g.test(t.value)?(this.pluralNumberFormat||(this.pluralNumberFormat=new Intl.NumberFormat(this.locales)),new i(this.currentPlural.id,this.currentPlural.format.offset,this.pluralNumberFormat,t.value)):t.value.replace(/\\#/g,"#")},e.prototype.compileArgument=function(t){var e=t.format;if(!e)return new a(t.id);var i,n=this.formats,s=this.locales,o=this.pluralFn;switch(e.type){case"numberFormat":return i=n.number[e.style],{id:t.id,format:new Intl.NumberFormat(s,i).format};case"dateFormat":return i=n.date[e.style],{id:t.id,format:new Intl.DateTimeFormat(s,i).format};case"timeFormat":return i=n.time[e.style],{id:t.id,format:new Intl.DateTimeFormat(s,i).format};case"pluralFormat":return i=this.compileOptions(t),new h(t.id,e.ordinal,e.offset,i,o);case"selectFormat":return i=this.compileOptions(t),new c(t.id,i);default:throw new Error("Message element does not have a valid format type")}},e.prototype.compileOptions=function(t){var e,i,n,s=t.format,o=s.options,a={};for(this.pluralStack.push(this.currentPlural),this.currentPlural="pluralFormat"===s.type?t:null,e=0,i=o.length;e<i;e+=1)a[(n=o[e]).selector]=this.compileMessage(n.value);return this.currentPlural=this.pluralStack.pop(),a},a.prototype.format=function(t){return t||"number"==typeof t?"string"==typeof t?t:String(t):""},h.prototype.getOption=function(t){var e=this.options;return e["="+t]||e[this.pluralFn(t-this.offset,this.useOrdinal)]||e.other},i.prototype.format=function(t){t=this.numberFormat.format(t-this.offset);return this.string.replace(/(^|[^\\])#/g,"$1"+t).replace(/\\#/g,"#")},c.prototype.getOption=function(t){var e=this.options;return e[t]||e.other};var n,t=(n=Rt,d=Error,u.prototype=d.prototype,n.prototype=new u,{SyntaxError:Rt,parse:function(l){var t=1<arguments.length?arguments[1]:{},h={},e={start:$t},i=$t,n=function(t){return{type:"messageFormatPattern",elements:t,location:St()}},a=function(t){for(var e,i,n,s="",o=0,a=t.length;o<a;o+=1)for(e=0,n=(i=t[o]).length;e<n;e+=1)s+=i[e];return s},s=function(t){return{type:"messageTextElement",value:t,location:St()}},r=/^[^ \t\n\r,.+={}#]/,c={type:"class",value:"[^ \\t\\n\\r,.+={}#]",description:"[^ \\t\\n\\r,.+={}#]"},u="{",d={type:"literal",value:"{",description:'"{"'},p=",",m={type:"literal",value:",",description:'","'},f="}",g={type:"literal",value:"}",description:'"}"'},v=function(t,e){return{type:"argumentElement",id:t,format:e&&e[2],location:St()}},y="number",b={type:"literal",value:"number",description:'"number"'},w="date",_={type:"literal",value:"date",description:'"date"'},E="time",S={type:"literal",value:"time",description:'"time"'},x=function(t,e){return{type:t+"Format",style:e&&e[2],location:St()}},k="plural",C={type:"literal",value:"plural",description:'"plural"'},O=function(t){return{type:t.type,ordinal:!1,offset:t.offset||0,options:t.options,location:St()}},$="selectordinal",I={type:"literal",value:"selectordinal",description:'"selectordinal"'},T=function(t){return{type:t.type,ordinal:!0,offset:t.offset||0,options:t.options,location:St()}},L="select",M={type:"literal",value:"select",description:'"select"'},N=function(t){return{type:"selectFormat",options:t,location:St()}},A="=",D={type:"literal",value:"=",description:'"="'},P=function(t,e){return{type:"optionalFormatPattern",selector:t,value:e,location:St()}},F="offset:",j={type:"literal",value:"offset:",description:'"offset:"'},z=function(t){return t},R=function(t,e){return{type:"pluralFormat",offset:t,options:e,location:St()}},o={type:"other",description:"whitespace"},q=/^[ \t\n\r]/,H={type:"class",value:"[ \\t\\n\\r]",description:"[ \\t\\n\\r]"},W={type:"other",description:"optionalWhitespace"},U=/^[0-9]/,B={type:"class",value:"[0-9]",description:"[0-9]"},J=/^[0-9a-f]/i,V={type:"class",value:"[0-9a-f]i",description:"[0-9a-f]i"},G="0",K={type:"literal",value:"0",description:'"0"'},Y=/^[1-9]/,Q={type:"class",value:"[1-9]",description:"[1-9]"},X=function(t){return parseInt(t,10)},Z=/^[^{}\\\0-\x1F \t\n\r]/,tt={type:"class",value:"[^{}\\\\\\0-\\x1F\\x7f \\t\\n\\r]",description:"[^{}\\\\\\0-\\x1F\\x7f \\t\\n\\r]"},et="\\\\",it={type:"literal",value:"\\\\",description:'"\\\\\\\\"'},nt=function(){return"\\"},st="\\#",ot={type:"literal",value:"\\#",description:'"\\\\#"'},at=function(){return"\\#"},rt="\\{",lt={type:"literal",value:"\\{",description:'"\\\\{"'},ht=function(){return"{"},ct="\\}",ut={type:"literal",value:"\\}",description:'"\\\\}"'},dt=function(){return"}"},pt="\\u",mt={type:"literal",value:"\\u",description:'"\\\\u"'},ft=function(t){return String.fromCharCode(parseInt(t,16))},gt=function(t){return t.join("")},vt=0,yt=0,bt=[{line:1,column:1,seenCR:!1}],wt=0,_t=[],Et=0;if("startRule"in t){if(!(t.startRule in e))throw new Error("Can't start parsing from rule \""+t.startRule+'".');i=e[t.startRule]}function St(){return kt(yt,vt)}function xt(t){var e,i,n=bt[t];if(n)return n;for(e=t-1;!bt[e];)e--;for(n={line:(n=bt[e]).line,column:n.column,seenCR:n.seenCR};e<t;)"\n"===(i=l.charAt(e))?(n.seenCR||n.line++,n.column=1,n.seenCR=!1):"\r"===i||"\u2028"===i||"\u2029"===i?(n.line++,n.column=1,n.seenCR=!0):(n.column++,n.seenCR=!1),e++;return bt[t]=n}function kt(t,e){var i=xt(t),n=xt(e);return{start:{offset:t,line:i.line,column:i.column},end:{offset:e,line:n.line,column:n.column}}}function Ct(t){vt<wt||(wt<vt&&(wt=vt,_t=[]),_t.push(t))}function Ot(t,e,i,n){return null!==e&&function(t){var e=1;for(t.sort(function(t,e){return t.description<e.description?-1:t.description>e.description?1:0});e<t.length;)t[e-1]===t[e]?t.splice(e,1):e++}(e),new Rt(null!==t?t:function(t,e){for(var i=new Array(t.length),n=0;n<t.length;n++)i[n]=t[n].description;function s(t){return t.charCodeAt(0).toString(16).toUpperCase()}return"Expected "+(1<t.length?i.slice(0,-1).join(", ")+" or "+i[t.length-1]:i[0])+" but "+(e?'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(t){return"\\x0"+s(t)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(t){return"\\x"+s(t)}).replace(/[\u0100-\u0FFF]/g,function(t){return"\\u0"+s(t)}).replace(/[\u1000-\uFFFF]/g,function(t){return"\\u"+s(t)})+'"':"end of input")+" found."}(e,i),e,i,n)}function $t(){return It()}function It(){for(var t=vt,e=[],i=Tt();i!==h;)e.push(i),i=Tt();return e!==h&&(yt=t,e=n(e)),t=e}function Tt(){var t=function(){var t,e;t=vt,(e=function(){var t,e,i,n,s,o;e=[],i=t=vt,i=(n=At())!==h?(s=zt(),s!==h?(o=At())!==h?n=[n,s,o]:(vt=i,h):(vt=i,h)):(vt=i,h);if(i!==h)for(;i!==h;)e.push(i),i=vt,n=At(),i=n!==h?(s=zt())!==h?(o=At())!==h?n=[n,s,o]:(vt=i,h):(vt=i,h):(vt=i,h);else e=h;e!==h&&(yt=t,e=a(e));(t=e)===h&&(t=vt,e=Nt(),t=e!==h?l.substring(t,vt):e);return t}())!==h&&(yt=t,e=s(e));return t=e}();return t=t===h?function(){var t,e,i,n,s,o,a;t=vt,123===l.charCodeAt(vt)?(e=u,vt++):(e=h,0===Et&&Ct(d));t=e!==h?(a=At(),a!==h?(i=function(){var t,e,i;if((t=Ft())===h){if(t=vt,e=[],r.test(l.charAt(vt))?(i=l.charAt(vt),vt++):(i=h,0===Et&&Ct(c)),i!==h)for(;i!==h;)e.push(i),r.test(l.charAt(vt))?(i=l.charAt(vt),vt++):(i=h,0===Et&&Ct(c));else e=h;t=e!==h?l.substring(t,vt):e}return t}())!==h?At()!==h?(n=vt,44===l.charCodeAt(vt)?(s=p,vt++):(s=h,0===Et&&Ct(m)),(n=(n=s!==h?(o=At())!==h?(a=function(){var t;(t=function(){var t,e,i,n,s,o;t=vt,l.substr(vt,6)===y?(e=y,vt+=6):(e=h,0===Et&&Ct(b));e===h&&(l.substr(vt,4)===w?(e=w,vt+=4):(e=h,0===Et&&Ct(_)),e===h&&(l.substr(vt,4)===E?(e=E,vt+=4):(e=h,0===Et&&Ct(S))));t=e!==h?(o=At(),o!==h?(i=vt,44===l.charCodeAt(vt)?(n=p,vt++):(n=h,0===Et&&Ct(m)),(i=(i=n!==h?(s=At())!==h?(o=zt())!==h?n=[n,s,o]:(vt=i,h):(vt=i,h):(vt=i,h))===h?null:i)!==h?(yt=t,e=x(e,i)):(vt=t,h)):(vt=t,h)):(vt=t,h);return t}())===h&&(t=function(){var t,e,i,n;t=vt,l.substr(vt,6)===k?(e=k,vt+=6):(e=h,0===Et&&Ct(C));t=e!==h?(i=At(),i!==h?(44===l.charCodeAt(vt)?(n=p,vt++):(n=h,0===Et&&Ct(m)),n!==h?At()!==h?(n=Mt())!==h?(yt=t,e=O(n)):(vt=t,h):(vt=t,h):(vt=t,h)):(vt=t,h)):(vt=t,h);return t}())===h&&(t=function(){var t,e,i,n;t=vt,l.substr(vt,13)===$?(e=$,vt+=13):(e=h,0===Et&&Ct(I));t=e!==h?(i=At(),i!==h?(44===l.charCodeAt(vt)?(n=p,vt++):(n=h,0===Et&&Ct(m)),n!==h?At()!==h?(n=Mt())!==h?(yt=t,e=T(n)):(vt=t,h):(vt=t,h):(vt=t,h)):(vt=t,h)):(vt=t,h);return t}())===h&&(t=function(){var t,e,i,n,s;t=vt,l.substr(vt,6)===L?(e=L,vt+=6):(e=h,0===Et&&Ct(M));if(e!==h)if(At()!==h)if(44===l.charCodeAt(vt)?(i=p,vt++):(i=h,0===Et&&Ct(m)),i!==h)if(At()!==h){if(n=[],(s=Lt())!==h)for(;s!==h;)n.push(s),s=Lt();else n=h;t=n!==h?(yt=t,e=N(n)):(vt=t,h)}else vt=t,t=h;else vt=t,t=h;else vt=t,t=h;else vt=t,t=h;return t}());return t}())!==h?s=[s,o,a]:(vt=n,h):(vt=n,h):(vt=n,h))===h?null:n)!==h?(s=At())!==h?(125===l.charCodeAt(vt)?(o=f,vt++):(o=h,0===Et&&Ct(g)),o!==h?(yt=t,e=v(i,n)):(vt=t,h)):(vt=t,h):(vt=t,h)):(vt=t,h):(vt=t,h):(vt=t,h)):(vt=t,h);return t}():t}function Lt(){var t,e,i,n,s,o,a=vt,r=At();return a=r!==h?(r=o=vt,61===l.charCodeAt(vt)?(n=A,vt++):(n=h,0===Et&&Ct(D)),(o=o=(o=(r=n!==h&&(s=Ft())!==h?n=[n,s]:(vt=r,h))!==h?l.substring(o,vt):r)===h?zt():o)!==h&&At()!==h?(123===l.charCodeAt(vt)?(t=u,vt++):(t=h,0===Et&&Ct(d)),t!==h&&At()!==h&&(e=It())!==h&&At()!==h?(125===l.charCodeAt(vt)?(i=f,vt++):(i=h,0===Et&&Ct(g)),i!==h?(yt=a,P(o,e)):(vt=a,h)):(vt=a,h)):(vt=a,h)):(vt=a,h)}function Mt(){var t,e,i,n,s,o=vt;if(s=vt,l.substr(vt,7)===F?(i=F,vt+=7):(i=h,0===Et&&Ct(j)),(s=(s=s=i!==h&&At()!==h&&(n=Ft())!==h?(yt=s,i=z(n)):(vt=s,h))===h?null:s)!==h)if(At()!==h){if(t=[],(e=Lt())!==h)for(;e!==h;)t.push(e),e=Lt();else t=h;o=t!==h?(yt=o,s=R(s,t)):(vt=o,h)}else vt=o,o=h;else vt=o,o=h;return o}function Nt(){var t,e;if(Et++,t=[],q.test(l.charAt(vt))?(e=l.charAt(vt),vt++):(e=h,0===Et&&Ct(H)),e!==h)for(;e!==h;)t.push(e),q.test(l.charAt(vt))?(e=l.charAt(vt),vt++):(e=h,0===Et&&Ct(H));else t=h;return Et--,t===h&&(e=h,0===Et&&Ct(o)),t}function At(){var t,e,i;for(Et++,t=vt,e=[],i=Nt();i!==h;)e.push(i),i=Nt();return t=e!==h?l.substring(t,vt):e,Et--,t===h&&(e=h,0===Et&&Ct(W)),t}function Dt(){var t;return U.test(l.charAt(vt))?(t=l.charAt(vt),vt++):(t=h,0===Et&&Ct(B)),t}function Pt(){var t;return J.test(l.charAt(vt))?(t=l.charAt(vt),vt++):(t=h,0===Et&&Ct(V)),t}function Ft(){var t,e,i,n,s,o=vt;if(48===l.charCodeAt(vt)?(t=G,vt++):(t=h,0===Et&&Ct(K)),t===h){if(e=t=vt,Y.test(l.charAt(vt))?(i=l.charAt(vt),vt++):(i=h,0===Et&&Ct(Q)),i!==h){for(n=[],s=Dt();s!==h;)n.push(s),s=Dt();e=n!==h?i=[i,n]:(vt=e,h)}else vt=e,e=h;t=e!==h?l.substring(t,vt):e}return t!==h&&(yt=o,t=X(t)),o=t}function jt(){var t,e,i,n,s,o,a,r;return Z.test(l.charAt(vt))?(t=l.charAt(vt),vt++):(t=h,0===Et&&Ct(tt)),t===h&&(t=vt,l.substr(vt,2)===et?(e=et,vt+=2):(e=h,0===Et&&Ct(it)),e!==h&&(yt=t,e=nt()),(t=e)===h&&(t=vt,l.substr(vt,2)===st?(e=st,vt+=2):(e=h,0===Et&&Ct(ot)),e!==h&&(yt=t,e=at()),(t=e)===h&&(t=vt,l.substr(vt,2)===rt?(e=rt,vt+=2):(e=h,0===Et&&Ct(lt)),e!==h&&(yt=t,e=ht()),(t=e)===h&&(t=vt,l.substr(vt,2)===ct?(e=ct,vt+=2):(e=h,0===Et&&Ct(ut)),e!==h&&(yt=t,e=dt()),(t=e)===h&&(t=vt,l.substr(vt,2)===pt?(e=pt,vt+=2):(e=h,0===Et&&Ct(mt)),t=e!==h?(n=i=vt,(i=(n=(s=Pt())!==h&&(o=Pt())!==h&&(a=Pt())!==h&&(r=Pt())!==h?[s,o,a,r]:(vt=n,h))!==h?l.substring(i,vt):n)!==h?(yt=t,e=ft(i)):(vt=t,h)):(vt=t,h)))))),t}function zt(){var t=vt,e=[],i=jt();if(i!==h)for(;i!==h;)e.push(i),i=jt();else e=h;return e!==h&&(yt=t,e=gt(e)),t=e}if((i=i())!==h&&vt===l.length)return i;throw i!==h&&vt<l.length&&Ct({type:"end",description:"end of input"}),Ot(null,_t,wt<l.length?l.charAt(wt):null,wt<l.length?kt(wt,wt+1):kt(wt,wt))}});function Rt(t,e,i,n){this.message=t,this.expected=e,this.found=i,this.location=n,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,Rt)}function u(){this.constructor=n}var d=p;function p(e,t,i){var n="string"==typeof e?p.__parse(e):e;if(!n||"messageFormatPattern"!==n.type)throw new TypeError("A message must be provided as a String or AST.");i=this._mergeFormats(p.formats,i),r(this,"_locale",{value:this._resolveLocale(t)});var s=this._findPluralRuleFunction(this._locale),o=this._compilePattern(n,t,i,s),a=this;this.format=function(t){try{return a._format(o,t)}catch(t){throw t.variableId?new Error("The intl string context variable '"+t.variableId+"' was not provided to the string '"+e+"'"):t}}}r(p,"formats",{enumerable:!0,value:{number:{currency:{style:"currency"},percent:{style:"percent"}},date:{short:{month:"numeric",day:"numeric",year:"2-digit"},medium:{month:"short",day:"numeric",year:"numeric"},long:{month:"long",day:"numeric",year:"numeric"},full:{weekday:"long",month:"long",day:"numeric",year:"numeric"}},time:{short:{hour:"numeric",minute:"numeric"},medium:{hour:"numeric",minute:"numeric",second:"numeric"},long:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"},full:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"}}}}),r(p,"__localeData__",{value:o(null)}),r(p,"__addLocaleData",{value:function(t){if(!t||!t.locale)throw new Error("Locale data provided to IntlMessageFormat is missing a `locale` property");p.__localeData__[t.locale.toLowerCase()]=t}}),r(p,"__parse",{value:t.parse}),r(p,"defaultLocale",{enumerable:!0,writable:!0,value:void 0}),p.prototype.resolvedOptions=function(){return{locale:this._locale}},p.prototype._compilePattern=function(t,e,i,n){return new s(e,i,n).compile(t)},p.prototype._findPluralRuleFunction=function(t){for(var e=p.__localeData__,i=e[t.toLowerCase()];i;){if(i.pluralRuleFunction)return i.pluralRuleFunction;i=i.parentLocale&&e[i.parentLocale.toLowerCase()]}throw new Error("Locale data added to IntlMessageFormat is missing a `pluralRuleFunction` for :"+t)},p.prototype._format=function(t,e){for(var i,n,s,o="",a=0,r=t.length;a<r;a+=1)if("string"!=typeof(i=t[a])){if(n=i.id,!e||!l.call(e,n))throw(s=new Error("A value must be provided for: "+n)).variableId=n,s;n=e[n],i.options?o+=this._format(i.getOption(n),e):o+=i.format(n)}else o+=i;return o},p.prototype._mergeFormats=function(t,e){var i,n,s={};for(i in t)l.call(t,i)&&(s[i]=n=o(t[i]),e&&l.call(e,i)&&function(t){for(var e,i,n=Array.prototype.slice.call(arguments,1),s=0,o=n.length;s<o;s+=1)if(e=n[s])for(i in e)l.call(e,i)&&(t[i]=e[i])}(n,e[i]));return s},p.prototype._resolveLocale=function(t){t=((t="string"==typeof t?[t]:t)||[]).concat(p.defaultLocale);for(var e,i,n=p.__localeData__,s=0,o=t.length;s<o;s+=1)for(e=t[s].toLowerCase().split("-");e.length;){if(i=n[e.join("-")])return i.locale;e.pop()}var a=t.pop();throw new Error("No locale data has been added to IntlMessageFormat for: "+t.join(", ")+", or the default locale: "+a)},d.__addLocaleData({locale:"en",pluralRuleFunction:function(t,e){var i=String(t).split("."),n=!i[1],s=Number(i[0])==t,o=s&&i[0].slice(-1),i=s&&i[0].slice(-2);return e?1==o&&11!=i?"one":2==o&&12!=i?"two":3==o&&13!=i?"few":"other":1==t&&n?"one":"other"}}),d.defaultLocale="en",this.IntlMessageFormat=d}.call(this),IntlMessageFormat.__addLocaleData({locale:"nl",pluralRuleFunction:function(t,e){var i=!String(t).split(".")[1];return!e&&1==t&&i?"one":"other"}}),IntlMessageFormat.__addLocaleData({locale:"nl-AW",parentLocale:"nl"}),IntlMessageFormat.__addLocaleData({locale:"nl-BE",parentLocale:"nl"}),IntlMessageFormat.__addLocaleData({locale:"nl-BQ",parentLocale:"nl"}),IntlMessageFormat.__addLocaleData({locale:"nl-CW",parentLocale:"nl"}),IntlMessageFormat.__addLocaleData({locale:"nl-SR",parentLocale:"nl"}),IntlMessageFormat.__addLocaleData({locale:"nl-SX",parentLocale:"nl"}),IntlMessageFormat.__addLocaleData({locale:"en",pluralRuleFunction:function(t,e){var i=String(t).split("."),n=!i[1],s=Number(i[0])==t,o=s&&i[0].slice(-1),i=s&&i[0].slice(-2);return e?1==o&&11!=i?"one":2==o&&12!=i?"two":3==o&&13!=i?"few":"other":1==t&&n?"one":"other"}}),IntlMessageFormat.__addLocaleData({locale:"en-001",parentLocale:"en"}),IntlMessageFormat.__addLocaleData({locale:"en-150",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-AG",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-AI",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-AS",parentLocale:"en"}),IntlMessageFormat.__addLocaleData({locale:"en-AT",parentLocale:"en-150"}),IntlMessageFormat.__addLocaleData({locale:"en-AU",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-BB",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-BE",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-BI",parentLocale:"en"}),IntlMessageFormat.__addLocaleData({locale:"en-BM",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-BS",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-BW",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-BZ",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-CA",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-CC",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-CH",parentLocale:"en-150"}),IntlMessageFormat.__addLocaleData({locale:"en-CK",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-CM",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-CX",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-CY",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-DE",parentLocale:"en-150"}),IntlMessageFormat.__addLocaleData({locale:"en-DG",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-DK",parentLocale:"en-150"}),IntlMessageFormat.__addLocaleData({locale:"en-DM",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-Dsrt",pluralRuleFunction:function(t,e){return"other"}}),IntlMessageFormat.__addLocaleData({locale:"en-ER",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-FI",parentLocale:"en-150"}),IntlMessageFormat.__addLocaleData({locale:"en-FJ",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-FK",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-FM",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-GB",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-GD",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-GG",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-GH",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-GI",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-GM",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-GU",parentLocale:"en"}),IntlMessageFormat.__addLocaleData({locale:"en-GY",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-HK",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-IE",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-IL",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-IM",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-IN",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-IO",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-JE",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-JM",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-KE",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-KI",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-KN",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-KY",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-LC",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-LR",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-LS",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-MG",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-MH",parentLocale:"en"}),IntlMessageFormat.__addLocaleData({locale:"en-MO",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-MP",parentLocale:"en"}),IntlMessageFormat.__addLocaleData({locale:"en-MS",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-MT",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-MU",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-MW",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-MY",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-NA",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-NF",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-NG",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-NL",parentLocale:"en-150"}),IntlMessageFormat.__addLocaleData({locale:"en-NR",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-NU",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-NZ",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-PG",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-PH",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-PK",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-PN",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-PR",parentLocale:"en"}),IntlMessageFormat.__addLocaleData({locale:"en-PW",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-RW",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-SB",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-SC",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-SD",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-SE",parentLocale:"en-150"}),IntlMessageFormat.__addLocaleData({locale:"en-SG",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-SH",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-SI",parentLocale:"en-150"}),IntlMessageFormat.__addLocaleData({locale:"en-SL",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-SS",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-SX",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-SZ",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-Shaw",pluralRuleFunction:function(t,e){return"other"}}),IntlMessageFormat.__addLocaleData({locale:"en-TC",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-TK",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-TO",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-TT",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-TV",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-TZ",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-UG",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-UM",parentLocale:"en"}),IntlMessageFormat.__addLocaleData({locale:"en-US",parentLocale:"en"}),IntlMessageFormat.__addLocaleData({locale:"en-VC",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-VG",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-VI",parentLocale:"en"}),IntlMessageFormat.__addLocaleData({locale:"en-VU",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-WS",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-ZA",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-ZM",parentLocale:"en-001"}),IntlMessageFormat.__addLocaleData({locale:"en-ZW",parentLocale:"en-001"});var CoffeeTip=new Class({Implements:[Events],Binds:["position"],tip:!1,ttbox:!1,active:null,initialize:function(){},build:function(i){i.sanitize=!0,(i.txt=i.get("data-tooltip-text"))?(i.removeAttribute("data-tooltip-text"),i.sanitize=!1):i.txt=i.get("title"),i.txt&&""!=i.txt&&(i.addEvent("mouseenter",function(t){this.start(i),this.position(t)}.bind(this)),i.addEvent("mousemove",function(t){var e=this.getTip();e&&"function"==typeof e.getStyle&&"none"===e.getStyle("display")&&this.start(i),this.position(t)}.bind(this)),i.addEvent("mouseleave",function(t){this.end(i)}.bind(this)),i.addEvent("click",function(t){this.end(i)}.bind(this)),i.addEvent("trash",function(t){this.end(i)}.bind(this)))},getTip:function(){return 0==this.tip&&(this.ttbox=new Element("div",{class:"tip-text"}),this.tip=new Element("div",{class:"tip-wrap shadow_bottom",styles:{position:"absolute",top:0,left:0,display:"none"}}).adopt(this.ttbox).inject(document.body)),$(this.tip)},start:function(t,e){var i=this.getTip(),n=null;0!=i&&"function"==typeof i.setStyles&&(n=t.txt)&&(this.ttbox.empty(),t.sanitize&&(t.set("title",""),n=(n=(n=(n=(n=(n=n.replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/\n- ([^\n]*)/g,"<li>$1</li>")).replace(/\n\* ([^\n]*)/g,"<li><strong>$1</strong></li>")).replace(/(<li>.*<\/li>)+\n?/g,"<ul>$1</ul>")).replace(/\n/g,"<br />")),this.ttbox.set("html",n),this.active||i.setStyles({display:"block",left:100}),i.setStyle("width","auto"),400<i.offsetWidth&&i.setStyle("width",400),this.active=t)},update:function(t){t.sanitize?t.txt=t.get("title"):t.txt=t.get("data-tooltip-text");this.getTip();this.active&&this.active===t&&(this.start(t),this.position())},end:function(t){var e=this.getTip();e&&"function"==typeof e.setStyles&&(e.setStyles({display:"none",width:"auto"}),t&&t.sanitize&&t.set("title",t.txt),this.active=null)},position:function(t){var e=this.getTip();if(0!=e&&"function"==typeof e.setStyles)try{var i=window.getScrollTop(),n=window.getSize(),s=t.page.x+5,o=t.page.y+10;s+this.tip.offsetWidth>n.x&&(s=n.x-this.tip.offsetWidth-5),o+this.tip.offsetHeight>n.y+i&&(o-=this.tip.offsetHeight+15),e.setStyles({left:s,top:o})}catch(t){}}});!function(){"use strict";var d,i,p,m;function o(t){try{return t.defaultView&&t.defaultView.frameElement||null}catch(t){return null}}function h(t){this.time=t.time,this.target=t.target,this.rootBounds=n(t.rootBounds),this.boundingClientRect=n(t.boundingClientRect),this.intersectionRect=n(t.intersectionRect||c()),this.isIntersecting=!!t.intersectionRect;var e=this.boundingClientRect,t=e.width*e.height,e=this.intersectionRect,e=e.width*e.height;this.intersectionRatio=t?Number((e/t).toFixed(4)):this.isIntersecting?1:0}function t(t,e){var i,n,s,e=e||{};if("function"!=typeof t)throw new Error("callback must be a function");if(e.root&&1!=e.root.nodeType&&9!=e.root.nodeType)throw new Error("root must be a Document or Element");this._checkForIntersections=(i=this._checkForIntersections.bind(this),n=this.THROTTLE_TIMEOUT,s=null,function(){s=s||setTimeout(function(){i(),s=null},n)}),this._callback=t,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(e.rootMargin),this.thresholds=this._initThresholds(e.threshold),this.root=e.root||null,this.rootMargin=this._rootMarginValues.map(function(t){return t.value+t.unit}).join(" "),this._monitoringDocuments=[],this._monitoringUnsubscribes=[]}function a(t,e,i,n){"function"==typeof t.addEventListener?t.addEventListener(e,i,n||!1):"function"==typeof t.attachEvent&&t.attachEvent("on"+e,i)}function r(t,e,i,n){"function"==typeof t.removeEventListener?t.removeEventListener(e,i,n||!1):"function"==typeof t.detachEvent&&t.detachEvent("on"+e,i)}function f(t){var e;try{e=t.getBoundingClientRect()}catch(t){}return e?e.width&&e.height?e:{top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.right-e.left,height:e.bottom-e.top}:c()}function c(){return{top:0,bottom:0,left:0,right:0,width:0,height:0}}function n(t){return!t||"x"in t?t:{top:t.top,y:t.top,bottom:t.bottom,left:t.left,x:t.left,right:t.right,width:t.width,height:t.height}}function g(t,e){var i=e.top-t.top,t=e.left-t.left;return{top:i,left:t,height:e.height,width:e.width,bottom:i+e.height,right:t+e.width}}function s(t,e){for(var i=e;i;){if(i==t)return!0;i=v(i)}return!1}function v(t){var e=t.parentNode;return 9==t.nodeType&&t!=d?o(t):(e=e&&e.assignedSlot?e.assignedSlot.parentNode:e)&&11==e.nodeType&&e.host?e.host:e}function l(t){return t&&9===t.nodeType}"object"==typeof window&&("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype?"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return 0<this.intersectionRatio}}):(d=function(){for(var t=window.document,e=o(t);e;)e=o(t=e.ownerDocument);return t}(),i=[],m=p=null,t.prototype.THROTTLE_TIMEOUT=100,t.prototype.POLL_INTERVAL=null,t.prototype.USE_MUTATION_OBSERVER=!0,t._setupCrossOriginUpdater=function(){return p=p||function(t,e){m=t&&e?g(t,e):c(),i.forEach(function(t){t._checkForIntersections()})}},t._resetCrossOriginUpdater=function(){m=p=null},t.prototype.observe=function(e){if(!this._observationTargets.some(function(t){return t.element==e})){if(!e||1!=e.nodeType)throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:e,entry:null}),this._monitorIntersections(e.ownerDocument),this._checkForIntersections()}},t.prototype.unobserve=function(e){this._observationTargets=this._observationTargets.filter(function(t){return t.element!=e}),this._unmonitorIntersections(e.ownerDocument),0==this._observationTargets.length&&this._unregisterInstance()},t.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorAllIntersections(),this._unregisterInstance()},t.prototype.takeRecords=function(){var t=this._queuedEntries.slice();return this._queuedEntries=[],t},t.prototype._initThresholds=function(t){t=t||[0];return(t=!Array.isArray(t)?[t]:t).sort().filter(function(t,e,i){if("number"!=typeof t||isNaN(t)||t<0||1<t)throw new Error("threshold must be a number between 0 and 1 inclusively");return t!==i[e-1]})},t.prototype._parseRootMargin=function(t){t=(t||"0px").split(/\s+/).map(function(t){t=/^(-?\d*\.?\d+)(px|%)$/.exec(t);if(!t)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(t[1]),unit:t[2]}});return t[1]=t[1]||t[0],t[2]=t[2]||t[0],t[3]=t[3]||t[1],t},t.prototype._monitorIntersections=function(e){var i,n,s,t=e.defaultView;t&&-1==this._monitoringDocuments.indexOf(e)&&(i=this._checkForIntersections,s=n=null,this.POLL_INTERVAL?n=t.setInterval(i,this.POLL_INTERVAL):(a(t,"resize",i,!0),a(e,"scroll",i,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in t&&(s=new t.MutationObserver(i)).observe(e,{attributes:!0,childList:!0,characterData:!0,subtree:!0})),this._monitoringDocuments.push(e),this._monitoringUnsubscribes.push(function(){var t=e.defaultView;t&&(n&&t.clearInterval(n),r(t,"resize",i,!0)),r(e,"scroll",i,!0),s&&s.disconnect()}),t=this.root&&(this.root.ownerDocument||this.root)||d,e==t||(t=o(e))&&this._monitorIntersections(t.ownerDocument))},t.prototype._unmonitorIntersections=function(n){var s,t,e=this._monitoringDocuments.indexOf(n);-1!=e&&(s=this.root&&(this.root.ownerDocument||this.root)||d,this._observationTargets.some(function(t){if((e=t.element.ownerDocument)==n)return!0;for(;e&&e!=s;){var e,i=o(e);if((e=i&&i.ownerDocument)==n)return!0}return!1})||(t=this._monitoringUnsubscribes[e],this._monitoringDocuments.splice(e,1),this._monitoringUnsubscribes.splice(e,1),t(),n==s||(t=o(n))&&this._unmonitorIntersections(t.ownerDocument)))},t.prototype._unmonitorAllIntersections=function(){var t=this._monitoringUnsubscribes.slice(0);this._monitoringDocuments.length=0;for(var e=this._monitoringUnsubscribes.length=0;e<t.length;e++)t[e]()},t.prototype._checkForIntersections=function(){var r,l;!this.root&&p&&!m||(r=this._rootIsInDom(),l=r?this._getRootRect():c(),this._observationTargets.forEach(function(t){var e=t.element,i=f(e),n=this._rootContainsTarget(e),s=t.entry,o=r&&n&&this._computeTargetAndRootIntersection(e,i,l),a=null;this._rootContainsTarget(e)?p&&!this.root||(a=l):a=c();o=t.entry=new h({time:window.performance&&performance.now&&performance.now(),target:e,boundingClientRect:i,rootBounds:a,intersectionRect:o});s?r&&n?this._hasCrossedThreshold(s,o)&&this._queuedEntries.push(o):s&&s.isIntersecting&&this._queuedEntries.push(o):this._queuedEntries.push(o)},this),this._queuedEntries.length&&this._callback(this.takeRecords(),this))},t.prototype._computeTargetAndRootIntersection=function(t,e,i){if("none"!=window.getComputedStyle(t).display){for(var n=e,s=v(t),o=!1;!o&&s;){var a,r,l,h,c=null,u=1==s.nodeType?window.getComputedStyle(s):{};if("none"==u.display)return null;if(s==this.root||9==s.nodeType?(o=!0,s==this.root||s==d?p&&!this.root?!m||0==m.width&&0==m.height?n=c=s=null:c=m:c=i:(r=(a=v(s))&&f(a),l=a&&this._computeTargetAndRootIntersection(a,r,i),r&&l?(s=a,c=g(r,l)):n=s=null)):s!=(h=s.ownerDocument).body&&s!=h.documentElement&&"visible"!=u.overflow&&(c=f(s)),c&&(a=c,r=n,c=u=h=l=void 0,l=Math.max(a.top,r.top),h=Math.min(a.bottom,r.bottom),u=Math.max(a.left,r.left),c=Math.min(a.right,r.right),r=h-l,n=0<=(a=c-u)&&0<=r?{top:l,bottom:h,left:u,right:c,width:a,height:r}:null),!n)break;s=s&&v(s)}return n}},t.prototype._getRootRect=function(){var t,e;return e=this.root&&!l(this.root)?f(this.root):(t=(e=l(this.root)?this.root:d).documentElement,e=e.body,{top:0,left:0,right:t.clientWidth||e.clientWidth,width:t.clientWidth||e.clientWidth,bottom:t.clientHeight||e.clientHeight,height:t.clientHeight||e.clientHeight}),this._expandRectByRootMargin(e)},t.prototype._expandRectByRootMargin=function(i){var t=this._rootMarginValues.map(function(t,e){return"px"==t.unit?t.value:t.value*(e%2?i.width:i.height)/100}),t={top:i.top-t[0],right:i.right+t[1],bottom:i.bottom+t[2],left:i.left-t[3]};return t.width=t.right-t.left,t.height=t.bottom-t.top,t},t.prototype._hasCrossedThreshold=function(t,e){var i=t&&t.isIntersecting?t.intersectionRatio||0:-1,n=e.isIntersecting?e.intersectionRatio||0:-1;if(i!==n)for(var s=0;s<this.thresholds.length;s++){var o=this.thresholds[s];if(o==i||o==n||o<i!=o<n)return!0}},t.prototype._rootIsInDom=function(){return!this.root||s(d,this.root)},t.prototype._rootContainsTarget=function(t){var e=this.root&&(this.root.ownerDocument||this.root)||d;return s(e,t)&&(!this.root||e==t.ownerDocument)},t.prototype._registerInstance=function(){i.indexOf(this)<0&&i.push(this)},t.prototype._unregisterInstance=function(){var t=i.indexOf(this);-1!=t&&i.splice(t,1)},window.IntersectionObserver=t,window.IntersectionObserverEntry=h))}();var FormTip=new Class({Implements:[Events],tip:!1,ttbox:!1,initialize:function(){},build:function(i){var t,e;i.ttitle||((i.ttitle=i.get("data-tooltip-text"))||(i.ttitle=i.get("title")))&&(i.addEvent("focus",function(t){var e=this.getTip();e&&"function"==typeof e.getStyle&&"none"===e.getStyle("display")&&this.start(i),this.position(t)}.bind(this)),t=this.end.bind(this),(e=i.getParent("form"))&&e.addEvent("submit",t),i.addEvent("blur",t),i.addEvent("trash",t),i.set("title",""))},getTip:function(){return 0==this.tip&&(this.ttbox=new Element("div",{class:"tip-text"}),this.tip=new Element("div",{class:"formtip-wrap",styles:{position:"absolute",top:0,left:0,display:"none"}}).adopt(this.ttbox).inject(document.body)),$(this.tip)},start:function(t){var e=this.getTip();0!=e&&"function"==typeof e.setStyles&&(this.ttbox.empty(),this.ttbox.set("html",t.ttitle),this.tip.setStyles({display:"block",left:0}),t=Math.min(Math.max(this.tip.offsetWidth,t.offsetWidth),400),this.tip.setStyle("width",t))},end:function(t){var e=this.getTip();if(e&&"function"==typeof e.setStyles)try{this.tip.setStyles({display:"none",width:"auto"})}catch(t){}},position:function(t){var e=this.getTip();if(0!=e&&"function"==typeof e.setStyles)try{var i=t.target,n=i.getPosition(),s=window.getScrollTop(),o=window.getSize(),a=n.x,r=n.y+i.getSize().y+10;a+this.tip.offsetWidth>o.x&&(a=o.x-this.tip.offsetWidth-5),r+this.tip.offsetHeight>o.y+s?(r=n.y-this.tip.offsetHeight-8,this.tip.set("class","formtip-wrap tip-arrowbottom")):this.tip.set("class","formtip-wrap tip-arrowtop"),this.tip.setStyles({left:a,top:r})}catch(t){}}});document.id,Element.NativeEvents.hashchange=2,HashListener=new Class({Implements:[Options,Events],options:{blank_page:"blank.html",start:!1},iframe:null,currentHash:"",firstLoad:!0,handle:!1,useIframe:Browser.ie&&(void 0===document.documentMode||document.documentMode<8),ignoreLocationChange:!1,initialize:function(t){var e=this;this.setOptions(t),Browser.opera&&window.history.navigationMode&&(window.history.navigationMode="compatible"),"onhashchange"in window&&(void 0===document.documentMode||7<document.documentMode)?window.addEvent("hashchange",function(){var t=e.getHash();t!=e.currentHash&&(e.fireEvent("hashChanged",t),e.fireEvent("hash-changed",t))}):this.useIframe&&this.initializeHistoryIframe(),window.addEvent("unload",function(t){e.firstLoad=null}),this.options.start&&this.start()},initializeHistoryIframe:function(){var t,e=this.getHash();this.iframe=new IFrame({src:this.options.blank_page,styles:{position:"absolute",top:0,left:0,width:"1px",height:"1px",visibility:"hidden"}}).inject(document.body),(t=this.iframe.contentDocument||this.iframe.contentWindow.document).open(),t.write('<html><body id="state">'+e+"</body></html>"),t.close()},checkHash:function(){var t,e=this.getHash();this.ignoreLocationChange?this.ignoreLocationChange=!1:(this.useIframe&&(t=(this.iframe.contentDocument?this.iframe.contentDocumnet:this.iframe.contentWindow.document).body.innerHTML)!=e&&(this.setHash(t),e=t),this.currentLocation!=e&&(this.currentLocation=e,this.fireEvent("hashChanged",e),this.fireEvent("hash-changed",e)))},setHash:function(t){window.location.hash=this.currentLocation=t,"onhashchange"in window&&(void 0===document.documentMode||7<document.documentMode)||(this.fireEvent("hashChanged",t),this.fireEvent("hash-changed",t))},getHash:function(){var t;return Browser.firefox&&Browser.version<35?(t=/#(.*)$/.exec(window.location.href))&&t[1]?t[1]:"":window.location.hash.substr(1)},setIframeHash:function(t){var e=this.iframe.contentDocument?this.iframe.contentDocumnet:this.iframe.contentWindow.document;e.open(),e.write('<html><body id="state">'+t+"</body></html>"),e.close()},updateHash:function(t){document.id(t)&&this.debug_msg("Exception: History locations can not have the same value as _any_ IDs that might be in the document, due to a bug in IE; please ask the developer to choose a history location that does not match any HTML IDs in this document. The following ID is already taken and cannot be a location: "+t),this.ignoreLocationChange=!0,this.useIframe?this.setIframeHash(t):this.setHash(t)},start:function(){this.handle=this.checkHash.periodical(100,this)},stop:function(){clearInterval(this.handle)}}),function(){function i(t){if(void 0!==document["$"+t])return document["$"+t];for(var e=t+"=",i=document.cookie.split(";"),n=0;n<i.length;n++){for(var s=i[n];" "==s.charAt(0);)s=s.substring(1,s.length);if(0==s.indexOf(e))return s.substring(e.length,s.length)}return null}"undefined"!=typeof $Request&&"undefined"!=typeof Class&&void 0!==Class.refactor&&($Request.implement("options",{csrf_protection:!0}),$Request=Class.refactor($Request,{initialize:function(t){void 0===(t=t||{}).csrf_protection&&(t.csrf_protection=!0);var e=void 0!==t&&void 0!==t.method?"POST"===t.method.toUpperCase():"POST"===this.options.method.toUpperCase();t.csrf_protection&&e&&((e=i("csrf"))&&(void 0===t.headers&&(t.headers={}),t.headers["X-CSRF-TOKEN"]=e)),this.previous(t)}})),void 0===window.getCSRFHeaderName&&(window.getCSRFHeaderName=function(){return"X-CSRF-TOKEN"}),void 0===window.getCSRFToken&&(window.getCSRFToken=function(){return i("csrf")})}(),function(){var t;window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){window.setTimeout(t,1e3/60)},Element.implement({startLoading:function(e,t){var i,n,s,o,a,r,l,h=$(this.get("data-loader")),c=this;h?c.set("data-load_count",c.get("data-load_count").toInt()+1):(i=c.getSize(),e=void 0!==e&&e,t=void 0!==t&&t,"absolute"==c.getStyle("position")?(n=c.getStyle("top"),s=c.getStyle("left"),a="after",o="absolute"):("relative"!=c.getStyle("position")&&"body"!==c.tagName.toLowerCase()&&c.setStyle("position","relative"),l=c.getPosition(c.getParent()),n=e?0:l.y,s=e?0:l.x,o=e?"relative":"absolute",a=e?"before":c===document.body?"bottom":"after"),r=i.x<75||i.y<75,l=c.get("text").trim(),t=t?"#ffffff":"transparent"==c.getStyle("background-color")?1<l.length&&"&nbsp;"!=l?"#ffffff":"transparent":c.getStyle("background-color"),l=c.getStyle("z-index"),r?h=new Element("div.loading",{id:String.uniqueID(),styles:{"background-color":t,"background-image":'url("'+$base_url+'/base/resources/static/ajax_small.gif")',"background-position":"50% 50%","background-repeat":"no-repeat",position:o,top:n,left:s,width:i.x,height:i.y,"z-index":("auto"==l?0:l)+10}}).setStyle("opacity",0).inject(c,a):((h=new Element("div.loading.spinneroverlay",{id:String.uniqueID(),styles:{position:o,top:n,left:s,width:i.x,height:i.y,"z-index":("auto"==l?0:l)+10}}).setStyle("opacity",0).inject(c,a)).grab(new Element("div.spinner.spinnerabs")),requestAnimationFrame(this.resizeLoading.bind(c))),c.set("data-loader",h.id),h.effect=e?{start:function(t){0<t?e&&("absolute"==c.getStyle("position")?c.setStyle("visibility","hidden"):(c.set("data-olddisplay",c.getStyle("display")),c.setStyle("display","none"))):e&&("absolute"==c.getStyle("position")?c.setStyle("visibility","visible"):c.setStyle("display",c.get("data-olddisplay"))),h.setStyle("opacity",t)},cancel:function(){}}:new Fx.Tween(h,{link:"cancel",duration:150,property:"opacity",onComplete:function(){0==$(h).get("opacity")&&(h.destroy(),c.set("data-load_count",0))}.bind(this)}),c.set("data-loader-disabler",function(){h&&"function"===typeOf(h.addEvent)&&(h.addEvent("click",function(){h&&(h.set("data-load_count",1),h.removeClass("pointer"),h.removeEvents("click"),c.stopLoading())}),h.addClass("pointer"))}.delay(1500)),c.set("data-load_count",1),h.effect.start(.7))},resizeLoading:function(t){var e;0!=(t=$(this.get("data-loader")))&&null!=t&&(e=this.getSize(),this.previousSize&&this.previousSize.x===e.x&&this.previousSize.y===e.y||(t.setStyles({width:e.x,height:e.y}),this.previousSize=e),requestAnimationFrame(this.resizeLoading.bind(this)))},stopLoading:function(t){t=void 0!==t&&t;var e,i=$(this.get("data-loader"));0!=i&&null!=i&&(e=this.getSize(),i.setStyles({width:e.x,height:e.y}),!1!==i?1==(e=this.get("data-load_count").toInt())||t?((t=this.get("data-loader_disabler"))&&clearTimeout(t),0!=(t=i.effect)&&null!=i.effect&&t.cancel(),i.destroy(),"none"!=this.getStyle("display")&&"hidden"!=this.getStyle("visibility")||("absolute"==this.getStyle("position")?this.setStyle("visibility","visible"):this.setStyle("display",this.get("data-olddisplay"))),this.fireEvent("load"),this.set("data-load_count",0)):this.set("data-load_count",e-1):this.set("data-load_count",0))},isLoading:function(){return null!==$(this.get("data-loader"))},createLinks:function(){this.getElements(".newwindow").each(function(e){var t=e.tagName.toLowerCase();"a"!==t||null!==e.get("href").match(/^mailto:/i)||e.hasClass("qtistyle-filedownload")&&".pdf"===e.get("href").substr(-4)?"form"===t&&e.addEvent("submit",function(t){t.stop();t=e.toQueryString();window.open(e.get("action")+"?"+t)}):(e.addEvent("click",function(t){this.rel&&this.rel.match(/\d+,\d+/)?popup(this.href,this.rel.split(",")[0],this.rel.split(",")[1],"yes"):window.open(this.href,"_blank","noopener"),t.preventDefault()}),e.set("newwindowClickEventAttached",!0))})},createSymbolLists:function(){document.$sl||(document.$sl=new SymbolList),document.$sl.load(this.getElements(".symbollist input[type=text], .symbollist textarea, input[type=text].symbollist, textarea.symbollist"))},createTooltips:function(){var t;Cookie.read("disable_tooltips")||(t=this.getElements(".tooltip, .formtip"),(this.hasClass("tooltip")||this.hasClass("formtip"))&&t.push(this),t.each(function(e){var t,i;void 0===e.__tooltip?(t="",(i=e.hasAttribute("data-tooltip-text"))?(t=e.getAttribute("data-tooltip-text"),e.removeAttribute("data-tooltip-text")):t=e.getAttribute("title"),i={html:i,container:window.document.body,title:t,trigger:"focus"},"ie"===Browser.name&&(i.template='<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>'),e.hasAttribute("data-tooltip-placement")&&(i.placement=e.getAttribute("data-tooltip-placement")),e.classList.contains("formtip")?i.placement="bottom-start":(e.__tooltip_parent=e.getParent(".tooltip"),e.addEvent("mouseenter",function(t){e.removeAttribute("title"),e.__tooltip&&(e.__tooltip.show(),e.__tooltip._tooltipNode&&"none"===e.__tooltip._tooltipNode.style.display&&function(){e.__tooltip._isOpen&&e.__tooltip.hide().show()}.delay(100),e.__tooltip._tooltipNode&&""==e.__tooltip._tooltipNode.getElement(".tooltip-inner").get("html")&&e.__tooltip._tooltipNode.getElement(".tooltip-inner").set("html",e.__tooltip.options.title),e.__tooltip_parent&&e.__tooltip_parent.__tooltip&&e.__tooltip_parent.__tooltip._tooltipNode&&e.__tooltip_parent.__tooltip.hide())}),e.addEvent("mouseleave",function(t){e.__tooltip&&e.__tooltip._tooltipNode&&(e.__tooltip.hide(),e.__tooltip_parent&&e.__tooltip_parent.__tooltip&&e.__tooltip_parent.__tooltip.show())}),e.addEvent("mousedown",function(t){e.__tooltip&&e.__tooltip._tooltipNode&&e.__tooltip.hide()})),e.hasAttribute("data-tooltip-options")&&(i=Object.merge(i,JSON.decode(e.getAttribute("data-tooltip-options")))),e.removeAttribute("title"),e.__tooltip=new Tooltip(e,i)):e.hasAttribute("title")&&(t=e.getAttribute("title"),e.__tooltip._tooltipNode&&(e.__tooltip._tooltipNode.getElement(".tooltip-inner").set("html",t),e.removeAttribute("title")),e.__tooltip.updateTitleContent(t))}))},setTooltip:function(t,e){void 0!==this.__tooltip&&this.__tooltip.dispose();var i=this,e=i.hasAttribute("data-tooltip-text");void 0!==t&&""!==t&&null!==t||(e?(t=i.getAttribute("data-tooltip-text"),i.removeAttribute("data-tooltip-text")):t=i.getAttribute("title"));t={html:e,container:window.document.body,title:t,trigger:"focus"};"ie"===Browser.name&&(t.template='<div class="tooltip" role="tooltip" style="display:none"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>'),i.hasAttribute("data-tooltip-placement")&&(t.placement=i.getAttribute("data-tooltip-placement")),i.classList.contains("formtip")?t.placement="bottom-start":(i.__tooltip_parent=i.getParent(".tooltip"),i.addEvent("mouseenter",function(t){i.__tooltip&&(i.__tooltip.show(),i.__tooltip._tooltipNode&&"none"===i.__tooltip._tooltipNode.style.display&&function(){i.__tooltip._isOpen&&i.__tooltip.hide().show()}.delay(100),i.__tooltip._tooltipNode&&""==i.__tooltip._tooltipNode.getElement(".tooltip-inner").get("html")&&i.__tooltip._tooltipNode.getElement(".tooltip-inner").set("html",i.__tooltip.options.title),i.__tooltip_parent&&i.__tooltip_parent.__tooltip&&i.__tooltip_parent.__tooltip._tooltipNode&&i.__tooltip_parent.__tooltip.hide())}),i.addEvent("mouseleave",function(t){i.__tooltip&&i.__tooltip._tooltipNode&&(i.__tooltip.hide(),i.__tooltip_parent&&i.__tooltip_parent.__tooltip&&i.__tooltip_parent.__tooltip.show())}),i.addEvent("mousedown",function(t){i.__tooltip&&i.__tooltip._tooltipNode&&i.__tooltip.hide()})),i.hasAttribute("data-tooltip-options")&&(t=Object.merge(t,JSON.decode(i.getAttribute("data-tooltip-options")))),i.__tooltip=new Tooltip(i,t)},createProgressMeters:function(){this.getElements(".progressmeter").each(function(t){new ProgressMeter(t).start()})},createSliders:function(){this.addEvent("click:relay(a.slide_toggle)",function(t){var e=t.target;"a"!=e.get("tag")&&(e=e.getParent("a")),void 0!==t.preventDefault&&t.preventDefault();var i="fas fa-chevron-down",n="fas fa-chevron-right",s=e.getElement("span."+n+", span."+i),t=(t=e.get("data-target"))||(e.rel||e.hash.substring(1));void 0===e.slide_fx&&(e.slide_fx=new Fx.Slide(t,{duration:250,onStart:function(t){this.open?t.fireEvent("start_close"):t.fireEvent("start_open")},onComplete:function(t){this.open?(t.fireEvent("complete_close"),t.addClass("dnone")):t.fireEvent("complete_open")}})),e.slide_fx.open=0<e.slide_fx.wrapper.offsetHeight,e.slide_fx.open&&null!=s?s.removeClass(i).addClass(n):null!=s&&s.removeClass(n).addClass(i);n=$(t);0==n.getStyle("height").toInt()&&(e.slide_fx.hide(),n.setStyle("height","auto"));i=e.get("data-show-text"),t=e.get("data-hide-text");return e.slide_fx.open&&null!=i?(null==t&&e.set("data-hide-text",e.get("text")),e.set("text",i),null!=s&&e.grab(s,"top")):e.slide_fx.open||null==t||(null==i&&e.set("data-show-text",e.get("text")),e.set("text",t),null!=s&&e.grab(s,"top")),n.removeClass("dnone"),e.slide_fx.toggle(),!1})},createWordCounts:function(){document.$wc||(document.$wc=new WordCount),this.hasClass("qti-extendedTextInteraction")?document.$wc.load(this.getElements(".qti-candidateResponse")):document.$wc.load(this.getElements(".wordcount textarea, textarea.wordcount, .wordcount .qti-extendedTextInteraction .qti-candidateResponse"))},showMessage:function(t,e,i){var n=this.get("lastMessageShown"),s=this.get("lastMessageShownDate");if(n&&n===t&&Date.now()-s<1e3)return this;this.set("lastMessageShown",t),this.set("lastMessageShownDate",Date.now()),e=e||"success";n={width:"60%",height:"auto",left:"20%","z-index":1e5,position:"fixed",top:"40%",transform:"translate(0, -40%)"},s="imlist";i&&(n.top=i.getPosition().y,n.transform="",n["max-width"]=i.getSize().x,s="imcustomlist");var o=(o=$(s))||new Element("div#"+s,{styles:n}).inject($$("body")[0]),a=new Element("div.imitem").grab(new Element("div.infobox."+e+"_box").grab(new Element("p").set("text",t))).inject(o).setStyle("opacity",0);return new Fx.Tween(a,{duration:300,link:"chain"}).chain(function(){this.start("opacity",1)},function(){this.callChain.delay(3e3,this)},function(){this.start("opacity",0)},function(){this.start("height",0)},function(){a.destroy(),0==o.getElements("div.imitem").length&&o.destroy()}).callChain(),this},bind_fillpanels:function(i){void 0===i&&(i=!0);function t(n){var s=o(n);!1!==s&&0<s&&n.each(function(t){var e=t.getStyle("overflow");t.setStyle("overflow","hidden");var i=t.getComputedSize({mode:"vertical"}),i=s/n.length-(i.computedTop+i.computedBottom)+1;t.setStyle("height",i),t.setStyle("overflow",e),t.fireEvent("fillpanelResize",[i])})}var e,n,o=function(t){try{var e=("auto"==this.getStyle("height")?this.getParent():this).offsetHeight;return t.setStyle("height",null),i=void 0===i||i,this.getChildren("*:not(.fillpanel)").each(function(t){e-=t.scrollHeight}),t.each(function(t){t.getParent()!==this&&(e+=t.scrollHeight)},this),e}catch(t){return!1}}.bind(this),s=this.getElements(".fillpanel");t(s),i&&(e=!1,n=function(){e&&clearTimeout(e),null!==this.bind_fillpanels&&(e=t.delay(250,this,[s]))}.bind(this),s.each(function(t){t.store("$resize_function",n)}),window.addEvent("resize",n),this.addEvent("fillpanelResize",n))},unbind_fillpanels:function(){this.getElements(".fillpanel").each(function(t){var e=t.retrieve("$resize_function",!1);!1!==e&&(window.removeEvent("resize",e),t.eliminate("$resize_function")),this.removeEvents("fillpanelResize")},this)},check_media:function(s){this.getElements(".check_media").each(function(n){var t=n.get("data-check-url");t&&new $Request.JSON({initialDelay:1500,delay:1500,url:t,method:"get",onSuccess:function(t){var e,i;"available"==t.status?(this.stopTimer(),s?s(n,t):(e=n.getParent("div.media_block"),void 0!==t.block&&!1!==t.block&&e?((i=new Element("div")).set("html",t.block),i.firstChild&&(e.getParent().replaceChild(i.firstChild,e),e.destroy(),i.firstChild&&(i.firstChild.createTooltips(),i.firstChild.fireEvent("update-media")))):("img"==n.get("tag")?(n.set("src",t.url),n.set("width",t.width),n.set("height",t.height)):n.setStyle("background-image",'url("'+t.url+"?new"+Math.round(1e4*Math.random())+'")'),n.removeClass("check_media"),(t=n.getParent("div.media_block"))&&t.hasClass("disabled")&&t.removeClass("disabled"),t&&t.fireEvent("update-media")))):"function"==typeOf(n.getParent)&&n.getParent("body")||this.stopTimer()}}).startTimer()},this)},loadScripts:function(i,n){this.getElements("script").each(function(t){var e=t.get("src");e?(n&&void 0!==document.$required[e]&&delete document.$required[e],document.require([{url:e,type:"js"}],i||function(){return!0})):Browser.exec(t.get("html"))})},cleanActions:function(){this.getElements("form").each(function(t){t=t.get("data-formactions");t&&(t=t.split(",")).each(function(t){void 0!==window.$actions[t]&&(window.$actions[t].destroy(),delete window.$actions[t])})})},startCountdown:function(n){var s=this.getElement(".hours"),o=this.getElement(".minutes"),a=this.getElement(".seconds");n=void 0!==n&&n;var r=function(){var t,e=0,i=0;if((e=a.get("text").toInt()-1)<0){if(!o)return clearInterval(r),void(n?window.location.reload():this.fireEvent("countdown"));if((i=o.get("text").toInt()-1)<0){if(!s)return clearInterval(r),void(n?window.location.reload():this.fireEvent("countdown"));if((t=s.get("text").toInt()-1)<0)return clearInterval(r),void(n?window.location.reload():this.fireEvent("countdown"));s.set("text",(t+"").lead(2)),i=59}o.set("text",(i+"").lead(2)),e=59}s&&!(s.get("text").toInt()<=0)||(i=a.getParent()).hasClass("no_display")&&(i.removeClass("no_display"),s.getParent().addClass("no_display")),a.set("text",(e+"").lead(2))}.periodical(1e3,this)},fill_horizontal:function(){var e=0;this.getSiblings().each(function(t){"none"!=t.getStyle("display")&&"absolute"!=t.getStyle("position")&&(t=t.getComputedSize({mode:"horizontal",styles:["padding","border","margin"]}),e+=t.totalWidth)}.bind(this));var t=this.getComputedSize({mode:"horizontal"}),t=this.getParent().getComputedSize({mode:"horizontal"}).width-e-t.computedLeft-t.computedRight;this.setStyle("width",Math.max(t,0))},getSafeSize:function(){var t,e=this.getSize();return 0==e.y&&(t=this.getStyle("height").toInt(),isNaN(t)||(e.y=t)),0==e.x&&(t=this.getStyle("width").toInt(),isNaN(t)||(e.x=t)),e},fitImages:function(){this.getElements("img").each(function(t){for(var e,i,n=t,s=n.getParent();!1!==s&&"block"!==s.getStyle("display");)s=(n=s).getParent();!s||(e=s.offsetWidth)<(i=t.get("width"))&&(t.setStyle("width",i*(i=e/i)),t.setStyle("height",t.get("height")*i))})}}),"undefined"!=typeof MutationObserver&&(t=new MutationObserver(function(t){Object.each(t,function(t){"childList"===t.type&&Object.each(t.removedNodes,function(t){if(t.nodeType===Node.ELEMENT_NODE){if(t.__tooltip)try{t.__tooltip.dispose()}catch(t){}t=t.querySelectorAll(".tooltip, .formtip");Object.each(t,function(t){if(t.__tooltip)try{t.__tooltip.dispose()}catch(t){}}),Array.prototype.forEach.call(document.querySelectorAll(".tooltip[role=tooltip], .formtip[role=tooltip]"),function(t){0==document.querySelectorAll(".tooltip[aria-describedby="+t.id+"], .formtip[aria-describedby="+t.id+"]").length&&t.parentNode&&t.parentNode.removeChild(t)})}})})}),window.addEvent("domready",function(){void 0!==window.$disableMutationObserver&&!1!==window.$disableMutationObserver||t.observe(document.body,{childList:!0,subtree:!0})})),Function.implement({atomic:function(t,e,i,n){window.$locks&&void 0!==window.$locks||(window.$locks={}),n=n||{},e=e||window;var s,o=!0;if(instanceOf(t,Array)){for(s in t)if(window.$locks[t[s]]){o=!1;break}}else o=!window.$locks[t];if(o||n.is_running){window.$locks[t]=!0,n.is_running=!0;try{this.apply(e,Array.convert(i))}catch(t){typeOf(window.trigger_error)}n.is_running=!1}else this.atomic.delay(25,this,[t,e,i,n])},release:function(t){void 0!==t&&(window.$locks[t]=!1)}}),Function.extend({atomic:function(t,e,i,n){t.atomic(e,i,n,{})}}),Array.implement({equals:function(t){if(!t)return!1;if(this.length!==t.length)return!1;for(var e=0,i=this.length;e<i;e++)if(this[e]instanceof Array&&t[e]instanceof Array){if(!this[e].equals(t[e]))return!1}else if(this[e]!==t[e])return!1;return!0}}),Object.extend({equals:function(t,e){try{for(var i in t){if(typeof t[i]!=typeof e[i])return!1;if(null===t[i]!=(null===e[i]))return!1;switch(typeof t[i]){case"undefined":if(void 0!==e[i])return!1;break;case"object":if(null!==t[i]&&null!==e[i]&&(t[i].constructor.toString()!==e[i].constructor.toString()||!Object.equals(e[i],t[i])))return!1;break;case"function":if("equals"!==i&&t[i].toString()!==e[i].toString())return!1;break;case"array":if(!t[i].equals(e[i]))return!1;default:if(t[i]!==e[i])return!1}}for(var i in e)if(void 0===t[i])return!1}catch(t){return!1}return!0}}),function(){function s(e,i,n){var s,t,o;void 0!==e.url&&void 0!==e.type&&(s=void 0===e["data-src"]?e.url:e["data-src"],void 0===i.$required[s]?"js"==e.type||"javascript"==e.type?i.$required[s]=new Asset.javascript(e.url,{onload:function(){i.$required[s]="loaded",void 0!==e["data-src"]&&i.$required[e.url],n(s)},document:i}):"css"==e.type?(t=new Element("style",{media:"screen",type:"text/css"}).inject(i.head),(o=i).$required[s]=new $Request({method:"get",url:e.url,onSuccess:function(t){o.$required[e.url]="loaded",this.styleSheet?this.styleSheet.cssText=t:this.appendChild(document.createTextNode(t)),n(s)}.bind(t)}),i.$required[s].send()):"file"==e.type&&(i.$required[s]=new $Request({method:"get",url:e.url,onSuccess:function(t){i.$required[s]=t,n(s)}.bind(t)}),i.$required[s].send()):"string"===typeOf(i.$required[s])?n(s):"css"==e.type?i.$required[s].isRunning()?i.$required[s].addEvents({onSuccess:function(){n(s)}}):n(s):i.$required[s].addEvents({load:function(){i.$required[s]="loaded",n(s)},error:function(){alert("Could not load "+e.url)},readystatechange:function(){["loaded","complete"].contains(this.readyState)&&("file"!==e.type&&(i.$required[s]="loaded"),n(s))}}))}window.addEvent("domready",function(){document.preload_assets()}),Document.implement({preload_assets:function(){void 0===this.$required&&(this.$required={},$$("link").each(function(t){[t.get("href"),t.get("data-src"),t.get("src")].each(function(t){t&&(document.$required[t]="loaded")})}),$$("script").each(function(t){[t.get("data-src"),t.get("src")].each(function(t){t&&(document.$required[t]="loaded")})}))},require:function(i,n){Function.atomic(function(){void 0===this.$required&&this.preload_assets();var e=function(t){0==i.length?("string"===typeOf(document.$required[t])&&"loaded"!==document.$required[t]?n(document.$required[t]):n(),Function.release("require")):s(i.shift(),this,e)}.bind(this);s(i.shift(),this,e)},"require",this)},getKeyboard:function(){return void 0===this.$keyboard&&(this.$keyboard=new Keyboard({active:!0})),this.$keyboard},blurAll:function(){var t=new Element("textarea",{styles:{"z-index":-5e3,position:"absolute",top:0}});this.body.grab(t),t.focus(),t.destroy()}})}.call(this),Number.implement({bytes:function(t){t=void 0===t?1:t;var e=Math.floor(Math.log(this+1)/Math.log(1024));return Number.convert(this/Math.pow(1024,e)).round(t)+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][e]}}),Number.prototype.between=function(t,e,i){var n=Math.min(t,e),e=Math.max(t,e);return i?n<=this&&this<=e:n<this&&this<e},String.implement({getLastChar:function(){return this.substr(this.length-1)},parseNumber:function(){var t=this.replace(Locale.get("Number.decimal"),"__decimal__");return null===(t=(t=(t=t.split(Locale.get("Number.group")).join("")).replace("__decimal__",".")).toFloat())||isNaN(t)?0:t},lead:function(t,e){return void 0===e&&(e="0"),this.length<t?this.pad(t,e,"left"):this}}),Array.implement({compare:function(t){if(this.length!==t.length)return!1;for(var e=0;e<t.length;e++){if(this[e].compare&&!this[e].compare(t[e]))return!1;if(this[e]!==t[e])return!1}return!0}}),"undefined"==typeof console&&(console={log:function(){},warn:function(){},dir:function(){},info:function(){},debug:function(){},trace:function(){}})}();var MultipleSelectDisableCheck=new Class({initialize:function(t,e,i){this.select1=t,this.select2=e,this.target=i,this.select1&&this.select2&&(t.addEvent("change",this.check.bind(this)),e.addEvent("change",this.check.bind(this)),this.check())},check:function(){""!=$(this.select1.id).value&&""!=$(this.select2.id).value?this.target&&(this.target.disabled=!1,this.target.getElements("input, select, textarea").set("disabled",!1),(this.target.getParent(".element")||this.target).removeClass("disabled")):this.target&&(this.target.disabled=!0,this.target.getElements("input, select, textarea").set("disabled",!0),(this.target.getParent(".element")||this.target).addClass("disabled"))}}),TrackCheckboxes=new Class({Binds:["print_count","save_cookie_event","checkbox_event","scroll_event"],Implements:[Events],cookie_name:!1,initialize:function(t,e,i,n){if(this.model=t,this.form=$(t),this.count_settings=e,i||(this.cookie_name=t+"_saved_selection"),this.action_on=$(t+"_action_on"),this.action_on&&(this.default_target=this.action_on.get("value"),e=$(t+"_execute")||$$('*[data-form-id="'+t+'"][data-event="submit"]').pick(),this.msdc=new MultipleSelectDisableCheck(this.action_on,$(t+"_action"),e)),this.checkall=$$("#checkall, #"+t+" .checkall").pop(),!this.checkall)throw"Could not find checkall element";this.form.getElements("input[type=checkbox].checksingle").each(function(t){t.set("checked",!1)}),this.checkall.set("checked",!1),this.saved_selection=[],i?(this.selection_storage=i,this.selection_storage.all&&this.saved_selection.push("all"),this.saved_selection.append(this.selection_storage.value)):(this.selection_storage=$(t+"_saved_selection"),this.selection_storage.value&&(this.saved_selection.append(this.selection_storage.value.split(",")),this.update_action_on())),this.load_cookie(),this.checkall.addEvent("click",function(){this.check_all()}.bind(this)),n||this.form.addEvent("click:relay(input[type=checkbox].checksingle)",this.checkbox_event),!1!==this.cookie_name&&this.form.addEvent("click:relay(.pager a)",this.save_cookie_event),this.count_settings&&this.print_count()},tooltip_init:function(){this.ttbox=new Element("div",{class:"tip-text"}),this.tip=new Element("div",{class:"selectedinfotip-wrap",styles:{position:"absolute",top:0,left:0,display:"none","z-index":2e3}}).adopt(this.ttbox).inject(this.form)},destroy:function(){Cookie.dispose(this.cookie_name),this.removeEvents(),this.tooltip_end()},check:function(t){var e=this.saved_selection.indexOf(t+"");0<this.saved_selection.length&&"all"===this.saved_selection[0]?-1!==e&&(this.saved_selection.splice(e,1),this.save()):-1===e&&(this.saved_selection.push(t+""),this.save()),this.form.getElements('input[type=checkbox][value="'+t+'"].checksingle').set("checked",!0)},uncheck:function(t){var e=this.saved_selection.indexOf(t+"");0<this.saved_selection.length&&"all"===this.saved_selection[0]?-1===e&&(this.saved_selection.push(t+""),this.save()):-1!==e&&(this.saved_selection.splice(e,1),this.save()),this.form.getElements('input[type=checkbox][value="'+t+'"].checksingle').set("checked",!1)},tooltip_start:function(t){this.tip||this.tooltip_init(),this.ttbox.empty(),this.ttbox.set("html",t),this.tip.setStyles({display:"block",left:0}),this.tip.setStyle("width","auto"),this.count_settings.tooltip_position?this.tip.setStyles({left:this.count_settings.tooltip_position.left,top:this.count_settings.tooltip_position.top}):(t=this.checkall.getPosition(this.form),this.tip.setStyles({left:t.x+6,top:t.y-this.tip.offsetHeight+3}))},scroll_event:function(t){var e=this.checkall.getPosition(this.form);this.tip.setStyles({left:e.x+6,top:e.y-this.tip.offsetHeight+3})},tooltip_end:function(t){this.tip&&($(this.tip).destroy(),this.tip=!1)},print_count:function(){var t;this.count_settings&&((t=0)==(t=0<this.saved_selection.length&&"all"===this.saved_selection[0]&&void 0!==this.count_settings.total_item_count?this.count_settings.total_item_count-this.saved_selection.length+1:this.saved_selection.length)?(this.tooltip_end(),this.action_on&&(this.action_on.value=this.default_target||"",this.action_on.fireEvent("change"))):this.tooltip_start($I18N.compile(this.count_settings.selected_text,[t])))},save_cookie_event:function(t,e){0==this.saved_selection.length?Cookie.dispose(this.cookie_name):Cookie.write(this.cookie_name,this.saved_selection.join(","))},load_cookie:function(){var t;!1===this.cookie_name||null!==(t=Cookie.read(this.cookie_name))&&""!==t&&(Cookie.dispose(this.cookie_name),this.load_values(t.split(",")))},load_values:function(t){this.saved_selection=t,this.save(),"all"===this.saved_selection[0]&&(this.checkall.checked=!0),this.update()},update:function(t){this.form.getElements("input[type=checkbox].checksingle").each(function(t){t.set("checked",this.checkall.checked===(-1===this.saved_selection.indexOf(t.value))),t.checked&&(this.update_row(t),this.update_action_on())},this),void 0!==t&&(this.count_settings.total_item_count=t)},save:function(){"element"===typeOf(this.selection_storage)?(this.selection_storage.value=this.saved_selection.join(","),this.selection_storage.fireEvent("change"),1===this.saved_selection.length&&"all"===this.saved_selection[0]&&(this.checkall.checked=!0)):(this.selection_storage.value=this.saved_selection.slice(0),0<this.saved_selection.length&&"all"===this.saved_selection[0]?(this.selection_storage.value.splice(0,1),this.selection_storage.all=!0,1===this.saved_selection.length&&(this.checkall.checked=!0)):this.selection_storage.all=!1,this.fireEvent("update")),this.print_count()},check_all:function(){this.form.getElements("input[type=checkbox].checksingle").each(function(t){t.set("checked",this.checkall.checked),this.update_row(t)},this),this.saved_selection=this.checkall.checked?["all"]:[],this.save(),this.checkall.checked&&this.update_action_on(),this.print_count()},checkbox_event:function(t,e){var i;(0<this.saved_selection.length&&"all"===this.saved_selection[0])!=e.checked?-1==this.saved_selection.indexOf(e.value)&&this.saved_selection.push(e.value):-1!=(i=this.saved_selection.indexOf(e.value))&&this.saved_selection.splice(i,1),this.save(),this.update_row(e),e.checked&&this.update_action_on(),e.checked||(this.checkall.checked=!1),this.print_count()},update_row:function(t){var e;!t.checked||(e=t.getParent(".datatablecontainer"))&&(!(e=e.retrieve("instance"))||(t=e.getRow(t.get("value")))&&t.select())},update_action_on:function(){this.action_on&&this.action_on.value===this.default_target&&(this.action_on.value="selected",this.action_on.fireEvent("change"))}}),ListComponentTracker=new Class({Extends:TrackCheckboxes,Binds:["row_event"],initialize:function(t,e){this.parent(t,e),this.form.getElements("tbody tr").each(function(t){t.getChildren(".collist_content").hide()}),this.form.addEvent("click:relay(tbody tr)",this.row_event)},row_event:function(t,e){"a"==t.target.get("tag")||null!==t.target.getParent("a")||"input"==t.target.get("tag")||t.target.hasClass("icon")||(e=e.getElement("input[type=checkbox]"))&&(t.preventDefault(),t.stopPropagation(),e.set("checked",!e.checked),this.checkbox_event("checkbox_event",e),this.update_row(e))},update_row:function(t){var e=t.getParent("tr");t.checked?e.addClass("checked"):e.removeClass("checked")},submit_event:function(t){return t.stop(),!1}}),I18N=new Class({Implements:[Options,Events],options:{resource_url:"/i18n/",locale:"en-US"},resources:{},message_formatter:!1,initialize:function(t){this.setOptions(t)},set_locale:function(t,e){this.options.locale===t||"en-US"!=t&&"nl-NL"!=t||(t=$i18n_javascript+t+"/_init.js",delete document.$required[t],document.require([{url:t,type:"js"}],e))},translate:function(t,e){var i,n,s="javascript";return this.load_resource(s),void 0!==this.resources[s][t]&&(t=this.resources[s][t]),"array"===typeOf(e)&&(i={},n=0,e.each(function(t){i[n]=t,n++}),e=i),this.compile(t,e)},lookup:function(t,e){return this.load_resource(e=void 0!==e&&e?e:"javascript"),t=void 0!==this.resources[e][t]?this.resources[e][t]:t},compile:function(e,t){try{var i=new IntlMessageFormat(e,this.options.locale)}catch(t){return e}return i.format(t)},t:function(t,e){return this.translate(t,e)},load_resource:function(e,t){e=e.toLowerCase(),t=void 0!==t&&1==t,void 0===this.resources[e]&&new $Request.JSON({url:this.options.resource_url+e,method:"get",onSuccess:function(t){this.resources[e]=t}.bind(this),onFailure:function(){},async:t,timeout:100}).send()}});String.implement({translate:function(){return this}});var GlobalState=new Class({$parser:null,listening:!1,$requests:{},unload_event:!1,__load_hashparser:function(){window.$hashparser||(window.$hashparser=new HashParser,this.$parser=window.$hashparser)},__load_unloader:function(){this.unload_event=!0,window.addEvent("beforeunload",function(){Object.each(this.$requests,function(t){t.isRunning()&&t.cancel()})}.bind(this))},startListening:function(){var t;this.listening||(this.__load_hashparser(),t=["StateUpdate","StateAdd","StateDelete","StateChange"],["before","on"].each(function(e){t.each(function(t){this[e+t]&&window.$hashparser.addEvent(e+t,this["$"+e+t]=this[e+t].bind(this))},this)},this),this.listening=!0)},stopListening:function(){var t;this.listening&&(t=["StateUpdate","StateAdd","StateDelete","StateChange"],["before","on"].each(function(e){t.each(function(t){this["$"+e+t]&&window.$hashparser.removeEvent(e+t,this["$"+e+t])},this)},this),this.listening=!1)},getState:function(){return window.$hashparser||this.__load_hashparser(),Object.clone(window.$hashparser.getState())},getStateValue:function(t,e){return window.$hashparser||this.__load_hashparser(),this.options&&void 0!==this.options.state_prefix&&(t=this.options.state_prefix+t),window.$hashparser.getStateValue(t,e)},setStateValue:function(){if(window.$hashparser||this.__load_hashparser(),this.options&&void 0!==this.options.state_prefix)for(var t=0;t<arguments.length;t+=2)arguments[t]=this.options.state_prefix+arguments[t];return window.$hashparser.setStateValue.apply(window.$hashparser,arguments)},stateToString:function(){return window.$hashparser||this.__load_hashparser(),window.$hashparser.stateToString(this.state)},setState:function(t){return window.$hashparser||this.__load_hashparser(),window.$hashparser.loadState(t)},unsetStateValue:function(){window.$hashparser||this.__load_hashparser();var t=Array.convert(arguments);return this.options&&void 0!==this.options.state_prefix&&(t=t.map(function(t){return this.options.state_prefix+t},this)),window.$hashparser.unsetStateValue.apply(window.$hashparser,t)},json:function(e,i,t,n,s){window.$hashparser||this.__load_hashparser(),this.unload_event||this.__load_unloader();var o=this,a=t&&t.atomic_key||String.uniqueID();this.$requests[a]&&(this.$requests[a].isRunning()&&this.$requests[a].cancel(),delete this.$requests[a]);t=Object.merge({url:e,method:"get",onSuccess:function(t){if(void 0===t.__location__){if(t.state&&("array"!==typeOf(t.state)||0!==t.state.length)){var e=o.getState();Object.merge(e,t.state);try{o.setState(e)}catch(t){}}t.error_url&&(document.location=t.error_url+"?"+Object.toQueryString({request:document.location.pathname}),delete o.$requests[a]),void 0!==t.__messages__&&void 0!==document.body.showMessage&&Object.each(t.__messages__,function(t,e){t.each(function(t){document.body.showMessage(t,e)})}),i&&i(t),delete o.$requests[a]}else window.location=t.__location__},onFailure:function(t){n?n():o.onJSONError("","Request to "+e+" failed.",{status:t?t.status:"-",statusText:t?t.statusText:"-",readyState:t?t.readyState:"-"},!!s&&a)},onError:function(t,e){n?n():o.onJSONError(t,"Invalid json: "+e,{},!!s&&a)},onTimeout:function(t){try{this.cancel&&this.cancel()}catch(t){}n?n():o.onJSONError("","Request timeout on "+e,{status:t?t.status:"-",statusText:t?t.statusText:"-",readyState:t?t.readyState:"-"},!!s&&a)},timeout:15e3,data:this.getState()},t);this.$requests[a]=new $Request.JSON(t);t=this.$requests[a].send();return t&&window.fireEvent("request"),t},cancelRequests:function(){Object.each(this.$requests,function(t,e){return t.isRunning()&&t.cancel(),"object"===typeOf(this.$requests)&&(delete this.$requests[e],!0)})},cancelRequest:function(t){this.$requests[t]&&(this.$requests[t].isRunning()&&this.$requests[t].cancel(),delete this.$requests[t])},onJSONError:function(t,e,i,n){var s,o;void 0!==(e="string"==typeof e?e:"Unknown error.")&&"function"==typeof window.trigger_error?window.trigger_error("JSON error: "+e):"undefined"!=typeof Raven&&Raven.captureMessage("JSON error",{level:"warning",extra:{error:e,response:t,errorinfo:i}}),void 0===window.errorstate&&(this.fireEvent("json_error",e),s=this,window.errorstate=!0,o=new ContentWindow({width:400,height:150,id:"errorwindow",class:"errorwindow",zIndex:1e5,modalOptions:{destroyOnClick:!1,opacity:n?.5:.8,id:"errormodal"},buttons:{},close_button:!1,title:$I18N.t("Network error")},{loadMethod:"callback",callback:function(){if(n){t=new Element("div.infobox.info_box",{styles:{"margin-bottom":10}}).grab(new Element("p",{html:$I18N.t("There is currently no working internet connection. Click the button below to try again.")})),e=new Element("p.tcenter").grab(new Element("a.button",{href:"#",events:{click:function(){navigator.onLine&&(delete window.errorstate,o.close(),s.$requests[n].send())}.bind(this)},html:$I18N.t("Retry")}));return new Element("div.popupcontent").grab(t).grab(e)}var t=new Element("div.infobox.info_box",{styles:{"margin-bottom":10}}).grab(new Element("p",{html:$I18N.t("We have encountered a hickup... Your current action can not be completed due to an connection problem in the communication with the server. To continue, please reload the page by clicking on the link below.")})),e=new Element("p.tcenter").grab(new Element("a.button.destructive",{href:"#",events:{click:function(){window.location.reload()}},html:$I18N.t("Please reload the page")}));return new Element("div.popupcontent").grab(t).grab(e)},panel:"errorwindow_panel"}))}});Document.implement({json:function(){}});var HashParser=new Class({Implements:[Events,Chain],state:null,history:null,unload:!0,initialize:function(){this.state={},null==this.history&&(this.history=new HashListener,this.history.addEvent("hashChanged",this.onHashChange.bind(this)),"onhashchange"in window&&(void 0===document.documentMode||7<document.documentMode)?this.history.checkHash():this.history.start(),window.addEvent("unload",function(){this.unload=!0}.bind(this)))},onHashChange:function(t,e){var n=!0===e?"before":"on";e=void 0!==e&&e,"!"==t.substr(0,1)&&(t=t.substr(1));var s,o,a=Object.clone(this.state);return 0<t.length?(s=t.parseQueryString(),e||(this.state=s),0!=a.length&&(o=[],Object.each(a,function(t,e){s[e]||(this.chain(function(){this.fireEvent(n+"StateDelete",[e,s]),this.callChain()}.bind(this)),o.push(e))},this),Object.each(s,function(t,e){var i;a[e]&&void 0!==a[e]?(i=a[e])&&instanceOf(i,Object)&&instanceOf(t,Object)?Object.equals(i,t)||(this.chain(function(){this.fireEvent(n+"StateUpdate",[e,s]),this.callChain()}.bind(this)),o.push(e)):i&&i!==t&&(this.chain(function(){this.fireEvent(n+"StateUpdate",[e,s]),this.callChain()}.bind(this)),o.push(e)):(this.chain(function(){this.fireEvent(n+"StateAdd",[e,s]),this.callChain()}.bind(this)),this.chain(function(){this.fireEvent(n+"StateUpdate",[e,s]),this.callChain()}.bind(this)),o.push(e))},this)),this.chain(function(){this.fireEvent(n+"StateChange",[o,s]),this.callChain()}.bind(this)),this.callChain()):0!=Object.getLength(a)&&(s={},o=[],e||(this.state=s),Object.each(a,function(t,e){this.chain(function(){this.fireEvent(n+"StateDelete",[e,s]),this.callChain()}.bind(this)),o.push(e)},this),this.chain(function(){this.fireEvent(n+"StateChange",[o,s]),this.callChain()}.bind(this)),this.callChain()),this.log("Changing state to "+t),s},setStateValue:function(){for(var t,e,i=this.getState(),n=0;n<arguments.length;n+=2)t=arguments[n],null!=(e=arguments[n+1])&&0!=e.length?i[t]=e:delete i[t];var s="!"+Object.toQueryString(i),s="!"+Object.toQueryString(this.onHashChange(s,!0));this.history.updateHash(s)},loadState:function(t){t="!"+Object.toQueryString(t),t="!"+Object.toQueryString(this.onHashChange(t,!0));this.history.updateHash(t)},unsetStateValue:function(){for(var t=this.getState(),e=0;e<arguments.length;e++)delete t[arguments[e]];var i="!"+Object.toQueryString(t),i="!"+Object.toQueryString(this.onHashChange(i,!0));this.history.updateHash(i)},getStateValue:function(t,e){var i=this.getState();return void 0!==i[t]?i[t]:void 0!==e&&e},stateToString:function(){return Object.toQueryString(this.getState())},getState:function(){var t=this.history.getHash();return("!"==t.substr(0,1)?t.substr(1):t).parseQueryString()},log:function(t){void 0!==window.$error_log&&window.$error_log.log(t)}}),Monitor=new Class({Implements:[Options,Events],Binds:["onChange","_onChange"],options:{throttle:150},form:!1,initial_state:!1,is_changed:!1,current:!1,timeout:!1,initialize:function(t,e){this.form=$(t),this.form&&(this.form.store("monitor",this),this.setOptions(e),this.initial_state=this.current=JSON.encode(this.serializeForm()),this.form.getElements("input,textarea").addEvent("keyup",this.onChange),this.form.getElements("input[type=checkbox],input[type=radio]").addEvents("click",this.onChange),this.form.getElements("input[type=text],textarea,select").addEvent("keyup",this.onChange),this.form.getElements("select,input,textarea").addEvent("change",this.onChange),this.form.addEvent("submit",function(){this.current=JSON.encode(this.serializeForm())}.bind(this)),this.form.addEvent("update",function(){this.initial_state=this.current=JSON.encode(this.serializeForm()),this.form.getElements("input,textarea").addEvent("keyup",this.onChange),this.form.getElements("input[type=checkbox],input[type=radio]").addEvents("click",this.onChange),this.form.getElements("input[type=text],textarea,select").addEvent("keyup",this.onChange),this.form.getElements("select,input,textarea").addEvent("change",this.onChange)}.bind(this)),"undefined"!=typeof tinyMCE&&(tinyMCE.each(tinyMCE.editors,function(t){this.registerTinyMCE(t)}.bind(this)),tinyMCE.onAddEditor.add(function(t,e){this.registerTinyMCE(e),$(e.id).addEvent("tinyMCEloaded",function(){e.save(),this.initial_state=this.current=JSON.encode(this.serializeForm())}.bind(this))}.bind(this))))},registerTinyMCE:function(t){var e=t.id;0<this.form.getElements("#"+e).length&&(t.onChange.add(this.onChange),t.onKeyUp.add(this.onChange))},serializeForm:function(){var t=this.form.getElements("input[type=button]:not(input:disabled)");t.each(function(t){t.disabled=!0}),"undefined"!=typeof tinyMCE&&tinyMCE.each(tinyMCE.editors,function(t){var e=t.id;0<this.form.getElements("#"+e).length&&t.save()}.bind(this));var e,i,n=this.form.toQueryString().parseQueryString();for(e in n)"array"==typeOf(n[e])&&"[]"==e.substring(e.length-2)&&(i=n[e],delete n[e],n[e.substring(0,e.length-2)]=i);return t.each(function(t){t.disabled=!1}),n},onChange:function(){!1!==this.timeout&&clearTimeout(this.timeout),this.timeout=this._onChange.delay(this.options.throttle)},_onChange:function(){this.timeout=!1;var t=JSON.encode(this.serializeForm());this.current!==t&&(this.current=t,this.is_changed=this.current!==this.initial_state,this.fireEvent("change",[this.is_changed,this]))},isChanged:function(){return this._onChange(),this.is_changed},destroy:function(){this.timeout&&clearTimeout(this.timeout);try{this.form.eliminate("monitor",this),this.form.getElements("input,textarea").removeEvent("keyup",this.onChange),this.form.getElements("input[type=checkbox],input[type=radio]").removeEvents("click",this.onChange),this.form.getElements("input[type=text],textarea,select").removeEvent("keyup",this.onChange),this.form.getElements("select,input,textarea").removeEvent("change",this.onChange),"undefined"!=typeof tinyMCE&&tinyMCE.each(tinyMCE.editors,function(t){var e=t.id;0<this.form.getElements("#"+e).length&&(t.onChange.remove(this.onChange),t.onKeyUp.remove(this.onChange))}.bind(this))}catch(t){}delete this.form}});Monitor.isChanged=function(t){if(!(t=$(t)))return!1;t=t.retrieve("monitor",!1);return!1!==t&&t.is_changed};var $windows=[],Window=new Class({Implements:[Options,Events],modal:!1,modal_loader:!1,element:!1,grid:null,container:null,parent:null,ticking:!1,options:{height:"auto",width:600,min_width:100,id:"window",parent:"body",close_button:!0,modalOptions:{enabled:!0,color:"#000000",id:null,opacity:.6,destroyOnClick:!0},margin:{top:75,bottom:20,left:20,right:20},class:"normalwindow",onClose:function(){},zIndex:"top",grid:{},layout:!1,hidden:!0},getDefaultLayout:function(){return{window_column:{width:"fill",panelSpacing:0,panels:[{id:"window_panel",column:"window_column",height:"auto",animate:!1,styles:{padding:10}}]}}},defaultContentOptions:{loadMethod:!1,url:"",layout:!1,content:"&nbsp;",panel:"window_panel",controller:!1,controllerAction:"run",controllerActionParams:[],callback:!1,params:{}},initialize:function(t,e){this.setOptions(t),$windows.push(this),this.createModal(),this.createWindow()?(this.createKeyboard(),"auto"!=this.options.height&&this.doWindowResize(),this.load(e),this._windowResize=this.onWindowResize.bind(this),window.addEvent("resize",this._windowResize)):this.destroy()},load:function(t){var e;!1!==(t=Object.merge({},this.defaultContentOptions,t)).loadMethod&&(t.layout&&(this.grid.reset(),this.grid.loadConfig(t.layout)),e=this.grid.panels[t.panel||this.options.id+"_panel"],"json"==t.loadMethod?e.loadURL(t.url,t.params,t.callback):"callback"==t.loadMethod?e.setHTML(t.callback()):"controller"==t.loadMethod&&t.controller?this.grid.loadController(t.controller,t.controllerAction,t.controllerActionParams):e.setHTML(t.content),"auto"==this.options.height&&this.doWindowResize(!0))},createWindow:function(){if($(this.options.id))return"function"==typeOf(window.trigger_error)&&window.trigger_error("A window with ID "+this.options.id+" already exists..."),!1;this.parent="element"==typeOf(this.options.parent)?this.options.parent:$$(this.options.parent)[0],"relative"!=this.parent.getStyle("position")&&this.parent!==document.body&&this.parent.setStyle("position","relative");var e=2500;"top"===this.options.zIndex?$$("div.window, div.clicktip-wrap").each(function(t){e=Math.max(t.getStyle("z-index").toInt()+75,e)}):e=this.options.zIndex,this.element=new Element("div#"+this.options.id+".window",{styles:{"z-index":e,position:"fixed",top:0,right:0,bottom:0,left:0,margin:"auto"}}).addClass(this.options.class).inject(this.parent,"bottom"),this.options.hidden&&this.element.addClass("hidden"),this.element.store("instance",this);var t={width:"%"==(this.options.width+"").substring(this.options.width.length-1)?this.parent.offsetWidth*this.options.width.toInt()/100:new String(this.options.width).toInt()+"px",height:"auto"==this.options.height?"auto":new String(this.options.height).toInt()+"px"};return this.element.setStyles(t),"auto"==this.options.height&&this.element.addClass("autoheight_window"),this.grid=new Grid(this.element,Object.merge(this.options.grid,{relativeTo:this.element})),this._contentUpdate=this.onContentUpdate.bind(this),this.grid.addEvent("onContentUpdate",this._contentUpdate),this.grid.loadConfig(this.options.layout||this.getDefaultLayout()),this.grid.addEvent("onFormSubmit",function(t,e,i){this.fireEvent("onFormSubmit",[t,e,i])}.bind(this)),this.grid.addEvent("onLinkClick",function(t,e){this.fireEvent("onLinkClick",[t,e])}.bind(this)),this.options.close_button&&(this.close_button=new Element("a.close_button[href=#]",{title:$I18N.t("Close window"),styles:{"z-index":e+20}}).addEvent("click",function(t){t.preventDefault(),this.fireEvent("cancel"),this.destroy()}.bind(this)).inject(this.element),this.close_button.grab(new Element("span.fas.fa-times")),this.element.createTooltips()),!0},createModal:function(){var t,e,i;this.options.modalOptions.id&&$(this.options.modalOptions.id)||this.options.modalOptions.enabled&&(t=this.options.modalOptions,e="element"==typeOf(this.options.parent)?this.options.parent:$$(this.options.parent)[0],i=2500,"top"===this.options.zIndex?$$("div.window, div.clicktip-wrap").each(function(t){i=Math.max(t.getStyle("z-index").toInt()+75,i)}):i=this.options.zIndex,this.modal=new Element("div"+(this.options.modalOptions.id?"#"+t.id:"")+".modal").inject(e).setStyles({width:"100%",height:"100%",position:"fixed",left:0,top:0,"z-index":i,"background-color":t.color,opacity:0,transition:"opacity 0.5s ease"}),this.options.hidden&&(this.modal_loader=new Element("div"+(this.options.modalOptions.id?"#"+t.id:"")+"-loader.spinner.spinnerabs").inject(this.modal).setStyles({"z-index":i+5})),function(){void 0!==this.modal.setStyle&&this.modal.setStyle("opacity",t.opacity)}.bind(this).delay(20,this),this.modal.addEvent("click",this.onModalClick.bind(this)))},createKeyboard:function(){this.keyboard=new Keyboard({defaultEventType:"keyup",events:{esc:function(t){(this.options.close_button||this.options.modalOptions.destroyOnClick)&&("input"==t.target.get("tag")&&"text"==t.target.get("type")||"textarea"!=t.target.get("tag")&&this.close())}.bind(this),"keydown:backspace":this.cancel_backspace.bind(this),"keyup:backspace":this.cancel_backspace.bind(this)}}),document.getKeyboard().manage(this.keyboard),this.keyboard.activate()},cancel_backspace:function(t){if(!("input"==t.target.get("tag")&&["text","password","search","email","url","tel","number","range","date","month","week","time","datetime","datetime-local","color"].contains(t.target.get("type"))||["akit-exercise-editor","textarea"].contains(t.target.get("tag"))))return t.preventDefault(),t.stop(),!1},hide:function(){this.element.addClass("hidden")},unhide:function(){this.element.removeClass("hidden"),0!=this.modal_loader&&(this.modal_loader.destroy(),this.modal_loader=!1)},hidden:function(){return this.element.hasClass("hidden")},destroy:function(){this.fireEvent("onClose"),this.modal&&(this.modal.destroy(),this.modal=!1),this.grid&&(this.grid.removeEvent("onContentUpdate",this._contentUpdate),this.grid.destroy(),delete this.grid),void 0!==this.keyboard&&(this.keyboard.relinquish(),this.keyboard.isActive()&&this.keyboard.deactivate(),document.getKeyboard().drop(this.keyboard),delete this.keyboard),this.element&&(window.removeEvent("resize",this._windowResize),this.element.removeEvents(),this.element.destroy(),delete this.element)},close:function(){this.destroy()},doWindowResize:function(t){var e,i,n,s,o,a,r,l;this.element&&(e={},a="body"==this.options.parent||this.options.parent===document.body?window.getSize():this.parent.getScrollSize(),e.x=a.x-(this.options.margin.left+this.options.margin.right),e.y=a.y-(this.options.margin.top+this.options.margin.bottom),r=this.element.getComputedSize(),e.x=e.x-(r.totalWidth-r.width),e.y=e.y-(r.totalHeight-r.height),i=(i=(l="%"==(i=this.options.width+"").getLastChar())?this.parent.offsetWidth*this.options.width.toInt()/100:i)>e.x?e.x:i,l&&(i=Math.max(this.options.min_width,i)),s=0,this.title&&"absolute"!==this.title.getStyle("position")&&(s=this.title.getSize().y),(s=(l=r=a=o="auto")==this.options.height?(n=0,Object.each(this.grid.columns,function(t){t=t.getContentHeight(!0);n<t&&(n=t)}),Math.min(e.y,n+s)):(instanceOf(this.options.height,String)&&"%"==this.options.height.getLastChar()&&(this.height_percentage=this.options.height.toInt()/100),void 0!==this.height_percentage&&(this.options.height=e.y*this.height_percentage),Math.min(e.y,this.options.height)))==e.y&&(o=this.options.margin.top,a=this.options.margin.bottom),i==e.x&&(r=this.options.margin.left,l=this.options.margin.right),this.element.setStyles({width:new String(i).toInt()+"px",height:new String(s).toInt()+"px","margin-top":o,"margin-left":r,"margin-bottom":a,"margin-right":l}),this.grid.resize(),this.grid.redrawColumns(),l=!1,this.element.hasClass("hidden")&&(this.element.removeClass("hidden"),l="hidden"),!1!==l&&this.element.addClass(l),this.ticking=!1)},onWindowResize:function(){this.ticking||requestAnimFrame(function(){this.doWindowResize()}.bind(this)),this.ticking=!0},onModalClick:function(){this.options.modalOptions.destroyOnClick&&(this.fireEvent("cancel"),this.destroy())},onContentUpdate:function(t){this.unhide(),"auto"==t.options.height&&"auto"==this.options.height&&this.doWindowResize()}});Window.extend({alert:function(t,e,i){return new ContentWindow({title:t},e="string"==typeof e?{content:e}:e,i=void 0===i?"content":i)}});var ContentWindow=new Class({Extends:Window,getDefaultLayout:function(){return{window_column:{width:"fill",panels:[{id:"window_panel",column:"window_column",height:"auto",background:"#ffffff",border:"",animate:!1,autoload_title:!1,loadMethod:!1,styles:{padding:0}}]}}},options:{title:!1,class:!1,height:"auto",buttons:{cancel:{label:function(){return $I18N.t("Close")},"data-event":"close",class:"destructive fright"}}},createWindow:function(){var t=this.parent();return t&&!1!==this.options.title&&this.setTitle(this.options.title),t},initialize:function(t,e,i){this.options.class=void 0===i?"contentwindow":i+"window";i=this.getDefaultLayout();(void 0!==t.height&&"auto"!=t.height||void 0===t.height&&"auto"!=this.options.height)&&(i.window_column.panels[0].height="fill");void 0===t.id&&(t.id=this.options.id),t.layout||(t.layout={},t.layout[t.id+"_column"]={width:"fill",panels:i.window_column.panels},t.layout[t.id+"_column"].panels[0].column=t.id+"_column",t.layout[t.id+"_column"].panels[0].id=t.id+"_panel",t.layout[t.id+"_column"].panels[0].buttons=(void 0!==t.buttons?t:this.options).buttons),this.parent(t,e),null!=this.grid&&(this.grid.addEvent("onJSON",function(t){var e;t.intro_trigger&&void 0!==document.introHelper&&document.introHelper.trigger(t.intro_trigger),!0===t.close&&this.close(),!0!==t.reload&&void 0===t.location||(this.options.modalOptions.destroyOnClick=!1,"element"==typeOf(this.close_button)&&this.close_button.destroy()),void 0!==t.close&&t.close||void 0!==t.title&&this.setTitle(t.title),void 0!==t.windowtype&&this.element&&(this.element.removeClass("warningwindow").removeClass("errorwindow").removeClass("infowindow"),this.element.addClass(t.windowtype).addClass("contentwindow")),this.fireEvent("onJSON",[t]),void 0===t.width&&void 0===t.height||(e=!1,void 0!==t.width&&t.width!=this.options.width&&(this.options.width=t.width,e=!0),void 0!==t.height&&t.height!=this.options.height&&(this.options.height=t.height,e=!0),e&&this.element&&this.doWindowResize(!0))}.bind(this)),Object.each(this.grid.panels,function(t){t.addEvent("button",function(t){"close"==t&&this.destroy()}.bind(this))}.bind(this)))},setTitle:function(t){void 0===this.title||!1===this.title?(this.title=new Element("div.windowtitle").set("html",t),this.element.grab(this.title,"top")):this.title.set("html",t)}}),FixedContentWindow=new Class({Extends:ContentWindow,getDefaultLayout:function(){return{window_column:{width:"fill",panels:[{id:"window_panel",column:"window_column",height:"fill",background:"#ffffff",border:"",animate:!1,autoload_title:!1,styles:{padding:0}}]}}}}),ActionWindow=new Class({Extends:Window,options:{close_button_color:"white"},getDefaultLayout:function(){return{window_column:{width:"fill",panels:[{id:"window_panel",column:"window_column",height:"fill",background:"#068a00",border:"1px solid #ffffff",color:"#ffffff",animate:!1}]}}}}),AlertWindow=new Class({Extends:ContentWindow,options:{}}),ErrorWindow=new Class({Extends:ContentWindow,options:{},initialize:function(t){this.messages=t,this.parent({width:450,class:"errorwindow"},{loadMethod:"callback",callback:this.loadErrors.bind(this)}),this.setTitle($I18N.t("Messages"))},loadErrors:function(){var e='<ul class="messagelist">';return this.messages.each(function(t){e+='<li class="error"><span class="red-icon fas fa-exclamation-triangle">&nbsp;</span>'+t+"</li>"}),e+="</ul>"}}),SelectionWindow=new Class({Extends:ContentWindow,options:{selected_ids:[]}});function renderErrorWindow(t,e,i,n,s,o){return new ContentWindow({id:t,title:e,class:"errorwindow",zIndex:1e5,close_button:!1,height:o||"auto",buttons:{},modalOptions:{destroyOnClick:!1}},{panel:t+"_panel",loadMethod:"callback",callback:function(){var t=new Element("div.infobox.error_box").grab(new Element("p",{html:i}));if(!n||!s)return new Element("div.popupcontent").grab(t);var e=new Element("p.tcenter").grab(new Element("a.button",{html:n,href:"#",events:{click:s}}));return new Element("div.popupcontent").grab(t).grab(e)}})}function renderInfoWindow(t,e,i,n,s,o){return new ContentWindow({id:t,title:e,class:"contentwindow",zIndex:1e5,close_button:!1,height:o||"auto",buttons:{},modalOptions:{destroyOnClick:!1}},{panel:t+"_panel",loadMethod:"callback",callback:function(){var t=new Element("div.infobox.info_box").grab(new Element("p",{html:i}));if(!n||!s)return new Element("div.popupcontent").grab(t);var e=new Element("p.tcenter").grab(new Element("a.button",{html:n,href:"#",events:{click:s}}));return new Element("div.popupcontent").grab(t).grab(e)}})}var Controller=new Class({Implements:[Options,Events,GlobalState],options:{defaultAction:"run",assets:[]},$base_url:"",name:"Controller",last_request:!1,first_request:!1,initialize:function(t){this.setOptions(t),this.startListening()},load:function(t,e,i){!(this.last_request={panel:t,url:e,params:i})===this.first_request&&(this.first_request=this.last_request),(instanceOf(t,String)?this.getPanel(t):t).loadURL(e,i)},reload:function(){!1!==this.last_request&&this.load(this.last_request.panel,this.last_request.url,this.last_request.params)},reloadPage:function(){document.$page.reload()},setContent:function(t,e){this.getPanel(t).setHTML(e)},getPanel:function(t){return null!==$(t+"_panel")&&$(t+"_panel").retrieve("instance")},run:function(){},loadController:function(t,e,i){var n;void 0!==document.$page?document.$page.loadController(t,e,i):(n=$("maingrid"))&&n.retrieve("instance").loadController(t,e,i)},getController:function(t){if(void 0!==document.$page)return document.$page.getController(t);var e=$("maingrid");return e?e.retrieve("instance").getController(t):void 0},onStateUpdate:function(t,e){},onStateDelete:function(t){},onStateAdd:function(t,e){},loadAssets:function(t){0<this.options.assets.length?document.require(this.options.assets,t):t()}}),PopupController=new Class({Extends:Controller,Implements:[],default_options:{onClose:!1,width:600,height:"auto",closeable:!0,hidden:!0,title:!1},run:function(e,i){var n=void 0!==(e="object"===typeOf(e)?Object.merge(Object.clone(this.default_options),e):("element"===typeOf(e)&&(i=e),Object.clone(this.default_options))).id?e.id:String.uniqueID(),t="element"==typeOf(i)&&"a"==i.get("tag")&&"#"!==i.get("href")?i.href:"element"==typeOf(i)&&"form"==i.get("tag")&&"#"!==i.get("action")?i.get("action"):"element"==typeOf(i)&&null!==(s=i.get("data-url"))?s:void 0!==e.url?e.url:document.location.toString(),s={onJSON:function(t){this.onJSON(t,n,e,i)}.bind(this),request:{}};e.data&&(s.request.data=e.data),e.method&&(s.request.method=e.method),void 0!==e.timeout&&(s.request.timeout=e.timeout),this.window=new ContentWindow({height:e.height,width:e.width,close_button:e.closeable,onClose:function(){this.onCloseWindow(n,e,i)}.bind(this),id:"window_"+n,modalOptions:{id:"modal_"+n,destroyOnClick:e.closeable},buttons:e.buttons,hidden:e.hidden,title:e.title},{loadMethod:"controller",controller:"ContentController",controllerAction:"init",controllerActionParams:["window_"+n+"_panel",t,s]},void 0===e.type?"content":e.type)},onCloseWindow:function(t,e,i){if("element"===typeOf(i)){var n;try{n=new Event("close",{bubbles:!0,cancelable:!0})}catch(t){(n=document.createEvent("HTMLEvents")).initEvent("close",!0,!0)}n.element=i,n.uid=t,i.dispatchEvent(n)}"reload"==e.onClose?document.location.reload():"ajax_reload"===e.onClose?document.$page.reload():"function"==typeof e.onClose&&e.onClose()},onJSON:function(t,e,i,n){"element"===typeOf(n)&&(void 0!==t.element_html&&n.set("html",t.element_html),n.fireEvent("onJSON",[t,n,i])),"object"==typeOf(t.content)&&Object.each(t.content,function(t,e){e=$(e);e&&e.set("html",t)})}}),ContentController=new Class({Extends:Controller,panel:null,trackers:{},init:function(t,e,i){void 0===document.$trackers&&(document.$trackers={}),void 0===document.$trackers[t]?(document.$trackers[t]=new ContentTracker(t,i,e),document.$trackers[t].addEvent("onJSON",function(t){window.fireEvent("onJSON",t)})):document.$trackers[t].load(e,i)},load:function(t,e,i){"string"!=typeof t&&(t=t.key),void 0!==document.$trackers[t]?document.$trackers[t].load(e,i):this.parent(t,e,i)},reload:function(t){void 0===t?Object.each(document.$trackers,function(t){t.reload()}):document.$trackers[t].reload()},enableTracker:function(t){void 0!==document.$trackers&&void 0!==document.$trackers[t]&&document.$trackers[t].enable()},disableTracker:function(t){void 0!==document.$trackers&&void 0!==document.$trackers[t]&&document.$trackers[t].disable()},removeTracker:function(t){void 0!==document.$trackers&&void 0!==document.$trackers[t]&&(document.$trackers[t].disable(),delete document.$trackers[t])}}),ContentTracker=new Class({Implements:[Options,Events],Binds:["onLinkClick","onFormSubmit","onFakeFormSubmit","reload","onJSON","onPanelDestroy","onClick"],options:{title:!1,loading_indicator:!0,request:{},can_retry:!1},disabled:null,last_request:!1,first_request:!1,initialize:function(t,e,i){this.panel=t;var n={};return"function"==typeOf(e)?n=e.apply(this,[this.panel,i]):void 0!==e&&(n=e),this.setOptions(n),!!this.panel&&(this.panel=this.getPanel(this.panel),!1!==this.panel&&void 0!==t&&((this.panel.tracker=this).panel.grid.addEvent("onLinkClick",this.onLinkClick),this.panel.grid.addEvent("onFormSubmit",this.onFormSubmit),this.panel.addEvent("js_submit",this.onFakeFormSubmit),this.panel.addEvent("click:relay(*[data-controller])",this.onClick),this.panel.addEvent("reload",this.reload),this.panel.grid.addEvent("onJSON",this.onJSON),this.panel.addEvent("destroy",this.onPanelDestroy),this.disabled=!1,void 0!==i&&this.load(i,this.options.request),!0))},load:function(t,e){!(this.last_request={url:t,params:e})===this.first_request&&(this.first_request=this.last_request),this.options.loading_indicator&&this.panel.content.startLoading(),this.panel.loadURL(t,e,!1,this.options.can_retry)},reload:function(){return!1!==this.last_request&&(this.load(this.last_request.url,this.last_request.params),!0)},getPanel:function(t){return $(t+"_panel").retrieve("instance")},onLinkClick:function(t,e){var i;e.hasClass("block-controller-event")||this.panel.element.contains(e)&&(e.hasClass("newwindow")?e.get("newwindowClickEventAttached")||(window.open(e.href,"_blank","noopener"),t.preventDefault()):e.get("data-direct")||(t.preventDefault(),i=Object.assign({},this.options.request),this.first_request&&((t=document.createElement("a")).href=this.first_request.url,t.pathname!==e.pathname&&void 0!==i.data&&delete i.data),this.load(e.href,i)))},onClick:function(t,e){var i,n;this.panel.element.contains(e)&&(t&&(t.preventDefault(),t.stop()),(i=e.get("data-controller").split("."))[0]&&(n=i[1]||"run",t=(t=e.get("data-params"))?JSON.decode(t):[],(t=!instanceOf(t,Array)?[t]:t).push(e),t.push(this),$page.loadController(i[0],n,t)))},onFormSubmit:function(t,e,i){this.panel.element.contains(e)&&!e.get("data-controller")&&(!1!==t&&void 0!==t&&t.preventDefault(),this.load(e.get("action"),{data:i,method:e.get("method")}))},onFakeFormSubmit:function(t,e,i){var n;return!!(t=void 0!==t&&t?t:this.panel.content.getElements("form").pick())&&("true"!=t.get("data-ignore-submit")?(n=this.panel.grid.serializeForm(t),void 0!==e&&void 0===n[e]&&(n[e]=void 0===i?"true":i),this.onFormSubmit(!1,t,n),!1):void t.submit())},onJSON:function(t){if(this.panel.content.stopLoading(),t.redirect)return t.close?void(document.location.href=t.redirect):(delete this.options.request.data,void this.load(t.redirect));this.panel.content.bind_fillpanels(),this.fireEvent("onJSON",[t])},enable:function(){this.disabled&&(this.panel.grid.addEvent("onLinkClick",this.onLinkClick),this.panel.grid.addEvent("onFormSubmit",this.onFormSubmit),this.panel.addEvent("js_submit",this.onFakeFormSubmit),this.panel.addEvent("reload",this.reload),this.panel.grid.addEvent("onJSON",this.onJSON),this.disabled=!1)},disable:function(){this.disabled||(this.panel.grid.removeEvent("onLinkClick",this.onLinkClick),this.panel.grid.removeEvent("onFormSubmit",this.onFormSubmit),this.panel.removeEvent("js_submit",this.onFakeFormSubmit),this.panel.removeEvent("reload",this.reload),this.panel.grid.removeEvent("onJSON",this.onJSON),this.disabled=!0)},onPanelDestroy:function(){this.panel.grid.removeEvent("onLinkClick",this.onLinkClick),this.panel.grid.removeEvent("onFormSubmit",this.onFormSubmit),this.panel.removeEvent("js_submit",this.onFakeFormSubmit),this.panel.removeEvent("reload",this.reload),this.panel.grid.removeEvent("onJSON",this.onJSON),this.panel.removeEvent("destroy",this.onPanelDestroy),delete document.$trackers[this.panel.options.id]}}),Page=new Class({Implements:[Options,Events,GlobalState],Binds:["onLinkClick","onFormSubmit"],controllers:{},options:{controller_path:$base_url+"/resources/js/controllers"},initialize:function(t){void 0===document.$page&&(t=t||{},"undefined"!=typeof $controller_path&&void 0===t.controller_path&&(t.controller_path=$controller_path),this.setOptions(t),document.body.addEvent("click:relay(a, button)",this.onLinkClick),document.body.addEvent("submit:relay(form)",this.onFormSubmit),document.$page=this,document.body.addEvent("keydown",function(t){var e,i;"enter"==t.key&&"input"==t.target.get("tag")&&"true"!==t.target.get("data-ignore-enter")&&["text","password"].contains(t.target.get("type"))&&(!(e=t.target.getParent("form"))||0!=e.getElements("input[type=submit]").length||(i=e.getParent("div.panel"))&&(i.retrieve("instance").fireEvent("js_submit",[e,t.target.get("name"),t.target.get("value")]),t.stop()))}),void 0===document.loadController&&(document.loadController=this.loadController.bind(this)),void 0===document.json&&(document.json=this.json.bind(this)))},onLinkClick:function(t,e){if(["a","button"].contains($(e).get("tag"))&&"function"!=typeof e.onclick&&"true"!=e.get("data-ignore-click")&&null===(e.get("href")+"").match(/^mailto:/i)&&null===e.getParent('*[data-ignore-click="true"]')&&!e.hasClass("disabled")&&null===e.getParent(".disabled")){var i,n,s,o,a,r=!1;if("null"!=typeOf(e.get("data-method"))&&"null"!=typeOf(e.get("href"))&&"post"===e.get("data-method")){t&&(t.preventDefault(),t.stop()),"button"===e.tagName.toLowerCase()&&(o=e.get("href"),(e=document.createElement("a")).href=o);var l,h=new URLSearchParams(e.search),c=document.createElement("form");return"/"!==(l=e.pathname).substr(0,1)&&(l="/"+l),c.setAttribute("method","post"),c.setAttribute("action",l),h.forEach(function(t,e){var i=document.createElement("input");i.setAttribute("type","hidden"),i.setAttribute("name",e),i.setAttribute("value",t),c.appendChild(i)}),document.body.appendChild(c),void c.submit()}"null"!=typeOf(e.get("data-controller"))&&(t&&(t.preventDefault(),t.stop()),(i=(o=e.get("data-controller")).split("."))[0]&&(l=i[1]||"run",h=(h=e.get("data-params"))?JSON.decode(h):[],(h=!instanceOf(h,Array)?[h]:h).push(e),this.loadController(i[0],l,h),r=!0)),"null"!=typeOf($(e).get("data-state"))&&(t&&t.preventDefault(),(n="true"==$(e).get("data-togglestate"))&&(s=this.getState()),0!=(o=(o=e.get("data-state")).parseQueryString())&&0<Object.getLength(o)&&(a=[],Object.each(o,function(t,e){n&&void 0!==s[e]&&t==s[e]&&(t=null),a.push(e),a.push(t)}),this.setStateValue.apply(this,a)),r=!0),0==r&&this.fireEvent("onLinkClick",[t,$(e)]),t&&"#"==$(e).get("href")&&t.preventDefault()}!e.hasClass("disabled")&&null===e.getParent(".disabled")||t.preventDefault()},onFormSubmit:function(t){var e,i,n,s,o,a=$(t.target);"true"!==a.get("data-ignore-submit")&&((e=this.serializeForm(a)).__controller?(t&&"function"===typeOf(t.preventDefault)&&t.preventDefault(),this.loadController(e.__controller,e.__action,{data:e,method:a.get("method")})):a.get("data-controller")?(t&&"function"===typeOf(t.preventDefault)&&t.preventDefault(),(i=(n=a.get("data-controller")).split("."))[0]&&(n=i[1]||"run",s=[],o=(o=a.get("data-params"))?JSON.decode(o):{},"object"===typeOf(o)?(o.method=a.get("method"),o.data=e,s.push(o)):instanceOf(o,Array)?(s=o).push(e):(s.push(o),s.push(e)),s.push(a),this.loadController(i[0],n,s))):this.fireEvent("onFormSubmit",[t,a,e]))},loadController:function(t,e,i){this.controllers[t]||instanceOf(window[t],Class)?this.onLoadController.apply(this,Array.convert(arguments)):document.require([{url:this.options.controller_path+"/"+t+".js",type:"js"}],function(){this.onLoadController(t,e,i)}.bind(this))},onLoadController:function(t,e,i){var n;this.controllers[t]?n=this.controllers[t]:(n=new window[t],this.controllers[t]=n),n.loadAssets(function(){var t=e&&n[e]?e:n.options.defaultAction;i=Array.convert(i),n[t].apply(n,i)})},getController:function(t){return void 0!==this.controllers[t]&&this.controllers[t]},reload:function(){var e=document.querySelector("#page");function s(t,e){t&&(t.set("html",e),t.createTooltips(),t.createSymbolLists(),void 0!==StyledSelect&&new StyledSelect("select.enhanced_select"),t.createLinks(),t.createProgressMeters(),t.check_media(),t.loadScripts(),void 0!==window.initBlockLists&&window.initBlockLists(t))}e&&e.startLoading(),this.fireEvent("reload"),this.json(document.location.href,function(t){e&&e.stopLoading(),Object.forEach(t,function(t,e){var i,n;"object"==typeof t?(i=parseInt(e),isNaN(i)||(n=document.querySelector(".contentdata:nth-child("+(i+1)+")"))&&Object.forEach(t,function(t,e){var i=n.querySelector("."+e);i||"script"!==e||t.stripScripts(!0),s(i,t)})):((i=$$("."+e).pick())||0!=e?i||"script"!==e||t.stripScripts(!0):i=$$("#page .contentdata .widget").pick(),s(i,t))})}.bind(this),{},!1,!1)},serializeForm:function(i){"undefined"!=typeof tinyMCE&&tinyMCE.each(tinyMCE.editors,function(t){var e=t.id;0<i.getElements("#"+e).length&&t.save()});var t=i.getElements("input[type=button]:not(input:disabled)");t.each(function(t){t.disabled=!0});var e=i.toQueryString().parseQueryString();return t.each(function(t){t.disabled=!1}),e},registerGrid:function(t){t.addEvent("onContentUpdate",function(t,e){this.fireEvent("onContentUpdate",[t,e])}.bind(this))}}),Column=new Class({Implements:[Options,Events],grid:null,element:null,handle:null,drag:null,key:"",panels:null,ticking:!1,options:{width:"fill",position:"bottom",panelSpacing:10,resizable:{enabled:!0,handleWidth:10,minWidth:!1,maxWidth:!1}},initialize:function(t,e){this.panels={},this.setOptions(e),this.grid=t,this.key=this.options.id,this.resizeEvent=this.onWindowResize.bind(this),this.grid.addEvent("onResize",this.resizeEvent)},draw:function(){this.element=new Element("div#"+this.key+".column").setStyles({width:0,height:this.grid.getHeight()+"px"}).store("instance",this),this.grid.content.grab(this.element,this.options.position);var t,e,i,n=this.grid.getLastColumn()===this;"fill"!==this.options.width&&!0===this.options.resizable.enabled&&(t=Math.floor(this.grid.options.columnSpacing/2)-Math.floor(this.options.resizable.handleWidth/2),this.handle=new Element("div#"+this.key+"_handle.handle").setStyles({top:0}),1<Object.getLength(this.grid.columns)?this.handle.setStyle("left",-this.options.resizable.handleWidth-t):this.handle.setStyle("right",t),this.handle.inject(this.element,"bottom"),e=!1===this.options.resizable.minWidth?Math.floor(this.options.width):this.options.resizable.minWidth,i=!1===this.options.resizable.maxWidth?Math.floor(2*this.options.width):this.options.resizable.maxWidth,this.drag=new Drag(this.element,{handle:this.handle,onDrag:this.onColumnResize.bind(this),invert:n,snap:1,limit:{y:[],x:[e,i]},modifiers:{x:"width",y:""}})),!n||(n=this.element.getPrevious("div.column"))&&(null!==(n=n.retrieve("instance")).handle&&(t=Math.floor(this.grid.options.columnSpacing/2)-Math.floor(n.options.resizable.handleWidth/2),n.handle.setStyles({left:"auto",right:t}),n.drag.options.invert=!1),n.element.setStyle("padding-right",this.grid.options.columnSpacing)),Object.each(this.grid.columns,function(t){t.resize()})},attach:function(t){return(this.panels[t.key]=t).addEvent("onContentUpdate",this.onContentUpdate.bind(this)),this},detach:function(t){delete this.panels[t.key]},resize:function(){var e,t;"fill"==this.options.width?(e=1,Object.each(this.grid.columns,function(t){"fill"==t.options.width&&t.key!==this.key&&e++},this),n=this.grid.getAvailableWidth()-1,t=Math.floor(n/e),this===this.grid.getLastColumn()&&(t+=n-t*e+1)):(t=this.options.width,null!==this.handle&&this.handle.setStyles({width:this.options.resizable.handleWidth,height:this.grid.getHeight()}));var i=this.grid.getHeight(),n=this.element.getComputedSize();t==n.width&&i==n.height||(this.element.setStyles({width:Math.floor(t),height:i}),this.fireEvent("onResize",this)),this.ticking=!1},resizeAutoPanels:function(){Object.each(this.panels,function(t){"fill"!=t.options.height&&"auto"!=t.options.height||t.resize()})},redrawPanels:function(){this.fireEvent("onResize",this)},getHeight:function(){return this.element.getStyle("height").toInt()},getWidth:function(){return Math.floor(this.element.offsetWidth-this.element.getStyle("padding-right").toInt())},getContentHeight:function(){var i=0,n=Array.convert(arguments),s=0<n.length&&!0===n[n.length-1];return s&&n.pop(),0==n.length&&(n=["auto","fill","fixed"]),Object.each(this.panels,function(t){var e;s&&t.redraw(),"auto"==t.options.height&&n.contains("auto")?(i+=t.content_size.y,void 0!==t.title&&!1!==t.title&&(i+=t.title.getSize().y)):"fill"==t.options.height&&n.contains("fill")?i+=t.options.minHeight||0:n.contains("fixed")&&!["auto","fill"].contains(t.options.height)&&("string"==typeOf(t.options.height)?"%"==t.options.height.substring(t.options.height.length-1)&&(e=t.options.height.toInt(),t.options.height=this.getHeight()*(e/100)):0!=t.percentage&&(t.options.height=this.getHeight()*t.percentage),i+=t.options.height),i+=t.borders.vertical},this),i+=(Object.getLength(this.panels)-1)*this.options.panelSpacing},getFirstPanel:function(){return this.element.getFirst("div.panel").retrieve("instance")},getLastPanel:function(t){try{return this.element.getLast("div.panel"+(t?"."+t:"")).retrieve("instance")}catch(t){return!1}},destroy:function(){this.resizeEvent&&this.grid.removeEvent("onResize",this.resizeEvent),this.drag&&this.drag.stop(),this.removeEvents(),Object.each(this.panels,function(t){t.destroy()}),$(this.element).eliminate("instance").destroy(),this.handle&&$(this.handle).destroy()},enableResizable:function(){this.drag&&(this.handle.setStyle("visibility","visible"),this.drag.attach())},disableResizable:function(){this.drag&&(this.handle.setStyle("visibility","hidden"),this.drag.detach())},onWindowResize:function(){this.ticking||requestAnimFrame(function(){this.resize()}.bind(this)),this.ticking=!0},onColumnResize:function(t,e){this.options.width=this.getWidth(),this.grid.resizeAutoColumns(),this.fireEvent("onResize")},onContentUpdate:function(t){this.fireEvent("onContentUpdate",t)}}),$gridCount=0,Grid=new Class({Implements:[Options,Events,GlobalState],enabled:!1,panels:null,element:null,container:null,controllers:null,columns:null,parentGrid:null,ticking:!1,sizes:{footer:{height:0},header:{height:0},container:{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0,position:{}}},options:{columnSpacing:10,height:"fill",relativeTo:window,controller_path:$base_url+"/resources/js/controllers"},cnt:!1,initialize:function(t,e){this.cnt=$gridCount++,this.setOptions(e),this.container=$(t),"container"===this.options.relativeTo&&(this.options.relativeTo=this.container),this.parentGrid=$("maingrid"),this.parentGrid?this.parentGrid=this.parentGrid.retrieve("instance"):this.parentGrid=!1,!1===this.parentGrid?void 0!==document.$page?(this.controllers=document.$page.controllers,document.$page.registerGrid(this)):(this.controllers={},document.body.addEvent("keydown",function(t){var e,i;"enter"==t.key&&"input"==t.target.get("tag")&&"true"!==t.target.get("data-ignore-enter")&&["text","password"].contains(t.target.get("type"))&&(!(e=t.target.getParent("form"))||0!=e.getElements("input[type=submit]").length||(i=e.getParent("div.panel"))&&(i.retrieve("instance").fireEvent("js_submit",[e,t.target.get("name"),t.target.get("value")]),t.stop()))})):this.controllers=this.parentGrid.controllers,this.createGrid(),this.panels={},this.columns={},this.click_event=this.onLinkClick.bind(this),this.element.addEvent("click:relay(a,button)",this.click_event),this.form_event=this.onFormSubmit.bind(this),this.element.addEvent("submit:relay(form)",this.form_event),"undefined"!=typeof $lifetime&&!1===this.parentGrid&&0<$lifetime&&(this.lifetime_timer=this.onEndOfLife.delay(1e3*($lifetime<=300?Math.floor(.9*$lifetime):$lifetime-300),this),this.last_active=new Date,this.waiting_period=$lifetime<=300?Math.floor(.1*$lifetime):300,window.addEvent("request",function(){clearTimeout(this.lifetime_timer),this.last_active=new Date,this.lifetime_timer=this.onEndOfLife.delay(1e3*($lifetime<=300?Math.floor(.9*$lifetime):$lifetime-300),this)}.bind(this))),void 0===document.loadController&&(document.loadController=this.loadController.bind(this)),void 0===document.request_json&&(document.request_json=this.json.bind(this))},createGrid:function(){var t=!1===this.parentGrid?"#maingrid":"";this.element=new Element("div"+t+".grid").inject(this.container),this.element.store("instance",this),this.header=new Element("div.header").inject(this.element),"element"===typeOf(this.options.header)&&this.header.grab(this.options.header),"string"===typeOf(this.options.header)&&this.header.set("html",this.options.header),this.content=new Element("div.columns.fix").inject(this.element),this.footer=new Element("div.footer").inject(this.element),"element"===typeOf(this.options.footer)&&this.footer.grab(this.options.footer),"string"===typeOf(this.options.footer)&&this.footer.set("html",this.options.footer),this.resize(),this.options.relativeTo===window&&(this.resize_event=this.onWindowResize.bind(this),window.addEvent("resize",this.resize_event))},addPanel:function(t){var e=new Panel(this,t);e.bind(),(this.panels[t.id]=e).draw()},addColumn:function(t,e){e.id=t;var i=new Column(this,e);i.addEvent("onContentUpdate",this.onContentUpdate.bind(this)),(this.columns[t]=i).draw(),e.panels&&("object"==typeOf(e.panels)?Object.each(e.panels,function(t){this.addPanel(t)},this):"array"==typeOf(e.panels)&&e.panels.each(function(t){this.addPanel(t)},this))},loadConfig:function(t){Object.each(t,function(t,e){this.addColumn(e,t)},this)},reset:function(){Object.each(this.columns,function(t,e){t.destroy()},this),delete this.panels,delete this.columns,this.panels={},this.columns={}},destroy:function(){if(this.resize_event&&window.removeEvent("resize",this.resize_event),this.click_event)try{this.element.removeEvents("click:relay(a)")}catch(t){}if(this.form_event)try{this.element.removeEvents("submit:relay(form)")}catch(t){}this.element.eliminate("instance"),this.removeEvents(),this.reset(),this.element.destroy()},loadController:function(t,e,i){this.controllers[t]||instanceOf(window[t],Class)?this.onLoadController.apply(this,Array.convert(arguments)):document.require([{url:this.options.controller_path+"/"+t+".js",type:"js"}],function(){this.onLoadController(t,e,i)}.bind(this))},getController:function(t){return void 0!==this.controllers[t]&&this.controllers[t]},getPanel:function(t){return this.panels[t]},setContent:function(t,e){this.panels[t].setHTML(e)},loadURL:function(t,e,i,n,s){var o={headers:{"X-INLINE":"true"},data:new URI(t).getData()};e=Object.merge(o,e||{}),this.json($base_url+t,function(t){this.onJSON(t,i,n)}.bind(this),e,!1,s)},createButtons:function(t,l){var h=[],c=this;0!=t&&(Object.each(t,function(t,e){var i,n,s,o,a,r=Object.clone(t);0!=Object.getLength(r)&&(null==(a=(i=r.panel?this.panels[r.panel]:l).content.getElement("div.buttoncontainer"))&&(a=new Element("div.buttoncontainer.fix"),i.content.grab(a)),h.contains(i)||(h.push(i),a.empty()),s={href:void 0!==r.href?r.href:"#",html:"function"==typeOf(r.label)?r.label():r.label,class:"button","data-name":e},n=void 0!==r.class&&r.class,e=void 0!==r.onclick,delete r.href,delete r.onclick,delete r.label,delete r.panel,delete r.class,s=Object.merge(s,r),o=new Element("a",s),0!=n&&o.addClass(n),e&&(o.store("callback",t.onclick),o.addEvent("click",function(t){o.hasClass("disabled")||this.retrieve("callback",function(){}).apply(this,[t,c])})),void 0!==r["data-event"]&&o.addEvent("click",function(t){t.stop(),o.hasClass("disabled")||i.fireEvent("button",[t.target.get("data-event"),t.target.get("data-name"),t.target.get("text"),t.target])}.bind(this)),void 0!==r.icon&&o.insertAdjacentHTML("afterbegin","<span class='icon "+r.icon+"'></span> "),a.grab(o),i.calculateContentSize(),!this.options.relativeTo||(a=this.options.relativeTo.retrieve("instance"))&&a.doWindowResize&&a.doWindowResize(),i.resize(),i.content.fireEvent("fillpanelResize"))}.bind(this)),this.redrawColumns())},onContentUpdate:function(t){this.fireEvent("onContentUpdate",t)},onJSON:function(e,i,n){var t=function(){var t;instanceOf(i,String)&&(i=this.panels[i]),n?n(e):e.html&&i.setHTML(e.html,void 0!==e.buttons?e.buttons:null),!0===e.reload?document.location.reload():!0===e.ajax_reload?document.$page.reload():void 0!==e.location?document.location=e.location:void 0!==e.request&&(t=function(){i.tracker?i.tracker.load(e.request,{}):i.loadURL(e.request,{},n)},e.delay?t.delay(e.delay):t()),void 0!==i&&!1!==i?i.fireEvent("onJSON",[e,i]):this.fireEvent("onJSON",e)}.bind(this);void 0!==e.assets&&0<e.assets.length?document.require(e.assets,t):t()},onLinkClick:function(t,e){if(["a","button"].contains($(e).get("tag"))&&"function"!=typeof e.onclick&&"true"!=e.get("data-ignore-click")&&!e.hasClass("qti-original-media-link")&&null===(e.get("href")+"").match(/^mailto:/i)&&null===e.getParent('*[data-ignore-click="true"]')&&!e.hasClass("disabled")&&null===e.getParent(".disabled")){var i,n,s=!1;if("null"!=typeOf(e.get("data-method"))&&"a"===e.tagName.toLowerCase()&&"post"===e.get("data-method")){t&&(t.preventDefault(),t.stop());var o,a=new URLSearchParams(e.search),r=document.createElement("form");return"/"!==(o=e.pathname).substr(0,1)&&(o="/"+o),r.setAttribute("method","post"),r.setAttribute("action",o),a.forEach(function(t,e){var i=document.createElement("input");i.setAttribute("type","hidden"),i.setAttribute("name",e),i.setAttribute("value",t),r.appendChild(i)}),document.body.appendChild(r),void r.submit()}"null"!=typeOf(e.get("data-controller"))&&(t&&(t.preventDefault(),t.stop()),(i=e.get("data-controller").split("."))[0]&&(o=i[1]||"run",a=(a=e.get("data-params"))?JSON.decode(a):[],(a=!instanceOf(a,Array)?[a]:a).push(e),this.loadController(i[0],o,a),s=!0)),"null"!=typeOf($(e).get("data-state"))&&(t&&(t.preventDefault(),t.stop()),0!=(a=e.get("data-state").parseQueryString())&&0<Object.getLength(a)&&(n=[],Object.each(a,function(t,e){n.push(e),n.push(t)}),this.setStateValue.apply(this,n)),s=!0),0==s&&"button"!==e.get("tag")&&this.fireEvent("onLinkClick",[t,$(e)]),t&&$(e).get("href")&&"#"===$(e).get("href").substr(0,1)&&t.preventDefault()}!e.hasClass("disabled")&&null===e.getParent(".disabled")||t.preventDefault()},onFormSubmit:function(t){var e,i,n,s,o,a=$(t.target);"true"!==a.get("data-ignore-submit")&&((e=this.serializeForm(a)).__controller?(t&&"function"===typeOf(t.preventDefault)&&(t.preventDefault(),t.stop()),this.loadController(e.__controller,e.__action,{data:e,method:a.get("method")})):a.get("data-controller")?(t&&"function"===typeOf(t.preventDefault)&&(t.preventDefault(),t.stop()),(i=(n=a.get("data-controller")).split("."))[0]&&(n=i[1]||"run",s=[],o=(o=a.get("data-params"))?JSON.decode(o):{},"object"===typeOf(o)?(o.method=a.get("method"),o.data=e,s.push(o)):instanceOf(o,Array)?(s=o).push(e):(s.push(o),s.push(e)),s.push(a),this.loadController(i[0],n,s))):this.fireEvent("onFormSubmit",[t,a,e]))},onWindowResize:function(){this.ticking||requestAnimFrame(function(){this.doWindowResize()}.bind(this)),this.ticking=!0},onLoadController:function(t,e,i){var n;this.controllers[t]?n=this.controllers[t]:(n=new window[t],this.controllers[t]=n),n.loadAssets(function(){var t=e&&n[e]?e:n.options.defaultAction;i=Array.convert(i),n[t].apply(n,i)})},onEndOfLife:function(){this.eol_window=new ContentWindow({width:400,zIndex:1e5,modalOptions:{destroyOnClick:!1,opacity:.8},close_button:!1,class:"errorwindow",onClose:function(){clearTimeout(this.eol_redirect),this.eol_window=!1}.bind(this)},{loadMethod:"callback",callback:this.open_eol_window.bind(this)}),this.eol_redirect=function(){window.location=$base_url+"/"}.delay(this.waiting_period)},open_eol_window:function(){var t=new Element("div.infobox.info-box",{styles:{"margin-bottom":10}}).grab(new Element("p",{html:$I18N.t("Your session is almost expired. Please press &quot;Continue&quot; to continue working. Otherwise, you will be logged out in {0} minutes and redirected to the login-page. Any unsaved work will be lost.",{0:Math.floor(this.waiting_period/60)})})),e=new Element("p.tcenter").grab(new Element("a.button",{href:"#",events:{click:this.noop.bind(this)},html:$I18N.t("Continue...")}));return new Element("div.popupcontent").grab(t).grab(e)},noop:function(t){t.stop(),this.json($base_url+"/noop",function(){}),this.eol_window.close()},doWindowResize:function(){var t=!1;0==this.parentGrid&&(this.element.setStyle("width","auto"),t=document.body.getStyle("overflow"),document.body.setStyle("overflow","auto")),this.resize(),this.redrawColumns(),0!=t&&document.body.setStyle("overflow",t),this.ticking=!1},resize:function(){var e=0;try{var t,i,n,s,o=(this.options.relativeTo===window?(t=window.getCoordinates(),n=(i=$$("body")[0]).getStyle("min-height").toInt(),e=0,i.getChildren().each(function(t){"absolute"!=t.getStyle("position")&&(e+=$(t).getSize().y)}),e-=this.element.getSize().y,t.height<n?n:t.height):(this.options.relativeTo.getChildren().each(function(t){"absolute"!==t.getStyle("position")&&(e+=t.getSize().y)},this),e-=this.element.getSize().y,s=this.options.relativeTo.getComputedSize({mode:"vertical"}),this.options.relativeTo.offsetHeight-s.computedTop-s.computedBottom))-e;this.element.setStyles({height:o})}catch(t){TraceKit&&TraceKit.report(t)}},getHeight:function(){return Math.floor(this.element.offsetHeight-this.footer.offsetHeight-this.header.offsetHeight)},getWidth:function(){return Math.floor(this.element.offsetWidth)},getAvailableWidth:function(){var e=this.element.offsetWidth;return Object.each(this.columns,function(t){"fill"!==t.options.width&&(e-=t.options.width)}),e-=(Object.getLength(this.columns)-1)*this.options.columnSpacing},redrawColumns:function(){this.fireEvent("onResize")},resizeAutoColumns:function(){Object.each(this.columns,function(t){"fill"==t.options.width&&t.resize()})},getLastColumn:function(){var t=this.content.getLast("div.column");return t?t.retrieve("instance"):null},getWindowSize:function(){var t=0,e=0,e=window.innerWidth?(t=window.innerWidth,window.innerHeight):0!=document.documentElement.clientWidth?(t=document.documentElement.clientWidth,document.documentElement.clientHeight):(t=document.body.clientWidth,document.body.clientHeight);return{width:t,height:e}},serializeForm:function(i){i=$(i),"undefined"!=typeof tinyMCE&&tinyMCE.each(tinyMCE.editors,function(t){var e=t.id;0<i.getElements("#"+e).length&&t.save()});var t=i.getElements("input[type=button]:not(input:disabled)");t.each(function(t){t.disabled=!0});var e=i.toQueryString().parseQueryString();return t.each(function(t){t.disabled=!1}),e}}),Panel=new Class({Implements:[Options,Events],grid:null,column:null,element:null,handle:null,drag:null,key:"",content:null,controller:null,classes:{},options:{height:"fill",minHeight:0,column:null,loadMethod:"none",content:"&nbsp;",controller:"",controllerOptions:{},controllerAction:!1,styles:{overflow:"hidden"},background:"#fff",color:"#000000",border:"0 none",position:"bottom",hidden:!1,resizable:{enabled:!0,handleHeight:10,minHeight:!1,maxHeight:!1},class:"",onLoad:function(){},onDestroy:function(){},title:!1},content_size:{x:0,y:0},events:{},percentage:!1,initialize:function(t,e){this.setOptions(e),this.grid=t,this.column=null==this.options.column?this.grid.columns[Oject.getKeys(this.grid.columns).pick()]:this.grid.columns[this.options.column],this.key=this.options.id,this.uuid=String.uniqueID(),"string"==typeOf(this.options.height)&&"%"==this.options.height.substring(this.options.height.length-1)&&(this.percentage=this.options.height.toInt()/100)},bind:function(){this.column.attach(this),this.events.onResize=this.onColumnResize.bind(this),this.column.addEvent("onResize",this.events.onResize),this.events.onJSON=this.onJSON.bind(this),this.events.button=this.onButton.bind(this),this.addEvent("onJSON",this.events.onJSON),this.addEvent("button",this.events.button)},draw:function(){var t="",e=0;"auto"==this.options.height?t+=".autoheight":e="fill"==this.options.height?(t+=".fillheight","auto"):(t+=".fixedheight",this.options.height),this.element=new Element("div#"+this.key+"_panel.panel"+t).setStyles({height:e,background:this.options.background,border:this.options.border,color:this.options.color,visibility:this.options.hidden?"hidden":"visible"}).store("instance",this),this.element.addClass(this.options.class),this.column.element.grab(this.element,this.options.position),this.content=new Element("div.panel_content"+t).setStyles(this.options.styles).inject(this.element);var i,n=this.column.getLastPanel()===this;"fill"!==this.options.height&&"auto"!==this.options.height&&!0===this.options.resizable.enabled&&(i=Math.floor(this.column.options.panelSpacing/2)-Math.floor(this.options.resizable.handleHeight/2),this.handle=new Element("div#"+this.key+"_handle.handle").setStyles({left:0}),1<Object.getLength(this.column.panels)?this.handle.setStyle("top",-this.options.resizable.handleHeight-i):this.handle.setStyle("bottom",i),this.handle.inject(this.element,"bottom"),e=!1!==this.options.resizable.minHeight&&this.options.resizable.minHeight,!1===(t=!1!==this.options.resizable.maxHeight&&this.options.resizable.maxHeight)&&(t=function(){return this.column.getHeight()-this.column.getContentHeight("fixed")+this.element.getSafeSize().y}.bind(this)),this.drag=new Drag(this.element,{handle:this.handle,onDrag:this.onPanelResize.bind(this),invert:n,snap:1,limit:{y:[e,t],x:[]},modifiers:{y:"height",x:""}})),!n||(n=this.element.getPrevious("div.panel"))&&null!==(n=n.retrieve("instance")).handle&&(i=Math.floor(this.column.options.panelSpacing/2)-Math.floor(this.options.resizable.handleHeight/2),n.handle.setStyles({top:"auto",bottom:-this.options.resizable.handleHeight-i}),n.drag.options.invert=!1),this.saveBorderTotals(),this.column.getFirstPanel()!==this&&this.element.setStyle("margin-top",this.column.options.panelSpacing),this.setTitle(this.options.title),this.resize(),this.loadDefaultContent(),this.calculateContentSize(),this.resize()},loadDefaultContent:function(){"html"==this.options.loadMethod?this.setHTML(this.options.content):"controller"==this.options.loadMethod&&this.options.controller?this.grid.loadController(this.options.controller,this.options.controllerAction,this.options.controllerOptions):"json"==this.options.loadMethod&&this.options.url&&this.grid.loadURL(this.options.url,this.options.params,this),this.redraw()},loadURL:function(t,e,i,n){(e=void 0===e?{}:e).atomic_key||(e.atomic_key=this.uuid),e.onCancel||(e.onCancel=function(){this.remove_loader(!1)}.bind(this)),this.grid.loadURL(t,e,this,i,n)},setHTML:function(t,e){this.cleanup_externals(),"element"==typeOf(t)||"elements"==typeOf(t)?this.content.grab(t):this.content.set("html",t),(e||this.options.buttons)&&this.grid.createButtons(e||this.options.buttons,this),this.reload()},reload:function(){this.redraw(),this.fireEvent("onContentUpdate",this),this.content.createTooltips(),this.content.createSymbolLists(),void 0!==StyledSelect&&new StyledSelect("select.enhanced_select"),this.content.createLinks(),this.content.createProgressMeters(),this.content.check_media(),this.content.loadScripts(),this.content.fireEvent("fillpanelResize")},setOverflow:function(t){this.content.setStyle("overflow",t)},setTitle:function(t){!1!==(t=void 0===t?this.options.title:t)&&(!1!==this.title&&void 0!==this.title||(this.title=new Element("div.panel_title.panelmenu").inject(this.element,"top")),this.title.set("html",t),this.content.setStyle("height",this.element.getSafeSize().y-this.title.getSafeSize().y))},resize:function(t){var e,i,n,s,o;if(!this.is_minimalized()){"auto"===this.options.height?(e=1,i=this.content_size.y+this.borders.vertical,!1!==this.title&&void 0!==this.title&&(i+=this.title.getSafeSize().y),n=i,Object.each(this.column.panels,function(t){"auto"!=t.options.height||t===this||t.is_minimalized()||(e++,n+=t.content_size.y+t.borders.vertical)},this),a=this.column.element.offsetHeight-this.column.getContentHeight("fill","fixed"),n<=a?s=i:(s=i-(r=Math.ceil((n-a)/e)),this.column.getLastPanel("autoheight")===this&&(s+=r*e-(n-a)))):"fill"==this.options.height?(o=1,Object.each(this.column.panels,function(t){"fill"!=t.options.height||t.key===this.key||t.is_minimalized()||o++},this),a=this.column.getHeight()-this.column.getContentHeight(),s=Math.floor(a/o)+this.options.minHeight,this.column.getLastPanel()===this&&(s+=a-Math.floor(a/o)*o)):(s=!1!==this.percentage?this.column.getHeight()*this.percentage:this.options.height,null!==this.handle&&this.handle.setStyles({height:this.options.resizable.handleHeight,width:this.column.getWidth()}));var a,r=s-this.content.getStyle("padding-top").toInt()-this.content.getStyle("padding-bottom").toInt();return!1!==this.title&&void 0!==this.title&&(r-=this.title.getSafeSize().y),t||(a=r-this.content.offsetHeight,t=s-this.element.offsetHeight,0==a&&0==t||(this.element.setStyle("height",s),this.content.setStyle("height",r),this.content.fireEvent("fillpanelResize")),this.fireEvent("onResize",[this,Math.max(a,t)])),this.ticking=!1,{height:s,contentHeight:r}}},calculateContentSize:function(i){return this.content_size=this.content.measure(function(){var t=this.parentNode,e=this.cloneNode(!0);document.body.appendChild(e);t=t.getStyle("width");e.setStyles({height:"auto",overflow:"visible",width:t});t=e.getSafeSize();return i&&(t.x-=e.getStyle("padding-left").toInt()+e.getStyle("padding-right").toInt(),t.y-=e.getStyle("padding-top").toInt()+e.getStyle("padding-bottom").toInt()),e.destroy(),t}),this.content_size},saveBorderTotals:function(){var t=this.element.getComputedSize();return t["border-top-width"]=isNaN(t["border-top-width"])?0:t["border-top-width"],t["border-bottom-width"]=isNaN(t["border-bottom-width"])?0:t["border-bottom-width"],t["border-left-width"]=isNaN(t["border-left-width"])?0:t["border-left-width"],t["border-right-width"]=isNaN(t["border-right-width"])?0:t["border-right-width"],this.borders={vertical:t["border-top-width"]+t["border-bottom-width"],horizontal:t["border-left-width"]+t["border-right-width"]},this.borders},redraw:function(){var t=this.content_size,e=this.calculateContentSize();t.x==e.x&&t.y==e.y||this.column.redrawPanels()},bindElement:function(n){this.addEvent("onResize",function(t,e){var i=n.getComputedSize({mode:"vertical"}).height;n.setStyle("height",i+e)})},remove_loader:function(t){t=void 0!==t&&!!t,0!=this.content.get("data-loader")&&this.content.stopLoading(t),0!=this.element.get("data-loader")&&this.element.stopLoading(t)},cleanup_externals:function(){"undefined"!=typeof tinyMCE&&this.content.getElements(".tinymce").each(function(t){t=tinyMCE.get(t.id);t&&tinyMCE.remove(t)}),null!==this.content.getElement("form")&&void 0!==window.$actions&&"function"==typeof this.content.cleanActions&&this.content.cleanActions(),"undefined"!=typeof videojs&&this.content.getElements(".video-js").each(function(t){videojs(t.get("id")).dispose()}),this.content.getElements(".dateselect").each(function(t){t=t.retrieve("datepicker",!1);!1!==t&&(t.close(!0),t.destroy())}),this.content.getElements(".timeselect").each(function(t){t=t.retrieve("timepicker",!1);!1!==t&&(t.close(!0),t.destroy())}),"function"===typeOf(this.element.destroy_selects)&&this.element.destroy_selects()},destroy:function(){this.remove_loader(!0),this.grid.cancelRequest(this.uuid),this.content.unbind_fillpanels(),this.cleanup_externals(),this.element.eliminate("instance"),this.fireEvent("onDestroy"),this.removeEvents(),this.drag&&this.drag.stop(),this.handle&&this.handle.destroy(),this.content.destroy();this.element.id;this.element.destroy(),this.controller=null},minimalize:function(){this.element.setStyle("display","none"),this.disableResizable(),this.column.redrawPanels(),this.fireEvent("onMinimalize",[this])},is_minimalized:function(){return"none"==this.element.getStyle("display")},maximalize:function(){this.element.setStyle("display","block"),this.enableResizable(),this.column.redrawPanels(),this.fireEvent("onMaximalize",[this])},enableResizable:function(){this.drag&&(this.handle.setStyle("visibility","visible"),this.drag.attach())},disableResizable:function(){this.drag&&(this.handle.setStyle("visibility","hidden"),this.drag.detach())},hide:function(){return this.element.setStyle("visibility","hidden"),this},show:function(){return this.element.setStyle("visibility","visible"),this},setBackground:function(t){return this.element.setStyle("background",t),this},setColor:function(t){return this.element.setStyle("color",t),this},setBorder:function(t){return this.element.setStyle("border",t),this},addClass:function(){return Array.convert(arguments).each(function(t){this.element.addClass(t),this.classes[t]=!0}.bind(this)),this},removeClass:function(){return Array.convert(arguments).each(function(t){this.element.removeClass(t),delete this.classes[t]},this),this},resetStyles:function(){return Object.each(this.classes,function(t,e){this.removeClass(e)},this),this.setBackground(this.options.background),this.setColor(this.options.background),this.setBorder(this.options.border),this},setHeight:function(t){"auto"==t?(this.element.removeClass("fillheight").removeClass("fixedheight").addClass("autoheight"),this.element.setStyle("height","auto")):"fill"==t?this.element.removeClass("autoheight").removeClass("fixedheight").addClass("fillheight"):(this.element.removeClass("autoheight").removeClass("fllheight").addClass("fixedheight"),this.options.height=t,"string"==typeOf(t)&&"%"==this.options.height.substring(this.options.height.length-1)&&(this.percentage=this.options.height.toInt()/100)),this.calculateContentSize(),this.column.redrawPanels()},onColumnResize:function(){this.ticking||requestAnimFrame(function(){this.resize()}.bind(this)),this.ticking=!0},onJSON:function(t){this.grid.fireEvent("onJSON",t)},onButton:function(t,e,i,n){var s;"submit"==t&&(null!==(n=n.get("data-form-id"))&&null!==(s=$(n))||(s=!1),this.fireEvent("js_submit",[s,e,i]))},onPanelResize:function(){this.ticking||requestAnimFrame(function(){this.doPanelResize()}.bind(this)),this.ticking=!0},doPanelResize:function(){this.options.height=this.element.offsetHeight;var t=this.element.offsetHeight-this.content.getStyle("padding-top").toInt()-this.content.getStyle("padding-bottom").toInt();void 0!==this.title&&!1!==this.title&&(t-=this.title.getSafeSize().y);var e=t-this.content.offsetHeight;this.content.setStyle("height",t),0!=this.percentage&&(this.percentage=this.options.height/this.column.getHeight()),this.column.resizeAutoPanels(),this.fireEvent("onResize",[this,e]),this.ticking=!1}}),DataTable=new Class({Implements:[Options,Events,GlobalState],$cols:{},$rows:[],$keys:{},options:{id:"datatable",data_item:"items",url:"",state_prefix:"table",searchfield_title:"",rows:{clickable:!0,execute_scripts:!1,validateClick:!1},height:!1,request:{},filter_callback:!1,filter:!0,initial_filters:[],default_sort:!1,default_sort_dir:"asc",multiple:!1,selection:!1,paging:!0,paging_position:"menu",hideColumnHeader:!1,instant_search:!1,second_row:!1,hide_second_row:!1,menu_callback:function(){},odd_even:!0},element:null,menu:!1,tablehead:!1,container:!1,rowcontainer:!1,auto_count:0,total_width:0,total_rows:0,total:0,rowcount:25,filters:{},filter_elements:{},width:0,current_height:0,no_rows:!1,keygen:0,checkbox_tracker:null,initialize:function(t,e,i){this.setOptions(e),this.element=new Element("div.datatablecontainer").inject(t),this.element.set("id",this.options.id),this.element.store("instance",this),this.width=this.element.getParent().getSize().x,this.current_height=this.options.height,this.startListening(),this.options.multiple&&(this.selection=i||{value:[],all:!1},i=this.selection.all,this.addColumn("_select",{label:'<input type="checkbox" class="checkall" name="_select_all" '+(i?'checked="checked"':"")+"/>",width:20,sortable:!1,class:"selectcol"}))},destroy:function(){this.element.eliminate&&this.element.destroy&&(this.element.eliminate("instance"),this.element.destroy()),this.stopListening(),this.cancelRequests(),this.removeEvents(),this.checkbox_tracker&&this.checkbox_tracker.destroy(),delete this.tablehead,delete this.container,delete this.rowcontainer,delete this.$cols,delete this.checkbox_tracker},addColumn:function(t,e){this.$cols[t]={label:e.label||t,property:e.property||t,width:e.width||"auto",sortable:!!e.sortable,class:e.class||void 0,renderer:e.renderer||!1,header_class:e.header_class||void 0,tooltip:e.tooltip||!1},"auto"==this.$cols[t].width?this.auto_count++:this.total_width+=this.$cols[t].width},removeColumn:function(e){void 0!==this.$cols[e]&&(this.$cols[e].element.destroy(),delete this.$cols[e],Object.each(this.$rows,function(t){t.cells[e].destroy()},this))},setData:function(t){var e,i;this.container&&(this.data=t,void 0!==this.data.filters&&this.data.filters.each(function(t){this.addFilter(t.key,t.name,t.value,"null"!==typeOf(t.label)&&t.label,!1)},this),void 0!==(e=!1===this.options.data_item?this.data:this.data[this.options.data_item])&&(this.no_rows&&(this.no_rows.destroy(),this.no_rows=!1),void 0!==t.total?this.total=t.total:this.total=Object.getLength(e),void 0!==t.rowcount&&(this.rowcount=t.rowcount),i=[],Object.each(e,function(t){i.push(""+this.lookup_key(t[this.options.rows.id_field||"id"]))},this),Object.each(this.$rows,function(t,e){i.contains(e)||(this.delete_key(t.data[this.options.rows.id_field||"id"]),t.destroy(),delete this.$rows[e])},this),Object.each(e,function(t){var e=this.lookup_key(t[this.options.rows.id_field||"id"]);void 0===this.$rows[e]?this.$rows[e]=new DataRow(this,t,this.options.rows):this.$rows[e].set_data(t)},this),0==Object.getLength(this.$rows)&&(this.no_rows=new Element("div.noresults").grab(new Element("p").grab(new Element("span.fas.fa-times-circle"))).grab(new Element("p",{text:$I18N.t("No results found")})).inject(this.container))))},refresh_filters:function(){this.cleanup_filters(this.getStateValue("filters",{}),!1,!1)},lookup_key:function(t){return void 0===this.$keys[t]&&(this.$keys[t]=""+this.keygen++),this.$keys[t]},delete_key:function(t){delete this.$keys[t]},load:function(t){"null"==typeOf(t)&&(t=!1),this.rowcontainer||this.render(!1);var e=Object.clone(this.options.request);this.refresh_filters(),0<Object.getLength(this.filters)&&(e.data=Object.merge({},e.data,{filters:this.filters})),0==t&&this.container.startLoading();var i=this.getStateValue("sort",this.options.default_sort),t=this.getStateValue("desc","desc"==this.options.default_sort_dir);void 0===e.data&&(e.data={}),e.data[this.options.state_prefix+"sort"]=i,e.data[this.options.state_prefix+"desc"]=t,this.json(this.options.url,this.onLoad.bind(this),e)},reload:function(){this.checkbox_tracker&&(this.checkbox_tracker.checkall.checked=!1,this.checkbox_tracker.check_all(),this.checkbox_tracker.update(this.total)),this.load()},render:function(){this.menu||!this.paging&&!this.options.filter||this.drawMenu(),this.tablehead||this.options.hideColumnHeader||this.drawColumns(),this.rowcontainer?Object.getLength(this.$rows):(t=new Element("table.datatable.integrated_table.no_oddeven",{cellpadding:0,cellspacing:0}).inject(this.container=new Element("div"+(this.options.multiple?".multiple_select":"")).inject(this.element)),this.rowcontainer=t,!1!==this.options.height&&(this.current_height=this.options.height,this.container.setStyles({overflow:"auto"})),this.setFilters()),"menu"!=this.options.paging_position&&0!=this.options.paging&&void 0===this.menu.pagingbar&&(this.menu.pagingform=new Element("form",{method:"get",action:$base_url+"/content/item/list/",class:"form"}).inject(this.element),this.menu.pagingform.addEvent("submit",this.search.bind(this)),this.menu.pagingbar=new Element("div.panelbar").inject(this.menu.pagingform),this.menu.pagingbar_sizes=this.menu.pagingbar.getComputedSize(),this.menu.pagingrow=new Element("div.row",{styles:{"text-align":"center"}}).inject(this.menu.pagingbar),this.drawPaging(this.menu.pagingrow)),this.fixHeight();var t,e,i=this.getStateValue("sort",this.options.default_sort);0==this.$cols[i].sortable&&(i=!1),this.data&&(void 0===(t=!1===this.options.data_item?this.data:this.data[this.options.data_item])&&(t=[]),e=!1,Object.each(t,function(t){t=this.lookup_key(t[this.options.rows.id_field||"id"]);this.$rows[t].render(i,e),e=this.$rows[t].element},this)),0<this.options.initial_filters.length&&this.options.filter&&!1!==this.options.filter_callback&&(this.addFilters(this.options.initial_filters,!1),this.options.initial_filters.empty()),this.options.multiple&&!this.checkbox_tracker&&(this.checkbox_tracker=new TrackCheckboxes(this.options.id,this.options.checkbox_tracker||{selected_text:$I18N.lookup("{0,plural,zero{No items selected} one{1 item selected} other{# items selected}}")},this.selection,!0),this.checkbox_tracker.addEvent("update",function(){this.selection.all&&this.selection.value.length===this.$rows.length?Object.each(this.$rows,function(t){t.select()}):(this.selection.all||0!==this.selection.value.length||Object.each(this.$rows,function(t){t.deselect()}),this.fireEvent("update",this.selection))}.bind(this))),this.resize(),this.updateActive(this.getState())},clear:function(){Object.each(this.$rows,function(t){t.destroy()}),this.$rows.empty(),this.$keys={},"function"==typeof this.rowcontainer.empty&&this.rowcontainer.empty()},drawMenu:function(){var t=this.getStateValue("search_question");this.menu={},this.menu.searchform=new Element("form",{method:"get",action:$base_url+"/content/item/list/",class:"form"}).inject(this.element),this.menu.searchform.addEvent("submit",this.search.bind(this)),this.menu.searchbar=new Element("div.panelbar").inject(this.menu.searchform),this.menu.firstrow=new Element("div.row.rel.nowrap").inject(this.menu.searchbar),this.menu.searchfield=new Element("input.textfield.input-with-icon.disabled[type=text]",{title:this.options.searchfield_title,value:this.getStateValue("search","")}).inject(this.menu.firstrow),this.menu.searchicon=new Element("span.fa-inputicon.fas.fa-search").inject(this.menu.firstrow),this.menu.searchfield.addEvent("keyup",function(t){"enter"==t.key?this.search(t):1==this.options.instant_search&&(void 0!==this.menu.searchtimer&&clearTimeout(this.menu.searchtimer),this.menu.searchtimer=this.search.delay(500,this))}.bind(this)),!1!==t&&(this.menu.searchfield.value=t),this.menu.searchsubmit=new Element("a.disabled.submit.button",{href:"#",title:$I18N.t("Search")}).set("text",$I18N.t("Search")).addEvent("click",this.search.bind(this)).inject(this.menu.firstrow),!1!==this.options.filter_callback&&(this.menu.searchfilter=new Element("a.disabled.tooltip.fas.fa-filter.fa-boxed.normal-icon",{href:"#",title:$I18N.t("Add a filter to limit the results")}).addEvent("click",function(t){t.preventDefault(),this.options.filter_callback(this.filters)}.bind(this)).inject(this.menu.firstrow));t=!1!==t||0<this.filters.length;this.menu.searchreset=new Element("a.disabled.tooltip.warning-icon.fas.fa-times.fa-boxed",{href:"#",title:$I18N.t("Show all"),styles:{display:1==t?"":"none"}}).addEvent("click",this.reset.bind(this)).inject(this.menu.firstrow),"menu"==this.options.paging_position&&0!=this.options.paging&&this.drawPaging(this.menu.firstrow),this.menu.secondrow=new Element("div.row").inject(this.menu.searchbar),this.options.menu_callback.apply(this,[this.menu]),this.menu.firstrow.createTooltips(),this.menu.firstrow.createSymbolLists()},drawPaging:function(t){var e=this.getStateValue("page"),i=Math.ceil(this.total/this.rowcount);this.menu.pager=new Element("div.tablepager",{styles:{display:1<i?"inline-block":"none"}}).inject(t),this.menu.pageLabel=new Element("span.pagelabel").set("text",$I18N.t("Page")+":").inject(this.menu.pager),this.menu.firstPage=new Element("a.fas.fa-fast-backward.disabled.tooltip",{href:"#",title:$I18N.t("Go to the first page")}).addEvent("click",this.firstPage.bind(this)).inject(this.menu.pager),this.menu.prevPage=new Element("a.fas.fa-backward.disabled.tooltip",{href:"#",title:$I18N.t("Go to the previous page")}).addEvent("click",this.previousPage.bind(this)).inject(this.menu.pager),this.menu.pagefield=new Element("input.textfield.disabled[type=text]",{styles:{width:25,"text-align":"center"}}).inject(this.menu.pager),!1!==e&&(this.menu.pagefield.value=e),this.menu.pagefield.addEvent("keyup",function(t){var e;"enter"==t.key&&(e=Math.ceil(this.total/this.rowcount),t=this.menu.pagefield.get("value").toInt(),"null"===typeOf(t)?(t=1,this.menu.pagefield.set("value","1")):this.menu.pagefield.set("value",t),e=Math.max(1,Math.min(t,e)),this.setStateValue("page",e))}.bind(this)),this.menu.seperator=new Element("span.pageseperator.disabled").set("text","/").inject(this.menu.pager),this.menu.pagetotal=new Element("span.pagetotal.disabled.tooltip").set("text","-").inject(this.menu.pager),this.menu.nextPage=new Element("a.fas.fa-forward.disabled.tooltip",{href:"#",title:$I18N.t("Go to the next page")}).addEvent("click",this.nextPage.bind(this)).inject(this.menu.pager),this.menu.lastPage=new Element("a.fas.fa-fast-forward.disabled.tooltip",{href:"#",title:$I18N.t("Go to the last page")}).addEvent("click",this.lastPage.bind(this)).inject(this.menu.pager)},drawColumns:function(){this.tablehead?this.tablehead.empty():(this.head=new Element("table.datatable.datatable_header",{cellpadding:0,cellspacing:0}).inject(this.element),this.tablehead=new Element("tr").inject(new Element("thead").inject(this.head))),Object.each(this.$cols,function(t,e){var i,n;t.element=new Element("th#head_"+this.options.id+"_"+e+(t.sortable?".sortable":"")).inject(this.tablehead),t.sortable?(i=this.getStateValue("sort",this.options.default_sort),n=this.getStateValue("desc","desc"==this.options.default_sort_dir),n=i==e?1==n?"fas.fa-sort-up":"fas.fa-sort-down":"fas.fa-sort",(n=new Element("a#"+this.options.id+"_sort_"+e+"[href=#]").set("html",t.label).grab(new Element("span."+n))).addEvent("click",function(t){return t.preventDefault(),this.sort(e),!1}.bind(this)),t.element.adopt(n)):t.element.set("html",t.label).inject(this.tablehead),void 0!==t.header_class&&t.element.addClass(t.header_class),"auto"!=t.width&&t.element.setStyle("width",t.width+(t.sortable?12:0))},this)},firstPage:function(t){void 0!==t?(t.preventDefault(),(t="a"!=(t=$(t.target)).get("tag")?t.getParent("a"):t).hasClass("disabled")||this.unsetStateValue("page")):this.unsetStateValue("page")},lastPage:function(t){void 0!==t?(t.preventDefault(),(t="a"!=(t=$(t.target)).get("tag")?t.getParent("a"):t).hasClass("disabled")||this.setStateValue("page",Math.ceil(this.total/this.rowcount))):this.setStateValue("page",Math.ceil(this.total/this.rowcount))},previousPage:function(t){void 0!==t?t.preventDefault():t=!1;var e=$(t.target);"a"!=e.get("tag")&&(e=e.getParent("a")),t&&e.hasClass("disabled")||Function.atomic(function(){var t=this.getStateValue("page","1").toInt();(t=0==t?1:t)<=2?this.unsetStateValue("page"):this.setStateValue("page",t-1),Function.release("page")},"page",this)},nextPage:function(t){void 0!==t?t.preventDefault():t=!1;var e=$(t.target);"a"!=e.get("tag")&&(e=e.getParent("a")),t&&e.hasClass("disabled")||Function.atomic(function(){var t=this.getStateValue("page","1").toInt(),e=Math.ceil(this.total/this.rowcount),t=0==t?1:t+1;this.setStateValue("page",e<t?e:t),Function.release("page")},"page",this)},search:function(t,e){void 0!==t&&t.preventDefault(),void 0===e?e=this.menu.searchfield.get("value"):this.menu.searchfield.set("value",e);t=this.getState();0==e.length?delete t[this.options.state_prefix+"search"]:t[this.options.state_prefix+"search"]=e,delete t[this.options.state_prefix+"page"],this.setState(t)},reset:function(t){void 0!==t&&t.preventDefault(),this.menu.secondrow.empty(),this.unsetStateValue("search","page","filters"),this.fixHeight()},sort:function(t,e){var i=this.getStateValue("sort",this.options.default_sort);void 0===e?e="1"==this.getStateValue("desc",!1):1==e?this.setStateValue("desc",1):this.unsetStateValue("desc"),$(this.options.id+"_sort_"+i).getElement("span.fa-sort-up,span.fa-sort-down").removeClass("fas fa-sort-up").removeClass("fas fa-sort-down").addClass("fas fa-sort");var n=$(this.options.id+"_sort_"+t).getElement("span.fa-sort-up,span.fa-sort-down,span.fa-sort");i==t?e?(this.unsetStateValue("desc"),n.removeClass("fas fa-sort").addClass("fas fa-sort-down")):(this.setStateValue("desc","1"),n.removeClass("fas fa-sort").addClass("fas fa-sort-up")):((e=this.getState())[this.options.state_prefix+"sort"]=t,e[this.options.state_prefix+"desc"]&&delete e[this.options.state_prefix+"desc"],this.setState(e),n.removeClass("fas fa-sort").addClass("fas fa-sort-down"))},onStateUpdate:function(t,e){},onStateDelete:function(t){},beforeStateUpdate:function(t,e){var i;t==this.options.state_prefix+"page"?(i=e[this.options.state_prefix+"page"].toInt(),"null"===typeOf(i)&&(e[this.options.state_prefix+"page"]=1)):t==this.options.state_prefix+"sort"&&(e[this.options.state_prefix+"page"]=1)},cleanup_filters:function(n,t,s){n=n||{},t=void 0===t||t,s=void 0===s||s;var o=!1;Object.each(this.filters,function(t,e){var i;void 0!==n[e]&&n[e]?(i=[],Object.each(n[e].v,function(t){t="string"==typeof t?Array.convert(t):Object.values(t);i.push(t[0])}),Object.each(t.v,function(t){t="string"==typeof t?Array.convert(t):Object.values(t),i.contains(t[0])||(this.deleteFilter(e,t[0],!1,s),o=!0)},this)):(void 0!==t.v&&0<t.v.length?t.v.each(function(t){this.deleteFilter(e,t[0],!1,s)},this):this.deleteFilter(e,!1,!1,s),o=!0)},this),Object.each(n,function(e,i){Object.each(e.v,function(t){t="string"==typeof t?Array.convert(t):Object.values(t),o=o||this.addFilter(i,e.n,t[0],t[1]||t[0],!1,!1)},this)},this),o&&t&&this.load()},onStateChange:function(t,e){var i,n=!1,s=t.contains(this.options.state_prefix+"desc")||t.contains(this.options.state_prefix+"sort");t.contains(this.options.state_prefix+"filters")&&(this.cleanup_filters(e[this.options.state_prefix+"filters"],!0,!1),n=!0),e.hasOwnProperty(this.options.state_prefix+"search")&&this.menu.searchfield.set("value",void 0===e[this.options.state_prefix+"search"]?"":e[this.options.state_prefix+"search"]),t.contains(this.options.state_prefix+"search")&&(this.menu.searchfield.set("value",void 0===e[this.options.state_prefix+"search"]?"":e[this.options.state_prefix+"search"]),s=!0),t.contains(this.options.state_prefix+"page")&&(void 0!==e[this.options.state_prefix+"page"]&&(i=e[this.options.state_prefix+"page"].toInt(),"null"===typeOf(i)&&this.setStateValue("page",1)),s=!0),t.contains(this.options.state_prefix+"active")&&Array.isArray(this.$rows)&&(this.updateActive(e)||(s=!0)),!n&&s&&this.load()},updateActive:function(t){var t=void 0===t[this.options.state_prefix+"active"]?{}:t[this.options.state_prefix+"active"],i=Object.values(t),e=!0;return i.each(function(t){if(!(e=e&&(!1!==this.getRow(t)||null!==this.element.getElement("[data-setstatevalueactive="+t+"]"))))return!1}.bind(this)),!!e&&(Object.each(this.$rows,function(t){var e=i.contains(t.id.toString());e&&!t.active?t.select():!e&&t.active&&t.deselect()}),this.element.getElements("[data-setstatevalueactive]").each(function(t){i.contains(t.get("data-setstatevalueactive"))?t.addClass("active"):t.removeClass("active")}),!0)},onLoad:function(t){this.setData(t),this.updateMenu(),this.render(),this.container.stopLoading(),this.fireEvent("onLoad",[t]),this.container.createTooltips(),this.container.createSymbolLists(),this.container.createLinks();t=this.container.getElement(".active");this.options.multiple&&this.checkbox_tracker.update(this.total),t&&this.container.scrollTo(0,t.getPosition(this.container).y-10)},updateMenu:function(){this.menu.searchfield&&this.menu.searchfield.setStyle("display","none");var t=this.getStateValue("page",1),e=Math.ceil(this.total/this.rowcount);this.total&&this.rowcount&&0!=this.options.paging&&1<e?(this.menu.pager&&this.menu.pager.setStyle("display","inline-block"),t!=e?(this.menu.lastPage.removeClass("disabled"),this.menu.nextPage.removeClass("disabled")):(this.menu.lastPage.addClass("disabled"),this.menu.nextPage.addClass("disabled")),this.menu.pagetotal.set("text",e),this.menu.pagetotal.set("title",$I18N.t("Total number of item(s): {0}",[(this.total+"").toInt()])),this.menu.pagetotal.createTooltips(),this.menu.pagefield.set("value",t),this.menu.pagefield.removeClass("disabled"),this.menu.seperator.removeClass("disabled"),this.menu.pagetotal.removeClass("disabled"),1!=t?(this.menu.firstPage.removeClass("disabled"),this.menu.prevPage.removeClass("disabled")):(this.menu.firstPage.addClass("disabled"),this.menu.prevPage.addClass("disabled"))):this.menu.pager&&this.menu.pager.setStyle("display","none"),Array.each([this.menu.searchfield,this.menu.searchsubmit,this.menu.searchreset,this.menu.searchfilter],function(t){t&&(0==this.total?t.addClass("disabled"):t.removeClass("disabled"))}),this.menu.searchfield&&((""!==this.menu.searchfield.value||0<this.filters.length)&&this.menu.searchreset?this.menu.searchreset.setStyle("display",""):this.menu.searchreset&&this.menu.searchreset.setStyle("display","none")),this.calculateMenuSize(),this.resize(),this.menu.searchfield&&this.menu.searchfield.setStyle("display","inline-block")},addFilter:function(e,t,i,n,s,o){if(void 0===o&&(o=!0),this.menu.secondrow){if(void 0===s&&(s=!0),n=n||i,this.filters[e]){if(this.filters[e].v=Object.values(this.filters[e].v),(i===n||!1===n||null===n)&&this.filters[e].v.contains(i))return!1;if(i!==n&&!1!==n&&null!==n){var a=!1;if(this.filters[e].v.each(function(t){if(t[0]===i)return!(a=!0)}),a)return!1}}var r=new Element("span.filter").set("text",t+": "+n).grab(new Element("span.fas.fa-times")).inject(this.menu.secondrow);return r.addEvent("click",function(t){this.deleteFilter(e,i)}.bind(this)),this.filters[e]||(this.filters[e]={n:t,v:[]}),this.filters[e].v=Array.clean(this.filters[e].v.include(i===n||!1===n||null===n?i:[i,n])),this.filter_elements[e+"|"+i]=r,this.fixHeight(),!0===o&&(0<Object.getLength(this.filters)?this.setStateValue("filters",this.filters):this.unsetStateValue("filters")),!0===s&&(this.unsetStateValue("page"),this.load()),this.fireEvent("filter",[e,t,i,n]),!0}return alert("Error: No place to inject the filters."),!1},setFilters:function(){this.filters={},Object.each(this.filter_elements,function(t){t.removeEvents(),t.destroy()});var t=this.getStateValue("filters",{});Object.each(t,function(t,e){for(var i,n,s=0,o=Object.getLength(t.v);s<o;s++)"string"===typeOf(t.v[s])?i=n=t.v[s]:(i=t.v[s][0],n=t.v[s][1]),this.addFilter(e,t.n,i,n,!1,!1)},this)},addFilters:function(t,e){e=void 0===e||e,t.each(function(t){this.addFilter(t.key,t.name,t.value,t.label,!1,!1)},this),0<Object.getLength(this.filters)?this.setStateValue("filters",this.filters):this.unsetStateValue("filters"),e&&(this.unsetStateValue("page"),this.load())},deleteFilter:function(t,e,i,n){i=void 0===i||i,n=void 0===n||n;if(e&&this.filter_elements[t+"|"+e]&&this.filter_elements[t+"|"+e].destroy(),this.filters[t])if(e){for(var s=0,o=Object.getLength(this.filters[t].v);s<o;s++){var a=this.filters[t].v[s];("string"!==typeOf(a)&&a[0]===e||a===e)&&delete this.filters[t].v[s]}0===Object.getLength(this.filters[t].v)&&delete this.filters[t]}else delete this.filters[t];this.filters[t]&&(this.filters[t].v=Array.clean(Object.values(this.filters[t].v))),n&&(0===Object.getLength(this.filters)?this.unsetStateValue("filters"):this.setStateValue("filters",this.filters)),this.fixHeight(),i&&this.load()},getRow:function(t){return t=this.lookup_key(t),void 0!==this.$rows[t]&&this.$rows[t]},calculateMenuSize:function(){!1!==this.menu&&(this.menu.height=0,this.options.filter&&(this.menu.height=this.menu.searchbar.getSize().y),this.menu.pagingbar&&(this.menu.height+=this.menu.pagingbar.getSize().y),this.tablehead&&(this.menu.height+=this.tablehead.getSize().y))},setHeight:function(t){this.current_height=t,this.menu&&0<t-this.menu.height&&this.container.setStyles({height:t-this.menu.height})},setWidth:function(t){this.width=t,this.resize()},fixHeight:function(){this.calculateMenuSize(),this.setHeight(this.current_height)},resize:function(){this.resizeHeaders()},resizeHeaders:function(){var t,e,i;this.rowcontainer&&this.rowcontainer.getFirst("tbody")&&0<this.rowcontainer.getFirst("tbody").getChildren().length&&!this.options.hideColumnHeader&&(this.rowcontainer.getFirst("tbody").getFirst("tr").getFirst("td"),(e=this.tablehead.getElement("th.spacer"))&&e.setStyle("width",0),i=this.rowcontainer.offsetWidth,0<(t=this.head.offsetWidth-i)?(i=(e=e||new Element("th.spacer",{styles:{padding:0}}).inject(this.tablehead)).getComputedSize({mode:"horizontal"}),e.setStyle("width",t-i.computedLeft-i.computedRight+1)):t<=0&&e&&e.destroy())}}),DataRow=new Class({Implements:[Options,Events],options:{id_field:"id",clickable:!0,execute_scripts:!1},table:!1,data:!1,element:!1,second_element:!1,active:!1,cells:{},initialize:function(t,e,i){var n;this.setOptions(i),this.table=t,this.data=e,this.id=e[this.options.id_field],this.table.options.multiple?(n=this.table.selection.value.indexOf(this.id),this.active=this.table.selection.all&&-1===n||!this.table.selection.all&&-1!==n):(n=this.table.getStateValue("active",[]),this.active=Object.contains(n,this.id+""))},destroy:function(){delete this.table,delete this.data,this.element.eliminate("instance"),this.element.getParent().destroy(),this.checkbox_tracker&&this.checkbox_tracker.destroy(),void 0!==this.second_element&&this.second_element&&this.second_element.destroy()},render:function(t,e){var i;this.element?(e?this.element.getParent()!==e.getParent()&&e.getParent().grab(this.element.getParent(),"after"):this.table.rowcontainer.firstChild!==this.element.getParent()&&this.table.rowcontainer.grab(this.element.getParent(),"top"),this.second_element&&this.element.getParent().grab(this.second_element,"bottom")):(i=this.options.clickable,this.element=new Element("tr#"+this.table.options.id+"_row_"+this.id).addEvents({click:this.click.bind(this),onselectstart:function(t){i&&t.stop()},mousedown:function(t){i&&t.stop()}}).setStyle("cursor",this.options.clickable?"pointer":"default").inject(new Element("tbody").inject(this.table.rowcontainer)),this.element.unselectable="on",this.element.store("instance",this)),this.load_data(t),this.active&&this.element.getParent().addClass("active"),e||Object.each(this.table.$cols,function(t,e){void 0!==this.cells[e]&&"auto"!==t.width&&this.cells[e].setStyle("width",t.width+"px")},this)},set_data:function(t){this.data=t},load_data:function(o){var t,e;Object.each(this.table.$cols,function(t,e){var i,n,s=!0;this.data[t.property]=this.data[t.property]+"",void 0===this.cells[e]?("_select"===e?(i=new Element("td."+e).inject(this.element),n=new Element("input",{type:"checkbox",class:"checksingle",name:this.table.options.id+"_active[]",value:this.data[this.options.id_field],events:{}}),i.adopt(n),n.set("checked",this.active),i.addEvent("onselectstart",function(){return!1}),i.unselectable="on"):!1!==t.renderer?(i=new Element("td."+e).inject(this.element),t.renderer(i,this.data)):((i=new Element("td."+e).set("html",this.data[t.property].stripScripts()).inject(this.element)).addEvent("onselectstart",function(){return!1}),i.unselectable="on"),this.cells[e]=i):(i=this.cells[e],"_select"===e||(!1!==t.renderer?t.renderer(i,this.data):(n=this.data[t.property].stripScripts(),i.get("html")!==n?i.set("html",n):s=!1))),void 0!==t.class&&(i.hasClass(t.class)&&(i.set("class",""),i.addClass(t.property)),i.addClass(t.class),this.data[t.class]&&i.addClass(this.data[t.class])),e===o?i.addClass("sortcol"):i.removeClass("sortcol"),"auto"!==t.width&&i.getStyle("width").toInt()!==t.width&&i.setStyle("width",t.width+"px"),t.tooltip&&this.data[t.tooltip]&&(i.addClass("tooltip"),i.set("data-tooltip-text",this.data[t.tooltip])),this.options.execute_scripts&&s&&this.data[t.property].stripScripts(this.options.execute_scripts)},this),!1!==this.table.options.second_row&&(t=!0,this.second_element||(this.second_element=new Element("tr#"+this.table.options.id+"_second_row_"+this.id+".second_row").addEvents({click:this.click.bind(this),onselectstart:function(t){t.preventDefault()},mousedown:function(t){t.preventDefault()}}).setStyle("cursor",this.options.clickable?"pointer":"default"),this.table.options.hide_second_row&&!this.active&&this.second_element.setStyle("display","none"),this.element.grab(this.second_element,"after")),this.data[this.table.options.second_row]=this.data[this.table.options.second_row]+"",void 0===this.cells[this.table.options.second_row]?this.cells[this.table.options.second_row]=new Element("td.second_row",{colspan:Object.getLength(this.table.$cols)}).set("html",this.data[this.table.options.second_row].stripScripts()).inject(this.second_element):(e=this.data[this.table.options.second_row].stripScripts(),this.cells[this.table.options.second_row].get("html")!==e?this.cells[this.table.options.second_row].set("html",e):t=!1),0===this.cells[this.table.options.second_row].get("html").length?this.second_element.setStyle("display","none"):this.second_element.setStyle("display","table-row"),this.options.execute_scripts&&t&&this.data[this.table.options.second_row].stripScripts(this.options.execute_scripts))},click:function(t){!1!==this.options.validateClick?this.options.validateClick(t,function(){this.clickAction(t)}.bind(this)):this.clickAction(t)},clickAction:function(t){if("input"===t.target.get("tag")&&t.target.hasClass("checksingle")&&this.options.clickable)t.target.checked?this.select():this.deselect();else{if(t.target.getParent("[data-setstatevalueactive]")){this.active&&this.deselect();var e=t.target.getParent("[data-setstatevalueactive]"),i=this.table.getStateValue("active");return i&&-1!=Object.values(i).indexOf(e.get("data-setstatevalueactive"))?(this.table.setStateValue("active",[]),e.removeClass("active")):(this.table.setStateValue("active",[e.get("data-setstatevalueactive")]),e.addClass("active")),t.preventDefault(),t.stopPropagation(),t.stop(),!1}if("a"!=t.target.get("tag")&&!t.target.getParent("a")&&this.options.clickable&&"input"!=t.target.get("tag"))return t.preventDefault(),t.stopPropagation(),t.stop(),this.active?this.deselect():this.select(),!1}},select:function(){var t=[];!0===this.table.options.multiple?(this.element.getParent().addClass("active"),this.active=!0,this.table.checkbox_tracker.check(this.id)):(this.table.element.getElements("tbody.active tr:nth-child(1)").each(function(t){var e=t.retrieve("instance");e!==this&&(e.active=!1,t.getParent().removeClass("active"),this.table.options.hide_second_row&&t.getNext(".second_row").setStyle("display","none"))},this),t.contains(this.id+"")||(t.push(this.id+""),this.table.setStateValue("active",t)),this.element.getParent().addClass("active"),this.active=!0),this.table.options.hide_second_row&&this.second_element.setStyle("display","table-row")},deselect:function(){var t=1==this.table.options.multiple;t?this.table.checkbox_tracker.uncheck(this.id):Object.contains(this.table.getStateValue("active",{}),this.id+"")&&this.table.unsetStateValue("active"),this.element.getParent().removeClass("active"),this.active=!1,this.table.options.hide_second_row&&this.second_element.setStyle("display","none"),document.getElementsByName("_select_all")[0]&&(document.getElementsByName("_select_all")[0].checked=!1)}}),StyledSelect=new Class({Implements:[Options,Events],options:{cssPrefix:"sel_",triggerText:!1},Binds:["position","focus","toggle","close","reset","autocomplete_keyup","autocomplete_keydown","autocomplete_keypress","onchange_value","onfocus"],container:!1,element:!1,list:!1,trigger:!1,trigger_value:!1,input:!1,reset_autocompleter:!0,reset_timer:null,ignore_focus:!1,scrollEvents:[],initialize:function(t,e){this.setOptions(e),"element"==typeOf(t)?this.elements=[t]:this.elements=$$(t),1<this.elements.length?this.elements.each(function(t){new StyledSelect(t,e)},this):1==this.elements.length&&(this.element=this.elements[0],this.apply())},apply:function(){this.build_elements(),window.addEvent("focus",this.onfocus),this.trigger.addEvent("mousedown",function(t){this.ignore_focus=!0}.bind(this)),this.trigger.addEvent("click",this.toggle),this.trigger.addEvent("focus",this.toggle),this.apply_onclick()},apply_onclick:function(){var i=this.list.getElements("li.clickable");i.each(function(e){e.addEvent("click",function(t){t.stop(),t.target.hasClass("disabled")||t.target.hasClass("optlabel")||(i.removeClass("selected"),e.addClass("selected"),this.close(),document.body.removeEvent("click",this.close),t=this.input.value!==e.retrieve("value"),this.input.value=e.retrieve("value"),t&&this.input.fireEvent("change"))}.bind(this))}.bind(this))},set:function(i){this.list.getElements("li.clickable").each(function(t){var e=t.retrieve("value");i===e?(this.input.value,t.retrieve("value"),this.input.value=i,t.addClass("selected"),this.trigger_value.set("text",t.retrieve("text"))):t.removeClass("selected")},this)},build_elements:function(){var t=this.options.cssPrefix,e=this.element.getStyle("width").toInt(),i=this.element.getSize().x;i<=0&&(i=e),this.container=new Element("span",{class:t+"container"}),this.input=new Element("input",{value:"",type:"hidden",name:this.element.get("name"),id:this.element.get("id")}),this.container.replaces(this.element,"after"),this.input.inject(this.container).cloneEvents(this.element),this.input.store("$styledselect",this),this.element.fireEvent("replace",this.input);this.options.triggerText;this.trigger=new Element("span",{class:t+"trigger rs_preserve",styles:{width:i}}).inject(this.container),this.trigger_value=new Element("span.v.ellipsis").inject(this.trigger),this.trigger.grab(new Element("span.fas.fa-sort")),this.autocompleter=new Element("input.selectinput",{type:"text",tabIndex:-1,title:"Autocomplete",styles:{position:"absolute",top:0,left:-15e3,display:"block",width:100,height:10,margin:0,padding:0},events:{keydown:this.autocomplete_keydown,keypress:this.autocomplete_keypress,keyup:this.autocomplete_keyup,focus:function(t){this.focussed=!0},blur:function(t){this.focussed=!1}}}).inject(this.trigger),this.list=new Element("ul."+t+"selector.no_display",{styles:{width:this.trigger.measure(function(){return this.getSize()}).x-4}}).inject(document.body);var t=this.element.getElements("option"),s=!1;t.each(function(t){var e=[];t.selected&&e.push("selected"),t.disabled?e.push("disabled"):e.push("clickable");var i,n=t.getParent("optgroup");n&&0<n.get("label").length&&s!=n.get("label")?(i=n.get("label"),new Element("li.optlabel",{text:i}).inject(this.list),s=i,e.push("grouped")):n&&s==n.get("label")&&e.push("grouped");e=new Element("li",{text:t.get("text"),class:e.join(" ")}).inject(this.list);e.store("value",t.get("value")),e.store("text",t.get("text")),t.selected&&(e.addClass("selected"),this.input.value,t.value,this.input.value=t.value,this.trigger_text=e.retrieve("text"))}.bind(this)),!1===this.trigger_text&&0<t.length&&(this.trigger_text=t[0].get("text")),void 0!==this.trigger_text?this.trigger_value.set("text",this.trigger_text):this.trigger_value.set("text","-"),this.input.addEvent("change",this.onchange_value)},addOption:function(t,e){var i,n=[],s="object"==typeOf(t)?(i=t.text,t.disabled):(i=t.get("text"),1==t.get("disabled"));t.selected&&n.push("selected"),s?n.push("disabled"):n.push("clickable");n=new Element("li",{text:i,class:n.join(" ")}).inject(this.list);n.store("value",t.value),n.store("text",i),t.selected&&(n.addClass("selected"),this.input.value=t.value,this.trigger_value.set("text",n.retrieve("text"))),void 0!==e&&e||this.apply_onclick()},clearOptions:function(){this.list.set("html","")},focus:function(){this.autocompleter.focus()},reset:function(){this.reset_autocompleter=!0},position:function(t){this.list.setStyle("height",0),this.list.setStyle("width","auto"),this.list.setStyle("box-sizing","content-box");var e=this.list.measure(function(){this.setStyles({height:"auto"});var e=0;this.getChildren().each(function(t){e+=t.offsetHeight+t.getStyle("margin-top").toInt()+t.getStyle("margin-bottom").toInt()});var t=this.getComputedSize({});return this.setStyles({height:0}),{x:t.width,y:e}}),i=this.trigger.measure(function(){return this.getSize()}),n=this.trigger.getPosition(),s=Math.max(e.x+20,i.x-4),o=window.getScrollSize().x-n.x-10;this.list.setStyle("width",Math.min(o,s));var a=n.y+this.trigger.offsetHeight,r=window.getScrollTop(),i=window.getSize().y+r,o=e.y,s=this.list.getStyle("padding-top").toInt()+this.list.getStyle("padding-bottom").toInt(),o=i<a+o+20&&n.y-r>i-a?"top":"bottom",a="top"==o?n.y-r:i-a,s=Math.min(a-20,e.y+s);this.list.setStyle("height",s==a-20?s:"auto"),this.list.removeClass("shadow_"+("top"==o?"bottom":"top")).addClass("shadow_"+o),this.list.position({relativeTo:this.trigger,position:o+"Left",edge:("top"==o?"bottom":"top")+"Left",offset:{x:1,y:"top"==o?-2:2}})},toggle:function(t){var e;0==("focus"==t.type&&this.ignore_focus)?(t.stop(),0<this.trigger.getParents(".disabled").length||(this.list.hasClass("no_display")?(document.close_selects(),this.trigger.store("old-text",this.trigger.get("text")),this.trigger.store("old-value",this.input.value),this.trigger.addClass("focussed"),this.trigger.set("tabindex","-1"),this.list.removeClass("no_display"),this.position(),window.addEvent("resize",this.position),this.addScrollEvents(),document.body.addEvent("click",this.close),this.position(),this.focus(),0<(e=this.list.getElements(".selected")).length&&this.list.scrollTo(0,e.pick().getPosition(this.list).y)):(this.close(),document.body.removeEvent("click",this.close)))):"click"==t.type&&t.stop(),this.ignore_focus=!1},close:function(t){(void 0===t||t.target!==this.trigger&&t.target&&t.target.parentNode!==this.trigger)&&(this.trigger.removeClass&&(this.trigger.removeClass("focussed"),this.trigger.set("tabIndex",null)),this.list.addClass&&this.list.addClass("no_display"),window.removeEvent("resize",this.position),this.removeScrollEvents(),this.autocompleter&&this.autocompleter.focussed&&this.autocompleter.blur())},autocomplete_keydown:function(t){return t.key,String.convert(t.key).test("alt|shift|à|control|tab|enter","i")||this.reset_autocompleter&&(this.autocompleter.set("value",""),this.reset_autocompleter=!1),!0},autocomplete_keypress:function(t){switch(t.key){case"alt":case"shift":case"control":break;case"esc":this.input.value=this.trigger.retrieve("old-value"),this.input.fireEvent("change");case"tab":this.close();break;case"enter":return this.close(),!1}return!0},autocomplete_keyup:function(t){var e=this.list.getElement("li.selected");switch(t.key){case"up":var i=e.getPrevious("li.clickable");if(!i)return;e.removeClass("selected"),i.addClass("selected");var n=this.input.value!==i.retrieve("value");this.input.value=i.retrieve("value"),n&&this.input.fireEvent("change");break;case"down":var s=e.getNext("li.clickable");if(!s)return;e.removeClass("selected"),s.addClass("selected");n=this.input.value!==s.retrieve("value");this.input.value=s.retrieve("value"),n&&this.input.fireEvent("change");break;case"alt":case"shift":case"control":case"enter":break;default:var o=this.autocompleter.get("value"),i=this.list.getElements("li.clickable");0<o.trim().length?(i.each(function(t){var e=t.retrieve("text");0===e.toLowerCase().indexOf(o.toLowerCase())?(t.set("html","<strong>"+e.substr(0,o.length)+"</strong>"+e.substr(o.length)),t.addClass("valid")):(t.set("text",e),t.removeClass("valid"),t.removeClass("selected"))}),this.list.getElement("li.selected")||(s=(s=this.list.getElement("li.valid"))||this.list.getElement("li.clickable"))&&(s.addClass("selected"),n=this.input.value!==s.retrieve("value"),this.input.value=s.retrieve("value"),n&&this.input.fireEvent("change"),this.list.scrollTo(0,s.getPosition(this.list).y))):(i.removeClass("valid"),i.each(function(t){t.set("text",t.retrieve("text"))}))}this.reset_autocompleter=!1,0!=this.reset_timer&&clearTimeout(this.reset_timer),this.reset_timer=this.reset.delay(2e3)},onchange_value:function(){var e=this.input.value;this.list.getElements("li.clickable").each(function(t){t.retrieve("value")==e?(this.trigger_value.set("text",t.retrieve("text")),t.addClass("selected")):t.removeClass("selected")}.bind(this))},onfocus:function(){"function"!=typeof this.list.hasClass?window.removeEvent("focus",this.onfocus):this.list.hasClass("no_display")||this.focus()},hide:function(){this.container.hide()},show:function(){this.container.show()},destroy:function(){this.close(),this.list.removeEvents().destroy(),this.trigger.removeEvents().destroy(),this.container.removeEvents().destroy()},onScroll:function(t){const e=t.target===document?document.documentElement:t.target;var i=e.getBoundingClientRect(),t=this.trigger.getBoundingClientRect();t.bottom<i.top||t.bottom>i.bottom?this.list.style.visibility="hidden":(this.list.style.visibility=null,this.position())},addScrollEvents:function(t){let n=this.trigger.parentNode;for(;n;){let t,e,i;var s;n!==document&&(s=window.getComputedStyle(n),t=s.overflow,e=s.overflowX,i=s.overflowY),n!==document&&"auto"!==t&&"scroll"!==t&&"auto"!==e&&"scroll"!==e&&"auto"!==i&&"scroll"!==i||(n.addEventListener("scroll",this.onScroll.bind(this)),this.scrollEvents.push(n)),n=n.parentNode}},removeScrollEvents:function(t){this.scrollEvents.forEach(t=>{t.removeEventListener("scroll",this.onScroll.bind(this))})}});StyledSelect.close=function(t){t.retrieve("$styledselect").close()},Element.Properties.value={get:function(){return this.getProperty("value")},set:function(t){var e=this.retrieve("$styledselect",!1);!1!==e?e.set(t):this.setProperty("value",t)}},function(){Document.implement({destroy_selects:function(){document.body.destroy_selects()},close_selects:function(){document.body.close_selects()}}),Element.implement({destroy_selects:function(){this.getElements('input[type="hidden"]').each(function(t){t=t.retrieve("$styledselect",!1);!1!==t&&(t.destroy(),delete t)})},close_selects:function(){this.getElements('input[type="hidden"]').each(function(t){t=t.retrieve("$styledselect",!1);!1!==t&&t.close()})}})}.call(this),window.addEvent("domready",function(){new StyledSelect("select.enhanced_select")});var ClickToolTip=new Class({Implements:[Options,Events],Binds:["end","start"],current_element:!1,initialize:function(t){this.elements=t,this.request=new $Request.JSON({method:"get",onSuccess:this.loadhtml.bind(this)}),this.elements.each(this.build,this)},build:function(i){var n="click",t="click";switch(i.get("tag")){case"input":case"textarea":case"select":n="focus",t="blur"}var e=function(){var e;this.ttip||(this.ttip=new Element("div",{class:"clicktip-wrap no_display"}).inject(document.body),this.ttdata=new Element("div",{class:"tip-data"}).inject(this.ttip),this.tttitle=new Element("div",{class:"tip-title"}).inject(this.ttdata),this.ttclose=new Element("span",{class:"tip-close white-icon fas fa-times"}).inject(this.ttdata),this.tttext=new Element("div",{class:"tip-text"}).inject(this.ttdata),this.ttTween=new Fx.Tween(this.ttip,{property:"height",duration:200}),e=this.ttip.getStyle("z-index").toInt(),$$("div.window, div.clicktip-wrap").each(function(t){e=Math.max(t.getStyle("z-index").toInt()+75,e)}),this.ttip.setStyle("z-index",e),this.ttdata.addEvent("click",function(t){"A"===t.target.tagName||t.target.getParent("a")||t.stopPropagation()}),this.ttclose.addEvent("click",this.end));var t=!0;this.open_event!=this.close_event||this.ttip.hasClass("no_display")?this.start(i):(t=!1,this.end()),t&&"click"==n&&document.addEvent("click",function(t){"a"===t.target.get("tag")||t.target.getParent("a")||this.end()}.bind(this))}.bind(this);i.addEvent(n,function(t){!1!==this.current_element&&i!==this.current_element?this.end(!1,e):e(),t.stop()}.bind(this)),n!=t&&i.addEvent(t,function(t){setTimeout(function(){this.end(),t.stop()}.bind(this),100)}.bind(this)),i.addEvent("trash",this.end)},start:function(t){var e;(this.current_element=t).get("data-tooltip-text")?this.loaddata(t):(e=t.get("data-tooltip-url")||t.href)&&(this.tttitle.empty(),this.tttext.empty(),this.ttip.addClass("shadow_bottom"),this.ttip.removeClass("no_display"),this.tttitle.set("html",$I18N.t("Loading information...")),this.tttext.set("html","<p class='tcenter'><span class='fa-spinner fa-pulse'></span></p>"),this.ttTween.cancel(),this.position(t),this.ttTween.start(0,this.ttdata.scrollHeight),this.request.options.url=e,this.request.send())},end:function(t,e){void 0!==t&&0!=t&&t.stop(),this.ttTween.cancel(),this.ttTween.start(this.ttdata.scrollHeight,0).chain(function(){this.ttip.addClass("no_display").removeClass("shadow_bottom"),this.current_element=!1,"function"==typeOf(e)&&e()}.bind(this)),document.removeEvent("click",this.end)},loadhtml:function(t,e){this.tttitle.empty(),this.tttext.empty();var i="&nbsp;";if(!1===(e=JSON.decode(e))||void 0===e.html)return!1;null!=e.title&&(i=e.title),this.tttext.set("html",e.html),this.tttitle.set("html",i),this.ttTween.cancel(),this.ttTween.start(this.ttdata.scrollHeight)},loaddata:function(t){this.tttitle.empty(),this.tttext.empty();var e="&nbsp;",i="&nbsp;";if(t.get("data-tooltip-title")&&(e=t.get("data-tooltip-title")),t.get("data-tooltip-text"))i=t.get("data-tooltip-text");else{if(!t.get("title"))return!1;i=t.get("title")}this.tttext.set("html",i),this.tttitle.set("html",e),this.position(t),this.ttip.removeClass("no_display"),this.ttTween.cancel(),this.ttTween.start(0,this.ttdata.scrollHeight)},position:function(t){var e=t.getPosition(),i=this.ttip.hasClass("no_display"),n=this.ttdata.measure(function(){i&&this.getParent().removeClass("no_display");var t=this.getScrollSize();return i&&this.getParent().addClass("no_display"),t}),s=window.getScrollTop(),o=window.getSize().y+s,a=t.offsetHeight,r=e.y+a+8,a=r+n.y>o&&e.y-s>o-r?"top":"bottom",r="top"==a?e.y-s:o-r;n.y>r?this.ttip.store("max-height",r-20):this.ttip.store("max-height"),this.ttip.removeClass("shadow_"+("top"==a?"bottom":"top")).addClass("shadow_"+a),i&&(this.ttip.setStyle("height",n.y),this.ttip.removeClass("no_display"));n=t.get("data-tooltip-leftright")||"Left";this.ttip.position({relativeTo:t,position:a+n,edge:("top"==a?"bottom":"top")+n,offset:{x:1,y:"top"==a?-2:2}}),i&&(this.ttip.setStyle("height",0),this.ttip.addClass("no_display"))}});window.addEvent("domready",function(){new ClickToolTip($$(".clicktt"))});var SymbolList=new Class({Implements:[Events,Options],Binds:["show_map","hide_map","insert_character"],map:!1,characters:!1,trigger:!1,current_input:!1,panels:[],forms:[],options:{columns:18,ignore_classes:["numberinput","qti-numberinput","no-symbols","datefield","sliderfield"]},initialize:function(t){this.setOptions(t)},load:function(t){t.each(function(e){var t,i;this.options.ignore_classes.some(function(t){return e.hasClass(t)})||(this.build_trigger(),this.build_map(),e.addEvents({focus:this.show_trigger.pass(e,this),blur:this.hide_trigger.pass(e,this)}),e.addClass("has-symbollist"),void 0!==e.form&&e.form&&!this.forms.contains(e.form.id)&&($$(e.form).addEvent("submit",this.hide_trigger.pass(e,this)),this.forms.push(e.form.id)),!(t=e.getParent("div.panel"))||(i=t.retrieve("instance",!1))&&(i.addEvent("js_submit",this.hide_trigger.pass(e,this)),i.grid.addEvent("onFormSubmit",this.hide_trigger.pass(e,this)),i.addEvent("onDestroy",function(){this.hide_trigger(e),delete this.panels[i.key]}.bind(this)),this.panels.push(i.key)))},this)},insert_character:function(t){var e=t.target;t.stop();e=e.get("data-character");this.current_input.insertAtCursor(String.fromCharCode(e),!1),"function"==typeof Event?t=new Event("change"):(t=document.createEvent("Event")).initEvent("change",!0,!0),this.current_input.form.dispatchEvent(t)},build_trigger:function(){!1===this.trigger&&(this.trigger=new Element("span.symbollink.fa-boxed.normal-icon.fas.fa-paragraph",{events:{mouseenter:this.show_map,click:this.cancel_event,mouseup:this.cancel_event,mousedown:this.cancel_event},styles:{display:"none"}}).inject(document.body))},show_trigger:function(e){this.options.ignore_classes.some(function(t){return e.hasClass(t)})||(this.current_input=e,this.position_trigger(),this.trigger.setStyle("display","block"))},hide_trigger:function(t){this.current_input=!1,this.trigger.setStyle("display","none"),this.hide_map()},show_map:function(){this.position_map(),this.map.setStyle("display","block")},hide_map:function(){this.map.setStyle("display","none")},build_map:function(){var t,i,n;!1===this.map&&(null===(t=$("character_map"))?(this.map=new Element("div#character_map",{styles:{display:"none"},events:{mouseleave:this.hide_map}}).inject(document.body),i=new Element("tbody").inject(new Element("table").inject(this.map)),n=!1,this.get_symbols().each(function(t,e){(n=!1===n||e%this.options.columns==0?new Element("tr").inject(i):n).grab(new Element("td",{"data-character":t.char,html:t.ent}))}.bind(this)),this.map.addEvents({"mouseenter:relay(td)":function(){this.addClass("hover")},"mouseleave:relay(td)":function(){this.removeClass("hover")},"mousedown:relay(td)":this.insert_character,"mouseup:relay(td)":this.cancel_event,"click:relay(td)":this.cancel_event})):this.map=t)},cancel_event:function(t){return t.stop(),!1},position_trigger:function(){try{var t=this.current_input.getPosition(),e=window.getScrollTop(),i=window.getSize(),n=this.current_input.getSize(),s=t.x+n.x-18,o=t.y-20;s+this.trigger.offsetWidth>i.x&&(s=i.x-this.trigger.offsetWidth-5),o+this.trigger.offsetHeight>i.y+e&&(o-=this.trigger.offsetHeight+15),this.trigger.setStyles({left:s,top:o})}catch(t){}},position_map:function(){try{var t=this.trigger.getPosition(),e=window.getScrollTop(),i=window.getSize(),n=this.map.measure(function(){return this.getSize()}),s=t.x,o=t.y+18,a=n.x+t.x;s<0&&(s=16),o+n.y>i.y+e&&(o=t.y-(n.y+2)),a>i.x&&(s=i.x-n.x),this.map.setStyles({left:s,top:o})}catch(t){}},get_symbols:function(){return!1!==this.characters||(this.characters=[{ent:"&amp;",char:38},{ent:"&quot;",char:34},{ent:"&cent;",char:162},{ent:"&euro;",char:8364},{ent:"&pound;",char:163},{ent:"&yen;",char:165},{ent:"&copy;",char:169},{ent:"&reg;",char:174},{ent:"&trade;",char:8482},{ent:"&permil;",char:8240},{ent:"&micro;",char:181},{ent:"&middot;",char:183},{ent:"&bull;",char:8226},{ent:"&hellip;",char:8230},{ent:"&prime;",char:8242},{ent:"&Prime;",char:8243},{ent:"&sect;",char:167},{ent:"&para;",char:182},{ent:"&szlig;",char:223},{ent:"&lsaquo;",char:8249},{ent:"&rsaquo;",char:8250},{ent:"&laquo;",char:171},{ent:"&raquo;",char:187},{ent:"&lsquo;",char:8216},{ent:"&rsquo;",char:8217},{ent:"&ldquo;",char:8220},{ent:"&rdquo;",char:8221},{ent:"&bdquo;",char:8222},{ent:"&lt;",char:60},{ent:"&gt;",char:62},{ent:"&le;",char:8804},{ent:"&ge;",char:8805},{ent:"&ndash;",char:8211},{ent:"&mdash;",char:8212},{ent:"&macr;",char:175},{ent:"&oline;",char:8254},{ent:"&curren;",char:164},{ent:"&brvbar;",char:166},{ent:"&uml;",char:168},{ent:"&iexcl;",char:161},{ent:"&iquest;",char:191},{ent:"&circ;",char:710},{ent:"&tilde;",char:732},{ent:"&deg;",char:176},{ent:"&minus;",char:8722},{ent:"&plusmn;",char:177},{ent:"&divide;",char:247},{ent:"&frasl;",char:8260},{ent:"&times;",char:215},{ent:"&sup1;",char:185},{ent:"&sup2;",char:178},{ent:"&sup3;",char:179},{ent:"&frac14;",char:188},{ent:"&frac12;",char:189},{ent:"&frac34;",char:190},{ent:"&fnof;",char:402},{ent:"&int;",char:8747},{ent:"&sum;",char:8721},{ent:"&infin;",char:8734},{ent:"&radic;",char:8730},{ent:"&asymp;",char:8776},{ent:"&ne;",char:8800},{ent:"&equiv;",char:8801},{ent:"&prod;",char:8719},{ent:"&not;",char:172},{ent:"&cap;",char:8745},{ent:"&part;",char:8706},{ent:"&acute;",char:180},{ent:"&ordf;",char:170},{ent:"&ordm;",char:186},{ent:"&dagger;",char:8224},{ent:"&Dagger;",char:8225},{ent:"&Agrave;",char:192},{ent:"&Aacute;",char:193},{ent:"&Acirc;",char:194},{ent:"&Atilde;",char:195},{ent:"&Auml;",char:196},{ent:"&Aring;",char:197},{ent:"&AElig;",char:198},{ent:"&Ccedil;",char:199},{ent:"&Egrave;",char:200},{ent:"&Eacute;",char:201},{ent:"&Ecirc;",char:202},{ent:"&Euml;",char:203},{ent:"&Igrave;",char:204},{ent:"&Iacute;",char:205},{ent:"&Icirc;",char:206},{ent:"&Iuml;",char:207},{ent:"&ETH;",char:208},{ent:"&Ntilde;",char:209},{ent:"&Ograve;",char:210},{ent:"&Oacute;",char:211},{ent:"&Ocirc;",char:212},{ent:"&Otilde;",char:213},{ent:"&Ouml;",char:214},{ent:"&Oslash;",char:216},{ent:"&OElig;",char:338},{ent:"&Scaron;",char:352},{ent:"&Ugrave;",char:217},{ent:"&Uacute;",char:218},{ent:"&Ucirc;",char:219},{ent:"&Uuml;",char:220},{ent:"&Yacute;",char:221},{ent:"&Yuml;",char:376},{ent:"&THORN;",char:222},{ent:"&agrave;",char:224},{ent:"&aacute;",char:225},{ent:"&acirc;",char:226},{ent:"&atilde;",char:227},{ent:"&auml;",char:228},{ent:"&aring;",char:229},{ent:"&aelig;",char:230},{ent:"&ccedil;",char:231},{ent:"&egrave;",char:232},{ent:"&eacute;",char:233},{ent:"&ecirc;",char:234},{ent:"&euml;",char:235},{ent:"&igrave;",char:236},{ent:"&iacute;",char:237},{ent:"&icirc;",char:238},{ent:"&iuml;",char:239},{ent:"&eth;",char:240},{ent:"&ntilde;",char:241},{ent:"&ograve;",char:242},{ent:"&oacute;",char:243},{ent:"&ocirc;",char:244},{ent:"&otilde;",char:245},{ent:"&ouml;",char:246},{ent:"&oslash;",char:248},{ent:"&oelig;",char:339},{ent:"&scaron;",char:353},{ent:"&ugrave;",char:249},{ent:"&uacute;",char:250},{ent:"&ucirc;",char:251},{ent:"&uuml;",char:252},{ent:"&yacute;",char:253},{ent:"&thorn;",char:254},{ent:"&yuml;",char:255},{ent:"&Alpha;",char:913},{ent:"&Beta;",char:914},{ent:"&Gamma;",char:915},{ent:"&Delta;",char:916},{ent:"&Epsilon;",char:917},{ent:"&Zeta;",char:918},{ent:"&Eta;",char:919},{ent:"&Theta;",char:920},{ent:"&Iota;",char:921},{ent:"&Kappa;",char:922},{ent:"&Lambda;",char:923},{ent:"&Mu;",char:924},{ent:"&Nu;",char:925},{ent:"&Xi;",char:926},{ent:"&Omicron;",char:927},{ent:"&Pi;",char:928},{ent:"&Rho;",char:929},{ent:"&Sigma;",char:931},{ent:"&Tau;",char:932},{ent:"&Upsilon;",char:933},{ent:"&Phi;",char:934},{ent:"&Chi;",char:935},{ent:"&Psi;",char:936},{ent:"&Omega;",char:937},{ent:"&alpha;",char:945},{ent:"&beta;",char:946},{ent:"&gamma;",char:947},{ent:"&delta;",char:948},{ent:"&epsilon;",char:949},{ent:"&zeta;",char:950},{ent:"&eta;",char:951},{ent:"&theta;",char:952},{ent:"&iota;",char:953},{ent:"&kappa;",char:954},{ent:"&lambda;",char:955},{ent:"&mu;",char:956},{ent:"&nu;",char:957},{ent:"&xi;",char:958},{ent:"&omicron;",char:959},{ent:"&pi;",char:960},{ent:"&rho;",char:961},{ent:"&sigmaf;",char:962},{ent:"&sigma;",char:963},{ent:"&tau;",char:964},{ent:"&upsilon;",char:965},{ent:"&phi;",char:966},{ent:"&chi;",char:967},{ent:"&psi;",char:968},{ent:"&omega;",char:969},{ent:"&piv;",char:982},{ent:"&real;",char:8476},{ent:"&thetasym;",char:977},{ent:"&image;",char:8465},{ent:"&larr;",char:8592},{ent:"&uarr;",char:8593},{ent:"&rarr;",char:8594},{ent:"&darr;",char:8595},{ent:"&harr;",char:8596},{ent:"&loz;",char:9674},{ent:"&clubs;",char:9827},{ent:"&#502;",char:502},{ent:"&#405;",char:405}]),this.characters}}),WordCount=new Class({Implements:[Events,Options],initialize:function(t){this.setOptions(t)},load:function(t){t.each(function(a){var r=null;a.nextSibling&&a.nextSibling.classList.contains("wordcount")?r=a.nextSibling:(r=new Element("span.wordcount")).inject(a,"after");function e(t,e){var i=(o="div"===a.get("tag")?null==(n=a.innerText)?"":(""+n).replace(l,""):"undefined"!=typeof tinyMCE&&tinyMCE.get(a.id)?(s=tinyMCE.get(a.id).getBody(),tinyMCE.trim(s.innerText||s.textContent)):a.value.trim()).length,n=i?o.match(/\S+/g).length:0,s=0,o="";0<(s=void 0!==a.getParent(".qti-interaction")&&(a.getParent(".qti-interaction").get("data-maxwordssuggestion"),1)?parseInt(a.getParent(".qti-interaction").get("data-maxwordssuggestion")):s)&&(o=" ("+$I18N.t("maximum")+": "+s+")",s<n?r.classList.add("warning"):r.classList.remove("warning")),r.set("text",$I18N.t("Word count")+": "+n+o+", "+$I18N.t("character count")+": "+i),r.set("data-chars",i),r.set("data-words",n)}var l=/^\s*|\s*$/g;a.addEvent("keyup",e),a.addEvent("blur",e),a.addEvent("update",e),a.addEvent("tinyMCEloaded",function(){var t;"undefined"!=typeof tinyMCE&&tinyMCE.get(a.id)&&((t=tinyMCE.get(a.id))&&void 0!==t.on?(t.on("Change",e),t.on("KeyUp",e),t.on("SetContent",e)):(t.onChange.add(e),t.onKeyUp.add(e)),e())}),e()},this)}}),ProgressMeter=new Class({Implements:[Events],initalDelay:1e3,refreshTime:1e3,progressElement:!1,request:!1,initialize:function(t){this.progressElement=t,this.progressElement.store("progress",this)},start:function(){this.request=new $Request.JSON({url:this.progressElement.get("data-jsonurl")||document.location.href,onSuccess:this.updateprogress.bind(this),method:"GET",initialDelay:1e3,delay:1e3}),this.request.startTimer()},updateprogress:function(t){var e,i,n,s,o=this.progressElement.getElement("#progress_done")||this.progressElement.getElement(".progress_done"),a=this.progressElement.getElement("#progress_status")||this.progressElement.getElement(".progress_status");if(t.error||!o&&!a)this.request.stopTimer();else try{o&&o.setStyle("width",t.progress+"%"),a&&a.set("html",t.status),t.finished&&(this.request.stopTimer(),void 0!==t.content?((e=this.progressElement.parentNode).set("html",t.content),window.history&&t.url&&window.history.replaceState({},"",t.url),e.createTooltips(),e.createSymbolLists(),void 0!==StyledSelect&&new StyledSelect("select.enhanced_select"),e.createLinks(),e.createProgressMeters(),e.check_media(),e.loadScripts()):(i=this.progressElement.getParent("form"))&&(n=i.getParent("div.panel"),i.getElements(".disabled").removeClass("disabled"),n&&(s=n.retrieve("instance"))?(s.fireEvent("js_submit",[i,"completed_action","submit"]),s.content.getElements(".buttoncontainer .disabled").removeClass("disabled")):(i.grab(new Element("input",{type:"hidden",name:"completed_action",value:"submit"})),i.submit())),void 0!==t.location&&(document.location=t.location),this.fireEvent("finished",t))}catch(t){this.request.stopTimer()}}});window.addEvent("domready",function(){$$(".progressmeter").each(function(t){new ProgressMeter(t).start()})}),window.addEvent("domready",function(){new StylesheetChanger});var StylesheetChanger=new Class({Implements:[Events],cookieOptions:{},highcontrast:!1,dyslexic:!1,elementHighcontrast:null,elementDyslexic:null,fontsize:"normal",elementFontsizeNormal:null,elementFontsizeMedium:null,elementFontsizeLarge:null,initialize:function(){this.cookieOptions={secure:!0,domain:"",path:"/",samesite:"None"},$("accessibilitymenu")&&(this.elementHighcontrast=$("accessibilitymenu_highcontrast"),this.elementHighcontrast&&(this.highcontrast="highcontrast"===Cookie.read("stylesheet_highcontrast"),this.elementHighcontrast.addEvent("click",function(){this.toggleHighcontrast()}.bind(this))),this.elementDyslexic=$("accessibilitymenu_dyslexic"),this.elementDyslexic&&(this.dyslexic="dyslexic"===Cookie.read("stylesheet_dyslexic"),this.elementDyslexic.addEvent("click",function(){this.toggleDyslexic()}.bind(this))),this.elementFontsizeNormal=$("accessibilitymenu_font_s"),this.elementFontsizeMedium=$("accessibilitymenu_font_m"),this.elementFontsizeLarge=$("accessibilitymenu_font_l"),this.elementFontsizeNormal&&this.elementFontsizeMedium&&this.elementFontsizeLarge&&(this.fontsize=Cookie.read("stylesheet_fontsize"),"medium"!==this.fontsize&&"large"!==this.fontsize&&(this.fontsize="normal"),this.updateFontsizeIcons(),this.elementFontsizeNormal.addEvent("click",function(){this.setFontsize("normal",!0)}.bind(this)),this.elementFontsizeMedium.addEvent("click",function(){this.setFontsize("medium",!0)}.bind(this)),this.elementFontsizeLarge.addEvent("click",function(){this.setFontsize("large",!0)}.bind(this))))},toggleHighcontrast:function(){this.highcontrast?(this.highcontrast=!1,Cookie.dispose("stylesheet_highcontrast",this.cookieOptions),document.html.removeClass("highcontrast")):(this.highcontrast=!0,Cookie.write("stylesheet_highcontrast","highcontrast",this.cookieOptions),document.html.addClass("highcontrast")),this.highcontrast?this.elementHighcontrast.addClass("normal-icon").removeClass("inactive-icon"):this.elementHighcontrast.addClass("inactive-icon").removeClass("normal-icon")},toggleDyslexic:function(){this.dyslexic?(this.dyslexic=!1,Cookie.dispose("stylesheet_dyslexic",this.cookieOptions),document.html.removeClass("dyslexic")):(this.dyslexic=!0,Cookie.write("stylesheet_dyslexic","dyslexic",this.cookieOptions),document.html.addClass("dyslexic")),this.dyslexic?this.elementDyslexic.addClass("normal-icon").removeClass("inactive-icon"):this.elementDyslexic.addClass("inactive-icon").removeClass("normal-icon")},setFontsize:function(t){switch(this.fontsize=t,"medium"!==this.fontsize&&"large"!==this.fontsize&&(this.fontsize="normal"),"normal"===this.fontsize?Cookie.dispose("stylesheet_fontsize",this.cookieOptions):Cookie.write("stylesheet_fontsize",this.fontsize,this.cookieOptions),this.updateFontsizeIcons(),this.fontsize){case"normal":document.html.removeClass("fontsize-medium").removeClass("fontsize-large");break;case"medium":document.html.addClass("fontsize-medium").removeClass("fontsize-large");break;case"large":document.html.removeClass("fontsize-medium").addClass("fontsize-large")}},updateFontsizeIcons:function(){switch(this.fontsize){case"normal":this.elementFontsizeNormal.addClass("normal-icon").removeClass("inactive-icon"),this.elementFontsizeMedium.removeClass("normal-icon").addClass("inactive-icon"),this.elementFontsizeLarge.removeClass("normal-icon").addClass("inactive-icon");break;case"medium":this.elementFontsizeNormal.removeClass("normal-icon").addClass("inactive-icon"),this.elementFontsizeMedium.addClass("normal-icon").removeClass("inactive-icon"),this.elementFontsizeLarge.removeClass("normal-icon").addClass("inactive-icon");break;case"large":this.elementFontsizeNormal.removeClass("normal-icon").addClass("inactive-icon"),this.elementFontsizeMedium.removeClass("normal-icon").addClass("inactive-icon"),this.elementFontsizeLarge.addClass("normal-icon").removeClass("inactive-icon")}}});window.addEvent("domready",function(){$("menutoggler")&&$("menu")&&$("menutoggler").addEvent("click",function(){$("touchmenu")||$("header").insertBefore($("menu").clone().set("id","touchmenu"),$("nav")),$("touchmenu").setStyle("height",0<$("touchmenu").offsetHeight?0:$("touchmenu").scrollHeight),0==$("touchmenu").offsetHeight&&$("touchmenu").setStyle("top",window.getScrollTop())})}),function(t){var n="rad",s=Decimal.clone({precision:25,rounding:4});function i(){var t=(e=Array.from(arguments)).shift(),e=e.map(function(t){return t=!s.isDecimal(t)?new s(t):t});"a"!==t.charAt(0).toLowerCase()&&"deg"===n&&(e=e.map(function(t){return t.mul(Decimal.acos(-1).div(180))}));try{var i=s[t].apply(Decimal,e);"atan2"===t.toLowerCase()?i=i.div(Decimal.acos(-1).div(180)):"a"===t.charAt(0).toLowerCase()&&"deg"===n&&(i=i.mul(new s(180).div(Decimal.acos(-1))))}catch(t){}return i}t.CalculatorDecimal=s,t.CalculatorFunctions={deg:function(){return n="deg",1},rad:function(){return n="rad",1},sin:function(t){return i("sin",t.val)},cos:function(t){return i("cos",t.val)},tan:function(t){return i("tan",t.val)},asin:function(t){return i("asin",t.val)},acos:function(t){return i("acos",t.val)},atan:function(t){return i("atan",t.val)},arcsin:function(t){return i("asin",t.val)},arccos:function(t){return i("acos",t.val)},arctan:function(t){return i("atan",t.val)},atan2:function(t,e){return i("atan2",t.val,e?e.val:1)},acosh:function(t){return s.acosh(t.val)},asinh:function(t){return s.asinh(t.val)},atanh:function(t){return s.atanh(t.val)},arccosh:function(t){return s.acosh(t.val)},arcsinh:function(t){return s.asinh(t.val)},arctanh:function(t){return s.atanh(t.val)},cosh:function(t){return s.cosh(t.val)},sinh:function(t){return s.sinh(t.val)},tanh:function(t){return s.tanh(t.val)},abs:function(t){return s.abs(t.val)},cbrt:function(t){return s.cbrt(t.val)},ceil:function(t){return s.ceil(t.val)},exp:function(t){return s.exp(t.val)},expm1:function(t){return s.exp(t.val).minus(1)},floor:function(t){return s.floor(t.val)},hypot:function(){for(var t=[],e=0,i=arguments.length;e<i;e++)t.push(arguments[e].val);return s.hypot.apply(s,t)},ln:function(t){return s.ln(t.val)},log:function(){var t=(t=Array.from(arguments)).map(function(t){return t.val}).reverse();return s.log.apply(s,t)},log10:function(t){return s.log10(t.val)},logy:function(){var t=(t=Array.from(arguments)).map(function(t){return t.val}).reverse();return s.log.apply(s,t)},log2:function(t){return s.log2(t.val)},max:function(){var t=(t=Array.from(arguments)).map(function(t){return t.val});return s.max.apply(s,t)},min:function(){var t=(t=Array.from(arguments)).map(function(t){return t.val});return s.min.apply(s,t)},pow:function(t,e){return s.pow(t.val,e.val)},round:function(t){return s.round(t.val)},rand:function(t){try{return s.random(t?parseInt(t.val.toNumber()):s.precision)}catch(t){return new s(0)}},sign:function(t){return s.sign(t.val)},sqrt:function(t){return s.sqrt(t.val)},root:function(){var t=Array.from(arguments);if(2<=t.length){var e=s.pow(s.abs(t[1].val),s.div(1,t[0].val));return t[1].val.lt(0)?e.neg():e}return Math.sqrt(t[0].val)},root2:function(t){return s.sqrt(t.val)},root3:function(t){return s.cbrt(t.val)},rooty:function(t,e){t=s.pow(s.abs(e.val),s.div(1,t.val));return e.val.lt(0)?t.neg():t},trunc:function(t){return s.trunc(t.val)}}}(window);var MathParser=function(){function t(t,e,i,n){for(i=i||{},n=t.length;n--;i[t[n]]=e);return i}var e=[1,9],i=[1,6],n=[1,7],s=[1,8],o=[1,10],a=[1,11],r=[1,12],l=[1,13],h=[1,14],c=[1,15],u=[1,16],d=[1,17],p=[1,18],m=[1,19],f=[1,20],g=[1,21],v=[1,22],y=[1,23],b=[1,27],w=[1,28],_=[1,29],E=[1,30],S=[1,31],x=[1,32],k=[1,33],C=[1,34],O=[1,35],$=[1,36],I=[1,37],T=[1,38],L=[1,39],M=[5,9,10,11,13,16,17,19,20,21,22,23,24,25,26,27,40],N=[1,65],A=[13,16,40],D=[5,9,10,11,13,16,17,19,20,21,22,40],P=[5,9,13,16,20,21,40],F=[5,9,13,16,17,19,20,21,40],j=[5,9,10,11,13,16,17,19,20,21,22,23,24,25,40],M={trace:function(){},yy:{},symbols_:{error:2,expressions:3,DEG:4,EOF:5,RAD:6,e:7,number:8,"==":9,"%":10,"+":11,"(":12,")":13,"[":14,expseq:15,"]":16,"<":17,"=":18,">":19,NOT:20,"!=":21,"-":22,"*":23,"/":24,":":25,"^":26,"!":27,E:28,LN2:29,LN10:30,LOG2E:31,LOG10E:32,SQRT1_2:33,INFINITY:34,SQRT2:35,PI:36,HISTORY:37,FUNCTION:38,VARIABLE:39,";":40,NUMBER:41,DECIMAL:42,$accept:0,$end:1},terminals_:{2:"error",4:"DEG",5:"EOF",6:"RAD",9:"==",10:"%",11:"+",12:"(",13:")",14:"[",16:"]",17:"<",18:"=",19:">",20:"NOT",21:"!=",22:"-",23:"*",24:"/",25:":",26:"^",27:"!",28:"E",29:"LN2",30:"LN10",31:"LOG2E",32:"LOG10E",33:"SQRT1_2",34:"INFINITY",35:"SQRT2",36:"PI",37:"HISTORY",38:"FUNCTION",39:"VARIABLE",40:";",41:"NUMBER",42:"DECIMAL"},productions_:[0,[3,2],[3,2],[3,2],[7,1],[7,3],[7,2],[7,3],[7,3],[7,3],[7,4],[7,4],[7,4],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,3],[7,2],[7,2],[7,2],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,3],[7,4],[7,1],[7,3],[15,1],[15,3],[8,1],[8,3],[8,2],[8,2],[8,1]],performAction:function(t,e,i,n,s,o,a){var r,l=o.length-1;switch(s){case 1:q.deg();break;case 2:q.rad();break;case 3:return(void 0!==n.stack?n.stack:R).push(o[l-1]),o[l-1];case 4:isNaN(this.$)?this.$={t:"number",val:new CalculatorDecimal(0),start:a[l].first_column,end:a[l].last_column,tree:[o[l]]}:this.$={t:"number",val:new CalculatorDecimal(o[l]),start:a[l].first_column,end:a[l].last_column,tree:[o[l]]};break;case 5:this.$={t:"eq",val:new CalculatorDecimal(o[l-2].val.eq(o[l].val)?1:0),start:a[l-2].first_column,end:a[l].last_column,tree:[o[l-2],o[l-1],o[l]]};break;case 6:if(3===o[l-1].tree.length&&["+","*",":","/","^","-"].contains(o[l-1].tree[1])){var h,c=CalculatorDecimal.mul(o[l-1].tree[0].val,new CalculatorDecimal(.01).mul(o[l-1].tree[2].val));switch(o[l-1].tree[1]){case"+":h=CalculatorDecimal.add(o[l-1].tree[0].val,c);break;case"-":h=CalculatorDecimal.sub(o[l-1].tree[0].val,c);break;case"*":h=CalculatorDecimal.mul(o[l-1].tree[0].val,c);break;case":":case"/":h=CalculatorDecimal.div(o[l-1].tree[0].val,c);break;case"^":h=CalculatorDecimal.pow(o[l-1].tree[0].val,c)}this.$={t:"%",val:h,start:a[l-1].first_column,end:a[l].last_column,tree:[o[l-1],o[l]]}}else this.$={t:"%",val:CalculatorDecimal.mul(o[l-1].val,new CalculatorDecimal(.01)),start:a[l-1].first_column,end:a[l].last_column,tree:[o[l-1],o[l]]};break;case 7:this.$={t:"add",val:CalculatorDecimal.add(o[l-2].val,o[l].val),start:a[l-2].first_column,end:a[l].last_column,tree:[o[l-2],o[l-1],o[l]]};break;case 8:this.$={t:"parentheses",val:o[l-1].val,start:a[l-2].first_column,end:a[l].last_column,tree:[o[l-2],o[l-1],o[l]]};break;case 9:this.$={t:"expseq",val:o[l-1].val,start:a[l-2].first_column,end:a[l].last_column,tree:[o[l-2],o[l-1],o[l]]};break;case 10:this.$={t:"leq",val:new CalculatorDecimal(o[l-3].val.lte(o[l].val)?1:0),start:a[l-3].first_column,end:a[l].last_column,tree:[o[l-3],o[l-2],o[l-1],o[l]]};break;case 11:this.$={t:"geq",val:new CalculatorDecimal(o[l-3].val.gte(o[l].val)?1:0),start:a[l-3].first_column,end:a[l].last_column,tree:[o[l-3],o[l-2],o[l-1],o[l]]};break;case 12:this.$={t:"neq",val:new CalculatorDecimal(o[l-3].val.eq(o[l-1].val)?0:1),start:a[l-3].first_column,end:a[l].last_column,tree:[o[l-3],o[l-2],o[l-1],o[l]]};break;case 13:case 14:this.$={t:"neq",val:new CalculatorDecimal(o[l-2].val.eq(o[l].val)?0:1),start:a[l-2].first_column,end:a[l].last_column,tree:[o[l-2],o[l-1],o[l]]};break;case 15:this.$={t:"gt",val:new CalculatorDecimal(o[l-2].val.gt(o[l].val)?1:0),start:a[l-2].first_column,end:a[l].last_column,tree:[o[l-2],o[l-1],o[l]]};break;case 16:this.$={t:"lt",val:new CalculatorDecimal(o[l-2].val.lt(o[l].val)?1:0),start:a[l-2].first_column,end:a[l].last_column,tree:[o[l-2],o[l-1],o[l]]};break;case 17:this.$={t:"min",val:CalculatorDecimal.sub(o[l-2].val,o[l].val),start:a[l-2].first_column,end:a[l].last_column,tree:[o[l-2],o[l-1],o[l]]};break;case 18:this.$={t:"mul",val:CalculatorDecimal.mul(o[l-2].val,o[l].val),start:a[l-2].first_column,end:a[l].last_column,tree:[o[l-2],o[l-1],o[l]]};break;case 19:case 20:this.$={t:"div",val:CalculatorDecimal.div(o[l-2].val,o[l].val),start:a[l-2].first_column,end:a[l].last_column,tree:[o[l-2],o[l-1],o[l]]};break;case 21:this.$={t:"pow",val:CalculatorDecimal.pow(o[l-2].val,o[l].val),start:a[l-2].first_column,end:a[l].last_column,tree:[o[l-2],o[l-1],o[l]]};break;case 22:this.$={t:"neg",val:CalculatorDecimal.mul(o[l].val,-1),start:a[l-1].first_column,end:a[l].last_column,tree:[o[l-1],o[l]]},isNaN(this.$.val)&&(this.$.val=0);break;case 23:this.$={t:"pos",val:new CalculatorDecimal(o[l].val),start:a[l-1].first_column,end:a[l].last_column,tree:[o[l-1],o[l]]},isNaN(this.$.val)&&(this.$.val=new CalculatorDecimal(0));break;case 24:var u=function t(e){return e.isZero()?new CalculatorDecimal(1):CalculatorDecimal.mul(t(CalculatorDecimal.sub(e,1)),e)}(o[l-1].val);this.$={t:"pos",val:u,start:a[l-1].first_column,end:a[l].last_column,tree:[o[l-1],o[l]]};break;case 25:this.$={t:"sym",val:CalculatorDecimal.exp(1),start:a[l].first_column,end:a[l].last_column,tree:[o[l]]};break;case 26:this.$={t:"sym",val:CalculatorDecimal.ln(2),start:a[l].first_column,end:a[l].last_column,tree:[o[l]]};break;case 27:this.$={t:"sym",val:CalculatorDecimal.ln(10),start:a[l].first_column,end:a[l].last_column,tree:[o[l]]};break;case 28:this.$={t:"sym",val:CalculatorDecimal.log2(CalculatorDecimal.exp(1)),start:a[l].first_column,end:a[l].last_column,tree:[o[l]]};break;case 29:this.$={t:"sym",val:CalculatorDecimal.log10(CalculatorDecimal.exp(1)),start:a[l].first_column,end:a[l].last_column,tree:[o[l]]};break;case 30:this.$={t:"sym",val:CalculatorDecimal.div(1,CalculatorDecimal.sqrt(2)),start:a[l].first_column,end:a[l].last_column,tree:[o[l]]};break;case 31:this.$={t:"sym",val:new CalculatorDecimal(1/0),start:a[l].first_column,end:a[l].last_column,tree:[o[l]]};break;case 32:this.$={t:"sym",val:CalculatorDecimal.sqrt(2),start:a[l].first_column,end:a[l].last_column,tree:[o[l]]};break;case 33:this.$={t:"sym",val:CalculatorDecimal.acos(-1),start:a[l].first_column,end:a[l].last_column,tree:[o[l]]};break;case 34:var d=void 0!==n.stack?n.stack:R;0==d.length?this.$=0:(u=o[l].match(/^(?:#|ans)(\d+)$/))?(u=u[1].toInt(),d[--u]?this.$=d[u]:this.$=0):this.$=d[d.length-1],this.$={t:"hist",val:this.$.val,start:a[l].first_column,end:a[l].last_column,tree:[o[l]],ref:this.$};break;case 35:this.$=function(t){return"function"==typeof q[t]?+q[t].apply(n.context||this):0}(o[l-2]),isNaN(this.$)&&(this.$=0),this.$={t:"func",val:this.$,start:a[l-2].first_column,end:a[l].last_column,tree:[o[l-2],o[l-1],o[l]]};break;case 36:this.$=function(t,e){return"function"==typeof q[o[l-3]]?+q[t].apply(n.context||this,e):0}(o[l-3],o[l-1].val),isNaN(this.$)&&(this.$=0),this.$={t:"func",val:this.$,start:a[l-3].first_column,end:a[l].last_column,tree:[o[l-3],o[l-2],o[l-1],o[l]]};break;case 37:this.$=(r=o[l],void 0!==n.variables?void 0!==n.variables[r]?n.variables[r]:0:void 0!==z[r]?z[r]:0),this.$={t:"var",val:this.$.val,start:a[l].first_column,end:a[l].last_column,tree:[o[l]]};break;case 38:this.$=(d=o[l-2],r=o[l],void 0!==n.variables?n.variables[d]=r:z[d]=r,r),this.$={t:"set",val:this.$.val,start:a[l-2].first_column,end:a[l].last_column,tree:[o[l-2],o[l-1],o[l]]};break;case 39:this.$={t:"expseq",val:[o[l]],start:a[l].first_column,end:a[l].last_column,tree:[o[l]]};break;case 40:o[l-2].val.push(o[l]),o[l-2].tree.push(";"),o[l-2].tree.push(o[l]),this.$=o[l-2];break;case 41:this.$=new CalculatorDecimal(o[l]);break;case 42:this.$=new CalculatorDecimal(o[l-2]+"."+o[l]);break;case 43:this.$=new CalculatorDecimal("0."+o[l]);break;case 44:this.$=new CalculatorDecimal(o[l-1]+".0");break;case 45:this.$=new CalculatorDecimal("0.0")}},table:[{3:1,4:[1,2],6:[1,3],7:4,8:5,11:e,12:i,14:n,22:s,28:o,29:a,30:r,31:l,32:h,33:c,34:u,35:d,36:p,37:m,38:f,39:g,41:v,42:y},{1:[3]},{5:[1,24]},{5:[1,25]},{5:[1,26],9:b,10:w,11:_,17:E,19:S,20:x,21:k,22:C,23:O,24:$,25:I,26:T,27:L},t(M,[2,4]),{7:40,8:5,11:e,12:i,14:n,22:s,28:o,29:a,30:r,31:l,32:h,33:c,34:u,35:d,36:p,37:m,38:f,39:g,41:v,42:y},{7:42,8:5,11:e,12:i,14:n,15:41,22:s,28:o,29:a,30:r,31:l,32:h,33:c,34:u,35:d,36:p,37:m,38:f,39:g,41:v,42:y},{7:43,8:5,11:e,12:i,14:n,22:s,28:o,29:a,30:r,31:l,32:h,33:c,34:u,35:d,36:p,37:m,38:f,39:g,41:v,42:y},{7:44,8:5,11:e,12:i,14:n,22:s,28:o,29:a,30:r,31:l,32:h,33:c,34:u,35:d,36:p,37:m,38:f,39:g,41:v,42:y},t(M,[2,25]),t(M,[2,26]),t(M,[2,27]),t(M,[2,28]),t(M,[2,29]),t(M,[2,30]),t(M,[2,31]),t(M,[2,32]),t(M,[2,33]),t(M,[2,34]),{12:[1,45]},t(M,[2,37],{18:[1,46]}),t(M,[2,41],{42:[1,47]}),t(M,[2,45],{41:[1,48]}),{1:[2,1]},{1:[2,2]},{1:[2,3]},{7:49,8:5,11:e,12:i,14:n,22:s,28:o,29:a,30:r,31:l,32:h,33:c,34:u,35:d,36:p,37:m,38:f,39:g,41:v,42:y},t(M,[2,6]),{7:50,8:5,11:e,12:i,14:n,22:s,28:o,29:a,30:r,31:l,32:h,33:c,34:u,35:d,36:p,37:m,38:f,39:g,41:v,42:y},{7:53,8:5,11:e,12:i,14:n,18:[1,51],19:[1,52],22:s,28:o,29:a,30:r,31:l,32:h,33:c,34:u,35:d,36:p,37:m,38:f,39:g,41:v,42:y},{7:55,8:5,11:e,12:i,14:n,18:[1,54],22:s,28:o,29:a,30:r,31:l,32:h,33:c,34:u,35:d,36:p,37:m,38:f,39:g,41:v,42:y},{7:56,8:5,11:e,12:i,14:n,22:s,28:o,29:a,30:r,31:l,32:h,33:c,34:u,35:d,36:p,37:m,38:f,39:g,41:v,42:y},{7:57,8:5,11:e,12:i,14:n,22:s,28:o,29:a,30:r,31:l,32:h,33:c,34:u,35:d,36:p,37:m,38:f,39:g,41:v,42:y},{7:58,8:5,11:e,12:i,14:n,22:s,28:o,29:a,30:r,31:l,32:h,33:c,34:u,35:d,36:p,37:m,38:f,39:g,41:v,42:y},{7:59,8:5,11:e,12:i,14:n,22:s,28:o,29:a,30:r,31:l,32:h,33:c,34:u,35:d,36:p,37:m,38:f,39:g,41:v,42:y},{7:60,8:5,11:e,12:i,14:n,22:s,28:o,29:a,30:r,31:l,32:h,33:c,34:u,35:d,36:p,37:m,38:f,39:g,41:v,42:y},{7:61,8:5,11:e,12:i,14:n,22:s,28:o,29:a,30:r,31:l,32:h,33:c,34:u,35:d,36:p,37:m,38:f,39:g,41:v,42:y},{7:62,8:5,11:e,12:i,14:n,22:s,28:o,29:a,30:r,31:l,32:h,33:c,34:u,35:d,36:p,37:m,38:f,39:g,41:v,42:y},t(M,[2,24]),{9:b,10:w,11:_,13:[1,63],17:E,19:S,20:x,21:k,22:C,23:O,24:$,25:I,26:T,27:L},{16:[1,64],40:N},t(A,[2,39],{9:b,10:w,11:_,17:E,19:S,20:x,21:k,22:C,23:O,24:$,25:I,26:T,27:L}),t(D,[2,22],{23:O,24:$,25:I,26:T,27:L}),t(D,[2,23],{23:O,24:$,25:I,26:T,27:L}),{7:42,8:5,11:e,12:i,13:[1,66],14:n,15:67,22:s,28:o,29:a,30:r,31:l,32:h,33:c,34:u,35:d,36:p,37:m,38:f,39:g,41:v,42:y},{7:68,8:5,11:e,12:i,14:n,22:s,28:o,29:a,30:r,31:l,32:h,33:c,34:u,35:d,36:p,37:m,38:f,39:g,41:v,42:y},t(M,[2,44],{41:[1,69]}),t(M,[2,43]),t(P,[2,5],{10:w,11:_,17:E,19:S,22:C,23:O,24:$,25:I,26:T,27:L}),t(D,[2,7],{23:O,24:$,25:I,26:T,27:L}),{7:70,8:5,11:e,12:i,14:n,22:s,28:o,29:a,30:r,31:l,32:h,33:c,34:u,35:d,36:p,37:m,38:f,39:g,41:v,42:y},{7:71,8:5,11:e,12:i,14:n,22:s,28:o,29:a,30:r,31:l,32:h,33:c,34:u,35:d,36:p,37:m,38:f,39:g,41:v,42:y},t(F,[2,16],{10:w,11:_,22:C,23:O,24:$,25:I,26:T,27:L}),{7:72,8:5,11:e,12:i,14:n,22:s,28:o,29:a,30:r,31:l,32:h,33:c,34:u,35:d,36:p,37:m,38:f,39:g,41:v,42:y},t(F,[2,15],{10:w,11:_,22:C,23:O,24:$,25:I,26:T,27:L}),t(P,[2,13],{10:w,11:_,17:E,19:S,22:C,23:O,24:$,25:I,26:T,27:L}),t(P,[2,14],{10:w,11:_,17:E,19:S,22:C,23:O,24:$,25:I,26:T,27:L}),t(D,[2,17],{23:O,24:$,25:I,26:T,27:L}),t(j,[2,18],{26:T,27:L}),t(j,[2,19],{26:T,27:L}),t(j,[2,20],{26:T,27:L}),t(j,[2,21],{26:T,27:L}),t(M,[2,8]),t(M,[2,9]),{7:73,8:5,11:e,12:i,14:n,22:s,28:o,29:a,30:r,31:l,32:h,33:c,34:u,35:d,36:p,37:m,38:f,39:g,41:v,42:y},t(M,[2,35]),{13:[1,74],40:N},t([5,13,16,40],[2,38],{9:b,10:w,11:_,17:E,19:S,20:x,21:k,22:C,23:O,24:$,25:I,26:T,27:L}),t(M,[2,42]),t(F,[2,10],{10:w,11:_,22:C,23:O,24:$,25:I,26:T,27:L}),t(F,[2,12],{10:w,11:_,22:C,23:O,24:$,25:I,26:T,27:L}),t(F,[2,11],{10:w,11:_,22:C,23:O,24:$,25:I,26:T,27:L}),t(A,[2,40],{9:b,10:w,11:_,17:E,19:S,20:x,21:k,22:C,23:O,24:$,25:I,26:T,27:L}),t(M,[2,36])],defaultActions:{24:[2,1],25:[2,2],26:[2,3]},parseError:function(t,e){if(!e.recoverable){var i=new Error(t);throw i.hash=e,i}this.trace(t)},parse:function(t){var e,i=this,n=[0],s=[null],o=[],a=this.table,r="",l=0,h=0,c=0,u=1,d=o.slice.call(arguments,1),p=Object.create(this.lexer),m={yy:{}};for(e in this.yy)Object.prototype.hasOwnProperty.call(this.yy,e)&&(m.yy[e]=this.yy[e]);p.setInput(t,m.yy),m.yy.lexer=p,m.yy.parser=this,void 0===p.yylloc&&(p.yylloc={});var f=p.yylloc;o.push(f);var g=p.options&&p.options.ranges;"function"==typeof m.yy.parseError?this.parseError=m.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var v,y,b,w,_,E,S,x=function(){var t=p.lex()||u;return t="number"!=typeof t?i.symbols_[t]||t:t},k={};;){if(b=n[n.length-1],void 0===(w=this.defaultActions[b]||(null==v&&(v=x()),a[b]&&a[b][v]))||!w.length||!w[0]){var C="",O=[];for(E in a[b])this.terminals_[E]&&2<E&&O.push("'"+this.terminals_[E]+"'");C=p.showPosition?"Parse error on line "+(l+1)+":\n"+p.showPosition()+"\nExpecting "+O.join(", ")+", got '"+(this.terminals_[v]||v)+"'":"Parse error on line "+(l+1)+": Unexpected "+(v==u?"end of input":"'"+(this.terminals_[v]||v)+"'"),this.parseError(C,{text:p.match,token:this.terminals_[v]||v,line:p.yylineno,loc:f,expected:O})}if(w[0]instanceof Array&&1<w.length)throw new Error("Parse Error: multiple actions possible at state: "+b+", token: "+v);switch(w[0]){case 1:n.push(v),s.push(p.yytext),o.push(p.yylloc),n.push(w[1]),v=null,y?(v=y,y=null):(h=p.yyleng,r=p.yytext,l=p.yylineno,f=p.yylloc,0<c&&c--);break;case 2:if(S=this.productions_[w[1]][1],k.$=s[s.length-S],k._$={first_line:o[o.length-(S||1)].first_line,last_line:o[o.length-1].last_line,first_column:o[o.length-(S||1)].first_column,last_column:o[o.length-1].last_column},g&&(k._$.range=[o[o.length-(S||1)].range[0],o[o.length-1].range[1]]),void 0!==(_=this.performAction.apply(k,[r,h,l,m.yy,w[1],s,o].concat(d))))return _;S&&(n=n.slice(0,-1*S*2),s=s.slice(0,-1*S),o=o.slice(0,-1*S)),n.push(this.productions_[w[1]][0]),s.push(k.$),o.push(k._$),S=a[n[n.length-2]][n[n.length-1]],n.push(S);break;case 3:return!0}}return!0}},z={},R=[],q=window.CalculatorFunctions||{};function H(){this.yy={}}return M.lexer={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t,e){return this.yy=e||this.yy||{},this._input=t,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];return this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t,t.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,i=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e),this.offset-=e;var n=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),i.length-1&&(this.yylineno-=i.length-1);t=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:i?(i.length===n.length?this.yylloc.first_column:0)+n[n.length-i.length].length-i[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[t[0],t[0]+this.yyleng-e]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(20<t.length?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(20<t.length?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},test_match:function(t,e){var i,n;if(this.options.backtrack_lexer&&(n={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(n.yylloc.range=this.yylloc.range.slice(0))),(i=t[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=i.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:i?i[i.length-1].length-i[i.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],e=this.performAction.call(this,this.yy,this,e,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),e)return e;if(this._backtrack){for(var s in n)this[s]=n[s];return!1}return!1},next:function(){if(this.done)return this.EOF;var t,e,i,n;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var s=this._currentRules(),o=0;o<s.length;o++)if((i=this._input.match(this.rules[s[o]]))&&(!e||i[0].length>e[0].length))if(e=i,n=o,this.options.backtrack_lexer){if(!1!==(t=this.test_match(i,s[o])))return t;if(!this._backtrack)return!1;e=!1}else if(!this.options.flex)break;return e?!1!==(t=this.test_match(e,s[n]))&&t:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return t||this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return 0<this.conditionStack.length-1?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return(this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]]:this.conditions.INITIAL).rules},topState:function(t){return 0<=(t=this.conditionStack.length-1-Math.abs(t||0))?this.conditionStack[t]:"INITIAL"},pushState:function(t){this.begin(t)},stateStackSize:function(){return this.conditionStack.length},options:{"case-insensitive":!0},performAction:function(t,e,i,n){switch(i){case 0:break;case 1:case 2:case 3:return 41;case 4:break;case 5:return 42;case 6:return 25;case 7:return 40;case 8:return",";case 9:return 23;case 10:return 24;case 11:return 22;case 12:return 11;case 13:return 26;case 14:return 12;case 15:return 13;case 16:return 19;case 17:return 17;case 18:return 20;case 19:return 36;case 20:return 28;case 21:return 29;case 22:return 34;case 23:return 30;case 24:return 31;case 25:return 32;case 26:return 33;case 27:return 35;case 28:return 4;case 29:return 6;case 30:return"!=";case 31:return"!";case 32:return 9;case 33:return 18;case 34:return 10;case 35:case 36:case 37:case 38:return 37;case 39:return 38;case 40:return 39;case 41:return 38;case 42:case 43:return 39;case 44:return 5}},rules:[/^(?:\s+)/i,/^(?:[0-9]+\.[0-9]+e\+[0-9]+)/i,/^(?:[0-9]+e\+[0-9]+)/i,/^(?:[0-9]+)/i,/^(?:\$)/i,/^(?:[.])/i,/^(?::)/i,/^(?:;)/i,/^(?:,)/i,/^(?:\*)/i,/^(?:\/)/i,/^(?:-)/i,/^(?:\+)/i,/^(?:\^)/i,/^(?:\()/i,/^(?:\))/i,/^(?:>)/i,/^(?:<)/i,/^(?:not\b)/i,/^(?:pi\b)/i,/^(?:e\b)/i,/^(?:ln2\b)/i,/^(?:infinity\b)/i,/^(?:LN10\b)/i,/^(?:LOG2E\b)/i,/^(?:LOG10E\b)/i,/^(?:SQRT1_2\b)/i,/^(?:SQRT2\b)/i,/^(?:DEG\b)/i,/^(?:RAD\b)/i,/^(?:!=)/i,/^(?:!)/i,/^(?:==)/i,/^(?:=)/i,/^(?:%)/i,/^(?:[\#]([0-9]+))/i,/^(?:[\#]{1,2})/i,/^(?:ans([0-9]+))/i,/^(?:ans\b)/i,/^(?:[A-Za-z]{1,}[A-Za-z_0-9]+(?=[(]))/i,/^(?:[A-Za-z\$]+[0-9]+)/i,/^(?:[A-Za-z]+(?=[(]))/i,/^(?:[A-Za-z\$]{1,}[A-Za-z_0-9\$]+)/i,/^(?:[A-Za-z_\$]+)/i,/^(?:$)/i],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],inclusive:!0}}},new((H.prototype=M).Parser=H)}();"undefined"!=typeof require&&"undefined"!=typeof exports&&(exports.parser=MathParser,exports.Parser=MathParser.Parser,exports.parse=function(){return MathParser.parse.apply(MathParser,arguments)},exports.main=function(t){t[1]||process.exit(1);t=require("fs").readFileSync(require("path").normalize(t[1]),"utf8");return exports.parser.parse(t)},"undefined"!=typeof module&&require.main===module&&exports.main(process.argv.slice(1)));var Calculator=new Class({Implements:[Options,Events],Binds:["trigger","showFormTrigger","hideFormTrigger","onScroll","predictTarget"],options:{trigger:"a.calculator, button.calculator, span.calculator",trigger_scope:"form, .widget",mode:"rad",type:"scienfific",decimal:"auto",colors:["#5d21d9","#21c5d9","#21d92e","#d9d721","#d98421","#d92121","#89d921","#213fd9","#d921c5"]},states:{},keys:{},forms:[],panels:[],element:null,formtrigger:!1,target:!1,lastActive:!1,lastSelection:{start:0,end:0,type:"none"},log:!1,initialize:function(t){if(void 0===MathParser)throw new Error("MathParser is undefined.");MathParser.yy={variables:{},stack:[],cursor:{last:"",pos:0},historyAdded:!1,context:this},this.setOptions(t),"auto"===this.options.decimal&&(this.options.decimal=Locale.get("Number.decimal")),this.options.element?($(this.options.element).addEvent("click:relay("+this.options.trigger+")",this.trigger),$(this.options.element).addEvent("mousedown:relay("+this.options.trigger+")",this.predictTarget),$(this.options.element).addEvent("focus:relay(textarea, input[type=text])",this.showFormTrigger),$(this.options.element).addEvent("blur:relay(textarea, input[type=text])",this.hideFormTrigger)):(document.body.addEvent("click:relay("+this.options.trigger+")",this.trigger),document.body.addEvent("mousedown:relay("+this.options.trigger+")",this.predictTarget),document.body.addEvent("focus:relay(textarea, input[type=text])",this.showFormTrigger),document.body.addEvent("blur:relay(textarea, input[type=text])",this.hideFormTrigger))},destroy:function(){this.options.element?($(this.options.element).removeEvent("click:relay("+this.options.trigger+")",this.trigger),$(this.options.element).removeEvent("mousedown:relay("+this.options.trigger+")",this.predictTarget),$(this.options.element).removeEvent("focus:relay(textarea, input[type=text])",this.showFormTrigger),$(this.options.element).removeEvent("blur:relay(textarea, input[type=text])",this.hideFormTrigger)):(document.body.removeEvent("click:relay("+this.options.trigger+")",this.trigger),document.body.removeEvent("mousedown:relay("+this.options.trigger+")",this.predictTarget),document.body.removeEvent("focus:relay(textarea, input[type=text])",this.showFormTrigger),document.body.removeEvent("blur:relay(textarea, input[type=text])",this.hideFormTrigger))},predictTarget:function(){if(this.lastActive=document.activeElement,["textarea","input"].contains(this.lastActive.tagName.toLowerCase()))this.lastSelection={start:this.lastActive.selectionStart,end:this.lastActive.selectionEnd,type:"input"};else if(this.lastActive.closest(".CodeMirror")){var t=this.lastActive.closest(".CodeMirror").CodeMirror;this.lastSelection={type:"codemirror",selections:t.doc.listSelections(),instance:t}}else if(this.lastActive.closest(".mce-tinymce"))try{var e=this.lastActive.closest(".mce-tinymce").parentNode.querySelector("textarea"),i=window.tinyMCE.get(e.id);this.lastActive=e,this.lastSelection={type:"tinymce",instance:i}}catch(t){}else this.lastSelection={start:0,end:0,type:"none"}},trigger:function(t,e,i){if(!e)if(t.target.match(this.options.trigger))e=t.target;else if(!(e=t.target.getParent(this.options.trigger)))return;t.preventDefault();t=e.get("id");if(t||(t=String.uniqueID(),e.set("id",t)),this.target=!1,i){i=document.body.getElement(i);i&&(this.target=i)}else if(!1!==this.lastActive&&"none"!==this.lastSelection.type)this.target=this.lastActive;else if(e.form){var n,s=e.form.querySelectorAll("input, textarea");for(n of s.values())if(""===n.value||1==s.length){if(n.parentNode.querySelector(".CodeMirror")){var o=n.parentNode.querySelector(".CodeMirror").CodeMirror;this.lastActive=n,this.lastSelection={type:"codemirror",selections:o.doc.listSelections(),instance:o}}else if(n.id&&void 0!==window.tinyMCE)try{var a=window.tinyMCE.get(n.id);a&&(this.lastActive=n,this.lastSelection={type:"tinymce",instance:a})}catch(t){}this.target=n;break}}e.hasClass("mode-rad")?this.options.mode="rad":this.options.mode="deg",this.loadState(t),this.element&&this.element.isVisible()?this.close():this.show(e.hasClass("extended"))},formatNumber:function(t){t=t.toString();return t=","===this.options.decimal?(t=(t=t.replace(".","x")).replace(",",".")).replace("x",","):t},loadState:function(t){this.states[t]||(this.states[t]={variables:{},stack:[],cursor:{last:"",pos:0},historyAdded:!1,context:this}),MathParser.yy=this.states[t],this.state=this.states[t],"deg"===this.options.mode?this.safeParse("DEG"):this.safeParse("RAD"),0<this.state.stack.length?(t=this.state.stack[this.state.stack.length-1],this.result.set("text",this.formatNumber(t.val)),this.resultLabel.set("html",this.printTree(t)+" = "),this.resultLabel.createTooltips(),this.createTargetButton(),this.resetCursor(),this.focus(),this.input.set("value",this.formatNumber(t.val)),this.input.selectRange(0,this.input.get("value").length),this.input.removeClass("warning"),this.log&&this.history()):this.result&&(this.result.set("text",""),this.resultLabel.set("html",""),this.input.set("value",""))},show:function(t){t=!!t;var e=!1,i=!this.element;i||this.locale!=$I18N.options.locale?(this.build(),e=!0,this.locale=$I18N.options.locale,t?(this.element.addClass("extended").removeClass("simple"),this.element.getElements(".extendedonly").each(function(t){t.show()})):(this.element.addClass("simple").removeClass("extended"),this.element.getElements(".extendedonly").each(function(t){t.hide()})),i&&(this.openhistory&&this.openhistory.removeClass("disabled"),this.log&&this.history(),0<this.state.stack.length&&(i=this.state.stack[this.state.stack.length-1],this.input.set("value",this.formatNumber(i.val)),this.input.selectRange(0,this.input.get("value").length),this.result.set("text",this.formatNumber(i.val)),this.resultLabel.set("html",this.printTree(i)+" = "),this.resultLabel.createTooltips(),this.createTargetButton()))):t?(this.element.addClass("extended").removeClass("simple"),this.element.getElements(".extendedonly").each(function(t){t.show()})):(this.element.addClass("simple").removeClass("extended"),this.element.getElements(".extendedonly").each(function(t){t.hide()})),!this.element.isVisible()||e?(this.element.show(),this.position(),this.input.focus(),window.addEvent("scroll",this.onScroll)):this.position(),$$("div.calculator_container").each(function(t){this.element!==t&&t.$calculator.close()}.bind(this)),this.element.createTooltips()},close:function(t){t&&t.preventDefault();try{this.removeTooltips(this.element)}catch(t){}return this.element.destroy(),delete this.element,window.removeEvent("scroll",this.onScroll),!1},build:function(){if(this.element)return!1;this.element=new Element("div.calculator_container.unshift"),document.body.grab(this.element),(this.element.$calculator=this).topmenu=new Element("div.topmenu"),this.topmenu.grab(new Element("a.mbutton.dragger",{html:'<span class="fas fa-arrows-alt"></span>'})),this.topmenu.grab(new Element("a.mbutton.close.tooltip",{href:"#",events:{click:this.close.bind(this)},title:$I18N.t("Close the calculator"),html:'<span class="fas fa-times"></span>'})),this.element.grab(this.topmenu),this.output=new Element("div.output"),this.element.grab(this.output),"rad"===this.options.mode?this.element.addClass("radmode"):this.element.addClass("degmode"),this.input=new Element("input.calculator_input.monospace",{type:"text",name:"calculator_input",events:{keypress:this.onKeyPress.bind(this),keyup:function(t){return"up"===t.key||"down"==t.key?this.onKeyPress(t,!0):(this.removeWarningClass(),!0)}.bind(this),keydown:function(t){return"up"!==t.key&&"down"!=t.key||(t.preventDefault(),!1)}}}),this.output.grab(this.input),this.resultContainer=new Element("div.result.monospace",{styles:{display:"block"}}),this.output.grab(this.resultContainer),this.resultLabel=new Element("span.resultlabel.calculation",{html:"&nbsp;"}),this.resultContainer.grab(this.resultLabel),this.result=new Element("div.result_data",{html:"&nbsp;"}),this.resultContainer.grab(this.result),this.menu=new Element("div.menu"),this.output.grab(this.menu),this.menu.grab(new Element("span.fleft.mode.extendedonly",{html:this.options.mode})),this.openhistory=new Element("a.mbutton.history.tooltip.extendedonly.disabled",{href:"#",events:{click:this.history.bind(this)},title:$I18N.t("Show previous calculations"),html:'<span class="fas fa-history"></span>'}),this.menu.grab(this.openhistory),this.menu.createTooltips(),this.extended=new Element("div.extended.monospace"),this.element.grab(this.extended),this.simple=new Element("div.simple.monospace"),this.element.grab(this.simple);for(var t=[[{button:"C",tooltip:$I18N.t("Start over"),action:this.actionClear.bind(this)},{button:"&plusmn;",tooltip:$I18N.t("Negate input (or press: _)"),action:this.actionNegate.bind(this),key:"_"},{button:"%",tooltip:$I18N.t("Percent (or press: %)"),action:this.actionPercentage.pass("%",this),key:"%"},{button:"&divide;",class:"notbold",tooltip:$I18N.t("Devide (or press: /)"),action:this.actionAddOperator.pass("/",this),key:"/"}],[{button:"7",tooltip:$I18N.t("Seven (or press: 7)"),action:this.actionAdd.pass(7,this),key:"7"},{button:"8",tooltip:$I18N.t("Eight (or press: 8)"),action:this.actionAdd.pass(8,this),key:"8"},{button:"9",tooltip:$I18N.t("Nine (or press: 9)"),action:this.actionAdd.pass(9,this),key:"9"},{button:"&times;",tooltip:$I18N.t("Multiply (or press: *)"),action:this.actionAddOperator.pass("*",this),key:"*"}],[{button:"4",tooltip:$I18N.t("Four (or press: 4)"),action:this.actionAdd.pass(4,this),key:"4"},{button:"5",tooltip:$I18N.t("Five (or press: 5)"),action:this.actionAdd.pass(5,this),key:"5"},{button:"6",tooltip:$I18N.t("Six (or press: 6)"),action:this.actionAdd.pass(6,this),key:"6"},{button:"&plus;",tooltip:$I18N.t("Add (or press: +)"),action:this.actionAddOperator.pass("+",this),key:"+"}],[{button:"1",tooltip:$I18N.t("One (or press: 1)"),action:this.actionAdd.pass(1,this),key:"1"},{button:"2",tooltip:$I18N.t("Two (or press: 2)"),action:this.actionAdd.pass(2,this),key:"2"},{button:"3",tooltip:$I18N.t("Three (or press: 3)"),action:this.actionAdd.pass(3,this),key:"3"},{button:"&minus;",tooltip:$I18N.t("Substract (or press: -)"),action:this.actionAddOperator.pass("-",this),key:"-"}],[{button:"( )",tooltip:$I18N.t("Parentheses (or press: ( )"),action:this.actionAddParentheses.bind(this),key:"("},{button:"0",tooltip:$I18N.t("Zero (or press: 0)"),action:this.actionAdd.pass(0,this),key:"0"},{button:this.options.decimal,tooltip:$I18N.t("Decimal (or press: {0})",[this.options.decimal]),action:this.actionAddDecimal.bind(this),key:this.options.decimal},{button:"=",class:"run",tooltip:$I18N.t("Calculate (or press: enter)"),action:this.runAction.bind(this),key:"enter"}]],e=[[{button:"ln(2)",class:"smallfont",tooltip:$I18N.t("Insert the natural logarithm of 2 (approx. 0.639)"),action:this.actionAdd.pass("ln2",this)},{button:"ln(10)",class:"smallfont",tooltip:$I18N.t("Insert the natural logarithm of 10 (approx. 2.302)"),action:this.actionAdd.pass("ln10",this)},{button:"<sup>2</sup>log(e)",class:"supersmallfont",tooltip:$I18N.t("Insert the base 2 logarithm of e (approx. 1.442)"),action:this.actionAdd.pass("log(2;e)",this)},{button:"<sup>10</sup>log(e)",class:"supersmallfont",tooltip:$I18N.t("Insert the base 10 logarithm of e (approx. 0.434)"),action:this.actionAdd.pass("log(e)",this)},{button:'&radic;<span class="smallfont overline">&frac12;</span>',tooltip:$I18N.t("Insert the square root of 1/2 (approx. 0.707)"),action:this.actionAdd.pass("√(1/2)",this)},{button:'&radic;<span class="smallfont overline">2</span>',tooltip:$I18N.t("Insert the square root of 2 (approx. 1.414)"),action:this.actionAdd.pass("√(2)",this)}],[{button:"x!",tooltip:$I18N.t("Calculate the factorial of x"),action:this.actionAddOperator.pass(["!"],this)},{button:"x<sup>2</sup>",tooltip:$I18N.t("Calculate x to the power of 2"),action:this.actionAddOperator.pass(["^",2],this)},{button:"x<sup>3</sup>",tooltip:$I18N.t("Calculate x to the power of 3"),action:this.actionAddOperator.pass(["^",3],this)},{button:"x<sup>y</sup>",tooltip:$I18N.t("Calculate x to the power of Y"),action:this.actionAddOperator.pass("^",this)},{button:"e<sup>x</sup>",tooltip:$I18N.t("Calculate e to the power of x"),action:this.actionAddOperator.pass(["e","^"],this)},{button:"10<sup>x</sup>",tooltip:$I18N.t("Calculate 10 to the power of x"),action:this.actionAddOperator.pass([10,"^"],this)}],[{button:"<sup>1</sup>/<sub>x</sub>",tooltip:$I18N.t("Calculate the inverse"),action:this.actionAddOperator.pass([1,"/"],this)},{button:'&radic;<span class="smallfont overline">x</span>',tooltip:$I18N.t("Square root"),action:this.actionAddFunction.pass(["√"],this)},{button:'<sup>3</sup>&radic;<span class="smallfont overline">x</span>',tooltip:$I18N.t("Cubic root"),action:this.actionAddFunction.pass(["√",[3,"x"]],this)},{button:'<sup>y</sup>&radic;<span class="smallfont overline">x</span>',tooltip:$I18N.t("Calculate the Yth root (formula usage: √(y ; x)"),action:this.actionAddFunction.pass(["√",["y","x"]],this)},{button:"ln",tooltip:$I18N.t("Calculate the natural logarithm"),action:this.actionAddFunction.pass(["ln"],this)},{button:"<sup>10</sup>log",tooltip:$I18N.t("Calculate the base 10 logarithm"),action:this.actionAddFunction.pass(["log10"],this)}],[[{button:"rad",class:"rad",tooltip:$I18N.t('Switch to "radians" mode'),action:this.actionSetMode.pass("rad",this)},{button:"deg",class:"deg",tooltip:$I18N.t('Switch to "degrees" mode'),action:this.actionSetMode.pass("deg",this)}],[{button:"sin",class:"unshifted",tooltip:$I18N.t("Sine"),action:this.actionAddFunction.pass(["sin"],this)},{button:"sinh",class:"shifted smallfont",tooltip:$I18N.t("Hyperbolic sine"),action:this.actionAddFunction.pass(["sinh"],this)}],[{button:"cos",class:"unshifted",tooltip:$I18N.t("Cosine"),action:this.actionAddFunction.pass(["cos"],this)},{button:"cosh",class:"shifted smallfont",tooltip:$I18N.t("Hyperbolic cosine"),action:this.actionAddFunction.pass(["cosh"],this)}],[{button:"tan",class:"unshifted",tooltip:$I18N.t("Tangent"),action:this.actionAddFunction.pass(["tan"],this)},{button:"tanh",class:"shifted smallfont",tooltip:$I18N.t("Hyperbolic tangent"),action:this.actionAddFunction.pass(["tanh"],this)}],{button:"e",tooltip:$I18N.t("Insert 'e' (or press: e)"),action:this.actionAdd.pass("e",this),key:"e"},{button:"<sup>y</sup>log",tooltip:$I18N.t("Calculate the base Y logarithm of the given value"),action:this.actionAddFunction.pass(["log",["y","x"]],this)}],[{button:"&#8682;",tooltip:$I18N.t("Shift"),action:this.shiftActions.bind(this)},[{button:"sin<sup>-1</sup>",class:"unshifted",tooltip:$I18N.t("Arcsine / inverse sine"),action:this.actionAddFunction.pass(["arcsin"],this)},{button:"sinh<sup>-1</sup>",class:"shifted smallfont",tooltip:$I18N.t("Inverse hyperbolic sine"),action:this.actionAddFunction.pass(["arcsinh"],this)}],[{button:"cos<sup>-1</sup>",class:"unshifted",tooltip:$I18N.t("Arccosine / inverse cosine"),action:this.actionAddFunction.pass(["arccos"],this)},{button:"cosh<sup>-1</sup>",class:"shifted smallfont",tooltip:$I18N.t("Inverse hyperbolic cosine"),action:this.actionAddFunction.pass(["arccosh"],this)}],[{button:"tan<sup>-1</sup>",class:"unshifted",tooltip:$I18N.t("Arctangent / inverse tangent"),action:this.actionAddFunction.pass(["arctan"],this)},{button:"tanh<sup>-1</sup>",class:"shifted smallfont",tooltip:$I18N.t("Inverse hyperbolic tangent"),action:this.actionAddFunction.pass(["arctanh"],this)}],{button:"&pi;",tooltip:$I18N.t("Insert 'pi'"),action:this.actionAdd.pass("PI",this)},{button:"rand",tooltip:$I18N.t("Insert a random value between 0 and 1"),action:this.actionAddFunction.pass(["rand"],this)}]],i=e.length,n=0;n<i;n++){for(var s=e[n],o=new Element("div.row"),a=s.length,r=0;r<a;r++){(h=s[r])instanceof Array&&(l=new Element("a.cbutton.tooltip",{events:{click:h[0].action||function(t){return!1},mouseup:function(t){return!1},mousedown:function(t){return!1}},title:h[0].tooltip||null,html:h[0].button,href:"#"}),h[0].class&&l.addClass(h[0].class),h[0].element=l,o.grab(l),h=h[1]);var l=new Element("a.cbutton.tooltip",{events:{click:h.action||function(t){return!1},mouseup:function(t){return!1},mousedown:function(t){return!1}},title:h.tooltip||null,html:h.button,href:"#"});h.class&&l.addClass(h.class),h.element=l,o.grab(l)}this.extended.grab(o)}e.each(function(t){t.each(function(t){t.key&&(this.keys[t.key]=t)},this)},this);for(i=t.length,n=0;n<i;n++){for(s=t[n],o=new Element("div.row"),a=s.length,r=0;r<a;r++){var h=s[r],l=new Element("a.cbutton.tooltip",{events:{click:h.action||function(t){return!1},mouseup:function(t){return!1},mousedown:function(t){return!1}},title:h.tooltip||null,html:h.button,href:"#"});h.class&&l.addClass(h.class),h.element=l,o.grab(l)}this.simple.grab(o)}this.extended.createTooltips(),this.simple.createTooltips(),t.each(function(t){t.each(function(t){t.key&&(this.keys[t.key]=t)},this)},this),this.drag=new Drag(this.element,{onDrag:function(){this.input.fireEvent("move")}.bind(this),handle:this.element.getElement(".topmenu")})},shiftActions:function(){this.element.hasClass("shift")?this.element.removeClass("shift").addClass("unshift"):this.element.removeClass("unshift").addClass("shift")},replaceSigns:function(t){t=(t=t.replace(/×/g,"*")).replace(/√/g,"root");return t=","===this.options.decimal?(t=t.replace(/\./g,"")).replace(/,/g,"."):t},parse:function(e,i){e=e||this.input.get("value"),i=void 0===i||!!i;var n,t=this.replaceSigns(e);try{n=MathParser.parse(t)}catch(t){n={val:e,t:"warning",tree:[$I18N.t("Invalid input")]},i&&this.input.addClass("warning")}return n},safeParse:function(t){var e=this.state.stack;this.state.stack=JSON.parse(JSON.stringify(e));t=this.parse(t,!1);return this.state.stack=e,t},runAction:function(t){var e=this.input.get("value");"="===e.charAt(e.length-1)&&(e=e.substring(0,e.length-1));try{var i=this.parse(e);void 0===i.val&&(i.val=NaN),this.state.historyAdded=!1,this.result.set("text",this.formatNumber(i.val)),this.state.stack[this.state.stack.length-1]&&(this.state.stack[this.state.stack.length-1].input=e),this.resultLabel.set("html",this.printTree(i)+" = "),this.resultLabel.createTooltips(),this.createTargetButton(),this.input.set("value",this.formatNumber(i.val)),this.input.selectRange(0,this.input.get("value").length),"warning"!==i.t&&this.input.removeClass("warning"),this.resetCursor(),this.openhistory&&this.openhistory.removeClass("disabled"),this.log&&this.history()}catch(t){this.input.addClass("warning")}},createTargetButton:function(){var t;0!=this.target&&(t=new Element("a.tooltip.targetlink",{href:"#",title:$I18N.t("Click here to add this value to the input field and close the calculator"),html:'<span class="far fa-arrow-circle-right">&nbsp;</span>',events:{click:function(t){var e,i,n,s,o=this.state.stack[this.state.stack.length-1];"input"===this.lastSelection.type||"none"===this.lastSelection.type?"input"===(e=this.target.tagName.toLowerCase())?(this.target.focus(),i=this.formatNumber(o.val),n=this.target.value.slice(0,this.lastSelection.start)+i+this.target.value.slice(this.lastSelection.end),this.target.set("value",n),this.target.setSelectionRange(this.lastSelection.start+i.length,this.lastSelection.start+i.length)):"textarea"===e?(i=this.getCalculation(),this.target.focus(),n=this.target.value.slice(0,this.lastSelection.start)+i+this.target.value.slice(this.lastSelection.end),this.target.value=n,this.target.setSelectionRange(this.lastSelection.start+i.length,this.lastSelection.start+i.length)):this.target.set("text",this.formatNumber(o.val)):"codemirror"===this.lastSelection.type?(this.lastSelection.instance.doc.setSelections(this.lastSelection.selections),s=this.getCalculation(),this.lastSelection.instance.doc.replaceSelection(s),o=this.lastSelection.selections[0].anchor,this.lastSelection.instance.focus(),this.lastSelection.instance.doc.setCursor(o.line,o.ch+s.length)):"tinymce"===this.lastSelection.type&&(s=this.getCalculation(),this.lastSelection.instance.selection.setContent(s),this.lastSelection.instance.focus());try{(t=document.createEvent("HTMLEvents")).initEvent("change",!0,!0),this.target.dispatchEvent(t)}catch(t){}return this.close(),!1}.bind(this)}}),this.result.grab(t),t.createTooltips())},getCalculation:function(){var t=this.state.stack[this.state.stack.length-1],e=document.createElement("DIV");return e.innerHTML=this.printTree(t,!0),e.textContent===this.formatNumber(t.val)?this.formatNumber(t.val):e.textContent+" = "+this.formatNumber(t.val)},actionClear:function(t){if(this.close_history)return this.close_history.click(),!1;var e;this.state.historyAdded?(e=this.input.get("value"),this.input.set("value",e.replace(/^(\#|ans)/,"")),this.state.historyAdded=!1):(this.state.variables={},this.state.stack=[],this.state.cursor.last="",this.state.cursor.pos=0,this.state.historyAdded=!1,this.input.set("value",""),this.input.removeClass("warning"),this.result.set("html","&nbsp;"),this.resultLabel.set("html","&nbsp;"),this.openhistory&&this.openhistory.addClass("disabled"))},actionNegate:function(){this.focus();try{var t,e=this.input.getCaretPosition(),i=this.getCurrentToken();"number"!==i.t&&"parentheses"!==i.t&&"sym"!==i.t&&"func"!==i.t&&"history"!==i.t?this.input.insertAroundCursor({before:"-",after:""}):(t=this.input.get("value"),this.input.set("value",t.substr(0,i.start)+"-"+t.substr(i.start)),this.input.setCaretPosition(e+1))}catch(t){this.input.insertAroundCursor({before:"-",after:""})}},actionPercentage:function(){this.focus();try{this.input.getCaretPosition();var t,e=this.getCurrentToken();"number"!==e.t&&"parentheses"!==e.t&&"sym"!==e.t&&"func"!==e.t&&"history"!==e.t?this.input.insertAroundCursor({before:"",after:"%"}):(t=this.input.get("value"),this.input.set("value",t.substr(0,e.end)+"%"+t.substr(e.end)),this.input.setCaretPosition(e.end+1))}catch(t){this.input.insertAroundCursor({before:"",after:"%"})}},actionSetMode:function(t){"rad"===t?(this.element.removeClass("degmode").addClass("radmode"),this.options.mode="rad",this.safeParse("RAD")):(this.element.removeClass("radmode").addClass("degmode"),this.options.mode="deg",this.safeParse("DEG")),this.menu.getElement(".mode").set("text",t)},actionAdd:function(t){this.focus(),this.clearSelection(),this.input.insertAroundCursor({before:t+"",after:""})},actionAddOperator:function(t){this.focus(),this.clearSelection();var e,i,n,s,o="*"===t?"×":t;1<arguments.length?"string"==typeof t&&"e"!==t?(this.actionAddOperator(t),this.actionAdd(arguments[1])):(e=this.getCurrentToken(),i=Array.convert(arguments),"number"!==e.t&&"parentheses"!==e.t&&"sym"!==e.t&&"func"!==e.t&&"hist"!==e.t?this.input.insertAroundCursor({before:i.join(""),after:""}):(n=this.input.get("value"),s=this.input.getCaretPosition(),this.input.set("value",n.substr(0,e.start)+i.join("")+n.substr(e.start)),this.input.setCaretPosition(s+i.join("").length))):(null===this.getLastCharacter()&&0<this.state.stack.length&&(this.state.historyAdded=!0,o="ans"+o),this.input.insertAroundCursor({before:o+"",after:""}))},actionAddFunction:function(e,i){this.focus(),i=i||["x"];var n=this.input.getCaretPosition(),t=this.input.value,t=this.replaceSigns(t.substring(0,n)).length-n;try{var s=this.getCurrentToken();if("number"!==s.t&&"parentheses"!==s.t&&"sym"!==s.t&&"func"!==s.t&&"history"!==s.t){i.join("; ");this.input.insertAroundCursor({before:e+"(",after:")"})}else{var o=this.input.get("value");s.start-=t,s.end-=t;for(var a=o.substr(0,s.start)+e+"(",r=s.start+e.length+1,l=!1,h=!1,c=this.input.getSelectedRange(),u=i.length,d=0;d<u;d++)0<d&&(a+="; ",r+=2),"x"===i[d]?(a+=o.substr(s.start,s.end-s.start),h=r,r+=s.end-s.start):a+=i[d],"y"===i[d]&&(l=r);var p=(a+=")").length;a+=o.substr(s.end),this.input.set("value",a),!1!==l?this.input.selectRange(l,l+1):!1!==h&&c.end>c.start?this.input.selectRange(h,h+(s.end-s.start)):this.input.setCaretPosition(p)}}catch(t){p=i.join("; ");this.input.insertAroundCursor({before:e+"("+p,after:")"});for(var m=0,r=n+e.length+1,u=i.length,d=0;d<u;d++){if(0<d&&(r+=2),"y"===i[d]){m=1;break}if("x"===i[d]){m=1;break}r+=(""+i[d]).length}this.input.selectRange(r,r+m)}},actionAddParentheses:function(){this.focus();try{var t,e=this.input.getCaretPosition(),i=this.getCurrentToken();"number"!==i.t&&"parentheses"!==i.t&&"sym"!==i.t&&"func"!==i.t&&"history"!==i.t?this.input.insertAroundCursor({before:"(",after:")"}):(t=this.input.get("value"),this.input.set("value",t.substr(0,i.start)+"("+t.substr(i.start,i.end-i.start)+")"+t.substr(i.end)),this.input.setCaretPosition(e+1))}catch(t){this.input.insertAroundCursor({before:"(",after:")"})}this.state.parentheses=!0},actionAddDecimal:function(){this.focus();var t=!1;this.clearSelection(),this.input.insertAroundCursor({before:this.options.decimal+"",after:""});try{var e,i,n=this.getCurrentToken(),s=this.input.value;(t=!1!==n&&"number"===n.t&&s.substr(n.start,n.end).substr(0,1)==this.options.decimal?!0:t)&&(e=this.input.getCaretPosition(),i=s.substr(0,n.start)+"0"+s.substr(n.start),this.input.value=i,this.input.setCaretPosition(e+1))}catch(t){}},clearSelection:function(){var t,e,i=this.input.getSelectedRange();i.start!==i.end&&(e=(t=this.input.get("value")).substr(0,i.start),e+=t.substr(i.end),this.input.set("value",e),this.input.setCaretPosition(i.start))},onKeyPress:function(t,e){var i;if(e=!!e,"."===(i=((i="\r"===(i=t.event.char||(t.event.charCode?String.fromCharCode(t.event.charCode):13==t.code?"enter":t.event.key||t.key))||"\n"===i||"\r\n"===i||"="===i?"enter":i)+"").toLowerCase())&&"."!==this.options.decimal||","===i&&","!==this.options.decimal?i=this.options.decimal:"arrow"===i.substr(0,5)&&(i=i.substr(5)),")"===i&&!0===this.state.parentheses)return!1;if(e){if("up"===i)return t.preventDefault(),this.moveCursorUp(),!1;if("down"===i)return t.preventDefault(),this.moveCursorDown(),!1;this.resetCursor()}else{if("up"===i||"down"===i)return t.preventDefault(),!1;this.resetCursor()}return delete this.state.parentheses,this.keys[i]?(t.preventDefault(),this.keys[i].element&&(this.keys[i].element.addClass("triggered"),function(){this.keys[i].element.removeClass("triggered")}.delay(300,this)),this.keys[i].action.call(this),!1):void 0},focus:function(){document.activeElement!==this.input&&this.input.focus()},position:function(){var t,e,i;this.input&&(this.element.hasClass("showhistory")&&this.element.removeClass(t="showhistory"),this.input.setStyle("display","none"),e=this.element.getComputedSize(),i=this.input.getComputedSize(),this.input.setStyle("width",e.width-i.computedLeft-i.computedRight),this.input.setStyle("display","inline-block"),t&&this.element.addClass(t))},getLastCharacter:function(){var t=this.input.getCaretPosition();return 0<t?this.input.getTextInRange(t-1,t):null},getCurrentToken:function(){var t=this.input.get("value"),e=this.safeParse(t),i=this.input.getCaretPosition(),i=this.replaceSigns(t.substring(0,i)).length;return this.__find(i,e)},__find:function(t,e){if(t>=e.start&&t<=e.end){for(var i=0,n=e.tree.length;i<n;i++)if("object"==typeof e.tree[i]&&e.tree[i].t){var s=this.__find(t,e.tree[i]);if(!1!==s)return s}return e}return!1},printTree:function(t,e){var i,n,s="";e=e||!1,"hist"===t.t?(i=this.printTree(t.ref,!0),e?(s+='<span class="parentheses-open" style="color:'+(o=this.pickColor())+';">(</span>',s+=i,s+='<span class="parentheses-close" style="color:'+o+';">)</span>'):((n=document.createElement("DIV")).innerHTML=i,n=(n.textContent||n.innerText||"")+"="+this.formatNumber(t.val),s+='<span class="node '+t.t+' tooltip" title="'+n+'">')):"var"===t.t?s+='<span class="node '+t.t+' tooltip" title="'+t.tree[0]+" = "+this.formatNumber(t.val)+'">':s+='<span class="node '+t.t+'">';for(var o,a=[],r=!1,l=0,h=t.tree.length;l<h;l++)if("object"!=typeof t.tree[l]||CalculatorDecimal.isDecimal(t.tree[l]))switch(t.t){case"number":s+=this.formatNumber(t.tree[l]);break;case"var":case"hist":e||(s+=t.tree[l]);break;case"func":if(0==l){var c="";if("rooty"===t.tree[0]){"expseq"===t.tree[2].t?(r=t.tree[2].tree,a[0]=r.shift(),a[1]=r.shift(),s+="<sup>"+this.printTree(a[0],e)+"</sup>√"):s+="<sup>y</sup>√";continue}switch(t.tree[l]){case"root":case"root2":c="√";break;case"root3":c="<sup>3</sup>√";break;default:c=t.tree[l]}s+='<span class="name">'+c+"</span>"}else"("===t.tree[l]?s+='<span class="parentheses-open" style="color:'+(o=this.pickColor())+';">'+t.tree[l]+"</span>":")"===t.tree[l]&&(s+='<span class="parentheses-close" style="color:'+o+';">'+t.tree[l]+"</span>");break;case"parentheses":"("===t.tree[l]?s+='<span class="parentheses-open" style="color:'+(o=this.pickColor())+';">'+t.tree[l]+"</span>":")"===t.tree[l]&&(s+='<span class="parentheses-close" style="color:'+o+';">'+t.tree[l]+"</span>");break;case"sym":s+='<span class="symbol">'+t.tree[l]+"</span>";break;case"set":0==l?s+='<span class="name">'+t.tree[l]+"</span>":1==l&&(s+='<span class="operator">'+t.tree[l]+"</span>");break;case"warning":s+='<span class="warning_msg">'+t.tree[l]+"</span>";break;default:"*"===t.tree[l]?s+='<span class="operator">&times;</span>':"^"===t.tree[l]?s+="<sup>":s+='<span class="operator">'+t.tree[l]+"</span>"}else{var u,d=!1;(d="pow"===t.t&&0===l&&"number"!==t.tree[l].t&&"var"!==t.tree[l].t&&"history"!==t.tree[l].t&&"parentheses"!==t.tree[l].t&&"sym"!==t.tree[l].t?!0:d)&&(s+='<span class="parentheses-open" style="color:'+(u=this.pickColor())+';">(</span>'),s+=this.printTree(t.tree[l],e),d&&(s+='<span class="parentheses-open" style="color:'+u+';">)</span>')}if(r&&0<a.length)for(var p=a.length-1;0<=p;p--)r.unshift(a[p]);return"pow"===t.t&&(s+="</sup>"),s+="</span>"},pickColor:function(){var t=this.options.colors.pop();return this.options.colors.unshift(t),t},removeTooltips:function(t){t.getElements(".tooltip").each(function(t){t.__tooltip&&(t.__tooltip.dispose(),delete t.__tooltip)})},history:function(){if(this.log&&(this.removeTooltips(this.log),this.log.destroy()),!this.element)return!1;if(this.close_history&&this.close_history.destroy(),0===this.state.stack.length)return!1;this.focus(),this.close_history=new Element("div.close_history_menu"),this.close_history.grab(new Element("a.hbutton.close.tooltip",{href:"#",events:{click:function(t){t.preventDefault(),this.removeTooltips(this.log),this.removeTooltips(this.close_history),this.log.destroy(),this.close_history.destroy(),this.close_history=!1,this.log=!1,this.element.removeClass("showhistory")}.bind(this)},title:$I18N.t("Close the history"),html:'<span class="fas fa-times"></span>'})),this.element.grab(this.close_history),this.log=new Element("div.history");for(var t=this.state.stack.length-1;0<=t;t--){var e=this.state.stack[t],i=new Element("div.item"),n=new Element("div.calculation",{html:this.printTree(e)+" = "});n.grab(new Element("a.index.tooltip",{text:t+1,href:"#",title:$I18N.t("Click to use this value in your calculation"),events:{click:this.actionAdd.pass("ans"+(t+1),this)}}),"top"),i.grab(n),i.grab(new Element("div.value",{text:this.formatNumber(e.val)})),this.log.grab(i)}return this.element.grab(this.log),this.element.addClass("showhistory"),this.element.createTooltips(),!1},moveCursorUp:function(){0===this.state.cursor.pos&&(this.state.cursor.last=this.input.get("value")),this.state.stack.length>this.state.cursor.pos&&(this.state.cursor.pos++,this.input.set("value",this.state.stack[this.state.stack.length-this.state.cursor.pos].input),this.focus(),this.input.selectRange(0,this.input.get("value").length))},moveCursorDown:function(){0<this.state.cursor.pos&&(this.state.cursor.pos--,0===this.state.cursor.pos?(this.input.set("value",this.state.cursor.last),this.input.setCaretPosition(this.input.get("value").length)):(this.input.set("value",this.state.stack[this.state.stack.length-this.state.cursor.pos].input),this.focus(),this.input.selectRange(0,this.input.get("value").length)))},resetCursor:function(){this.state.cursor.pos=0,this.state.cursor.last=""},showFormTrigger:function(t,e){if(e.hasClass("calculator_input")||e.hasClass("no_calculator_trigger"))return!1;var i,n;this.buildFormTrigger(e),this.formtrigger&&(void 0!==e.form&&e.form&&!this.forms.contains(e.form)&&($$(e.form).addEvent("submit",function(){this.hideFormTrigger(null,e)}.bind(this)),this.forms.push(e.form)),!(i=e.getParent("div.panel"))||(n=i.retrieve("instance",!1))&&(n.addEvent("js_submit",function(){this.hideFormTrigger(null,e)}.bind(this)),n.grid.addEvent("onFormSubmit",function(){this.hideFormTrigger(null,e)}.bind(this)),n.addEvent("onDestroy",function(){this.hideFormTrigger(null,e),delete this.panels[n.key]}.bind(this)),this.panels.push(n.key)),this.positionFormTrigger(e))},removeWarningClass:function(){""===this.input.get("value")&&this.input.hasClass("warning")&&this.input.removeClass("warning"),""===this.input.get("value")&&(this.result.set("html","&nbsp;"),this.resultLabel.set("html","&nbsp;"))},hideFormTrigger:function(t,e){!1!==this.formtrigger&&(this.removeTooltips(this.formtrigger),this.formtrigger.fireEvent("trash"),this.formtrigger.destroy(),this.formtrigger=!1)},buildFormTrigger:function(e){!1!==this.formtrigger&&this.formtrigger.destroy();var t=e.getParent(this.options.trigger_scope)||window.document.documentElement,i=(i=t.getElement(".calculator"))||$$(".calculator").pick();e.get("id")||e.set("id",String.uniqueID()),i&&(i.get("id")||i.set("id",String.uniqueID()),t=i.href,this.formtrigger=new Element("a.symbollink.fa-boxed.normal-icon.fas.fa-calculator.tooltip",{styles:{position:"absolute"},events:{click:function(t){return t.stop(),this.trigger(t,i,"#"+e.get("id")),!1}.bind(this),mousedown:function(t){return this.predictTarget(),t.preventDefault(),t.stop(),!1}.bind(this),mouseup:function(t){return t.preventDefault(),t.stop(),!1}},id:String.uniqueID(),href:t,title:$I18N.t("Open calculator"),rel:"#"+e.get("id"),ref:"#"+i.get("id")}).inject(document.body),i.hasClass("extended")&&this.formtrigger.addClass("extended"),this.formtrigger.createTooltips())},positionFormTrigger:function(t){try{var e=t.getSize(),i=t.getPosition(),n=(window.getScrollTop(),window.getSize(),i.x+e.x+2),s=i.y;this.formtrigger.setStyles({left:n,top:s})}catch(t){}},onScroll:function(){window.requestAnimationFrame(function(){this.element&&this.input&&this.element.isVisible()&&this.input.fireEvent("move")})}});Locale.define("nl-NL","NotificationController",{}),Locale.define("en-US","NotificationController",{});var NotificationController=new Class({Extends:Controller,name:"NotificationController",url:"/notifications/notifications",valueinput:null,load:function(){},read_all:function(t){var t=$$("#notification-panel-items li."+t),e=[];t.each(function(t){e.push(t.id.replace("noti-",""))}),notifications.read(e)},read_one:function(t){notifications.read(t)},read_one_link:function(t,e,i){$("noti-"+t).classList.contains("unread")&&notifications.read_one(t),this.setStateValue(e,i)}}),notifications,current_page=0,perpage=50,notifiation_request;window.addEvent("domready",function(){var e;$("nav")&&($$("#nav>ul>li").addEvent("click",function(){}),new ResfreshNavAlerts($$("#nav .nav_alert:not(#alert-notification)")).start()),$("user_expires")&&$("user_expires").startCountdown(!0),$("notifications")&&((notifications=new Notifications($("notification-list"))).start(),e=new Fx.Reveal($("notification-list"),{duration:200,mode:"vertical"}),$("notification-bell").addEvent("click",function(t){e.toggle()}),$("alert-notification").addEvent("click",function(t){e.toggle()}),$("notifications-readall").addEvent("click",function(t){notifications.readall(),e.toggle()})),$("auth")&&($$("#auth a").addEvent("touchstart",function(t){t.stopPropagation()}),$("auth").addEvent("touchstart",function(){this.toggleClass("over"),this.hasClass("over")?$("authmenu").set({style:"display:block"}):$("authmenu").set({style:"display:none"})}))});var ResfreshNavAlerts=new Class({ids:!1,initialDelay:5e3,refreshTime:3e4,refreshURL:$base_url+"/menu/",initialize:function(t){this.ids=t.map(function(t){return t.id})},start:function(){0<this.ids.length&&new $Request.JSON({url:this.refreshURL,method:"GET",onSuccess:this.updatealerts.bind(this),initialDelay:this.initialDelay,delay:this.refreshTime}).startTimer({nav_alerts:this.ids})},updatealerts:function(i){this.ids.each(function(t){var e="";void 0!==i[t]&&0<i[t].nr&&"none"!=i[t].class&&(e=100<=i[t].nr?'<span class="'+i[t].class+'">99+</span>':'<span class="'+i[t].class+'">'+i[t].nr+"</span>"),$(t).set("html",e)})}}),Notifications=new Class({el:null,url:"/notifications/notifications",initialDelay:500,refreshTime:3e4,initialize:function(t){this.el=t},start:function(){(notifiation_request=new $Request.JSON({url:this.url+"?limit="+perpage+"&offset="+perpage*current_page,method:"GET",onSuccess:this.update.bind(this),initialDelay:this.initialDelay,delay:this.refreshTime})).startTimer()},update:function(t){this.update_menu_html(t),$("notification-panel-items")&&this.update_widget_html(t),this.update_notification_icon_html(t)},update_menu_html:function(t){var e=0;if(t.notifications&&0<t.notifications.length){$("notification-items").innerHTML="";for(var i=Math.ceil(t.count/perpage),e=t.unread,n=0;n<t.notifications.length&&n<perpage;n++){var s,o=new Element("div",{id:"item-"+t.notifications[n].id,"data-group":t.notifications[n].group||null}),a=new Element("span",{class:"notification-status fas fa-circle"}),r=new Element("span",{class:"notification-title"}),l=new Element("span",{class:"notification-date"}),h=new Element("span",{class:"notification-icon"});0<(t.notifications[n].unread_count||(t.notifications[n].read?0:1))?(o.set("class","unread"),a.set("title",$I18N.t("Mark notification as read")),a.addClass("tooltip"),a.removeClass("far")):(a.addClass("far"),a.set("title",$I18N.t("Mark notification as unread")),a.addClass("tooltip")),t.notifications[n].has_link?((s=new Element("a",{href:t.notifications[n].link})).innerHTML=t.notifications[n].message,s.inject(r)):r.innerHTML=t.notifications[n].message,h.addClass(t.notifications[n].icon),l.innerHTML=t.notifications[n].datetime,a.inject(o),h.inject(o),r.inject(o),l.inject(o),o.inject($("notification-items"))}var c=this;$$("#notification-items div span.notification-status").each(function(i){i.addEvent("click",function(){var t=i.parentNode.id.split("-"),e=i.parentNode.getAttribute("data-group")||!1;c.read(t[1],!!e)})});var u=new Element("div",{class:"notification-navigation-buttons"}),d=new Element("a",{class:"notification-navigation-button notification-next"}),p=new Element("a",{class:"notification-navigation-button notification-prev"}),m=new Element("span",{class:"notification-navigation-page-info"});current_page+1===i&&d.addClass("button-disabled"),0===current_page&&p.addClass("button-disabled"),d.innerHTML=$I18N.t("Next"),p.innerHTML=$I18N.t("Previous"),m.innerHTML=$I18N.t("Page {0}/{1}",[current_page+1,i]),d.addEvent("click",function(){current_page+1<i&&(notifiation_request.stopTimer(),current_page++,(notifiation_request=new $Request.JSON({url:this.url+"?limit="+perpage+"&offset="+perpage*current_page,method:"GET",onSuccess:this.update.bind(this),initialDelay:0,delay:this.refreshTime})).startTimer())}.bind(this)),p.addEvent("click",function(){0<current_page&&(notifiation_request.stopTimer(),current_page--,(notifiation_request=new $Request.JSON({url:this.url+"?limit="+perpage+"&offset="+perpage*current_page,method:"GET",onSuccess:this.update.bind(this),initialDelay:0,delay:this.refreshTime})).startTimer())}.bind(this)),p.inject(u),d.inject(u),m.inject(u),u.inject($("notification-items"))}$("notification-items").createTooltips(),0<e?($("notification-bell").addClass("unread"),$("alert-notification").innerHTML='<span class="warning">'+e+"</span>"):($("notification-bell").removeClass("unread"),$("alert-notification").innerHTML="")},update_widget_html:function(t){var e=0,i=0;if(t.notifications&&0<t.notifications.length){for(var n=0;n<t.notifications.length;n++){var s,o,a=$("noti-"+t.notifications[n].id);null!=a&&(i++,s=a.getElementsByClassName("notification-status")[0],0<(o=t.notifications[n].unread_count||(t.notifications[n].read?1:0))?(a.addClass("unread").removeClass("read"),e+=o,s.setTooltip($I18N.t("Mark notification as read")),s.removeClass("far")):(a.addClass("read").removeClass("unread"),s.setTooltip($I18N.t("Mark notification as unread")),s.addClass("far")))}var r=$("alert-notification-panel").getElementsByClassName("warning")[0];0==e?(r.removeClass("unread"),$("mark-read").addClass("disabled")):(r.addClass("unread"),$("mark-read").removeClass("disabled")),i==e?$("mark-unread").addClass("disabled"):e<i&&$("mark-unread").removeClass("disabled"),r.innerHTML=e}},update_notification_icon_html:function(t){var e=[];if(t.notifications&&0<t.notifications.length)for(var i=[],n=[],s=0;s<t.notifications.length;s++){var o=t.notifications[s].targets||[t.notifications[s].target];o.forEach(function(t){-1===o.indexOf(t[0])&&(e.push(t[0]),i.push(0),n.push(0)),0==t[1]?i[o.indexOf(t)]+=1:n[o.indexOf(t)]+=1})}for(s=0;s<e.length;s++)$$(".notification-icon-datatable-"+o[s]).each(function(t){t.removeAttribute("style"),0<i[s]&&t.setAttribute("style","color: #d3830a;");var e=1;0!=i[s]&&0!=n[s]||(e=0),t.setTooltip($I18N.t("You have {0,plural,=0{} one{1 unread notification} other{# unread notifications}} {2,plural,=0{} other{and}} {1,plural,=0{} one{1 read notification} other{# read notifications}} for this question",[i[s],n[s],e]))})},readall:function(){new $Request.JSON({url:this.url+"?limit="+perpage+"&offset="+perpage*current_page,onSuccess:this.update.bind(this)}).patch()},read:function(t,e){e=!!e,new $Request.JSON({url:this.url+"/"+t+"?limit="+perpage+"&offset="+perpage*current_page+(e?"&all=true":""),onSuccess:this.update.bind(this)}).patch()}});window.addEvent("domready",function(){Element.implement({runCallback:function(t,e,i){var n;"FORM"===this.tagName&&(n=document.$grid||document.$page,(e=Object.merge(n.serializeForm(this),e||{})).callback_id=this.id,e.callback_name=t,n.json(this.action,i,{method:this.method,data:e}))}});function t(t,e){(e.hasClass("disabled")||0<e.getParents(".disabled").length)&&(t.preventDefault(),t.stopPropagation(),e.blur())}window.preventNonNumericInput=function(t){var e=t.hasOwnProperty("event")?t.event:t,i=e.which||e.keyCode;return!(!e.shiftKey||e.altKey||e.ctrlKey||69!==i&&36!==i&&35!==i&&37!==i&&39!==i)||(!(e.shiftKey||e.altKey||!e.ctrlKey||66!==i&&67!==i&&86!==i&&88!==i&&37!==i&&39!==i)||(!(!e.shiftKey||e.altKey||!e.ctrlKey||37!==i&&39!==i)||(!(e.shiftKey||e.altKey||e.ctrlKey)&&(48<=i&&i<=57||96<=i&&i<=105||188===i||190===i||173===i||189===i||110===i||109===i||108===i||173===i||194===i||8===i||9===i||13===i||36===i||35===i||37===i||39===i||46===i||45===i||69===i)||(""===(t.target.get("data-number-prefix")||"")&&""===(t.target.get("data-number-suffix")||"")&&(t.target.value=t.target.value.split(e.key).join("")),t.stopPropagation(),t.preventDefault(),!1))))},window.checkNumericInput=function(t){function e(t){return"e"===(t=""+t).substr(-1).toLowerCase()&&(t+="0"),""===t.trim()?"":(t=t.parseNumber(),isNaN(t)?"":(t=(t=Number.format(t)).replace("e.","E"),l+t+h))}if(void 0===t)return!1;var i,n,s,o=t.target,a=parseFloat(o.get("data-number-min")||Number.MIN_SAFE_INTEGER),r=parseFloat(o.get("data-number-max")||Number.MAX_SAFE_INTEGER),l=o.get("data-number-prefix")||"",h=o.get("data-number-suffix")||"",c=(n=o.value,0<l.length&&n.toLowerCase().startsWith(l.toLowerCase())&&(n=n.substring(l.length)),n=0<h.length&&n.toLowerCase().endsWith(h.toLowerCase())?n.slice(0,-h.length):n),u=(0===(s=c).length?s=a>Number.MIN_SAFE_INTEGER?a.toString():"0":-1===s.indexOf(Locale.get("Number.decimal"))&&2===s.split(Locale.get("Number.group")).length&&(s=s.split(Locale.get("Number.group"))[0]+Locale.get("Number.decimal")+s.split(Locale.get("Number.group"))[1]),s.parseNumber()<a?s=a:s.parseNumber()>r&&(s=r),e(s));if(Array.prototype.forEach.call(document.querySelectorAll("#input_numberinput_warningmessage"),function(t){t.parentNode.removeChild(t)}),o.disableValidation)return!0;if(i=c,n=Locale.get("Number.decimal"),s=Locale.get("Number.group"),n=-1!==i.indexOf(s)?new RegExp("^-?[1-9]\\d{0,2}([{\\"+s+"]\\d{3})*(\\"+n+"\\d+)?(e-?\\d+)?$","gi"):new RegExp("^-?\\d+(\\"+n+"\\d+)?(e-?\\d+)?$","gi"),null!==i.match(n)&&i.parseNumber().between(a,r,!0))return o.value=e(c),!0;if(0===c.length)return!0;t.stopPropagation(),t.preventDefault();var d=new ContentWindow({title:$I18N.t("Invalid number"),width:500,close_button:!1,class:"errorwindow",zIndex:1e5,id:"changeNumberWindow",modalOptions:{id:"changeNumberWindow_modal"},buttons:{cancel:{label:$I18N.t("No, let me change it"),"data-event":"close",class:"cancel fleft",onclick:function(t,e){var i;i=o,JSON.parse(i.get("data-hide-warning"))||new Element("span.warningdecimal",{id:"input_numberinput_warningmessage",text:$I18N.t("Invalid number!")}).inject(i,"after"),o.select(),d.destroy()}.bind(o)},change:{label:$I18N.t("Yes, change it to '{newValue}'",{newValue:u}),class:"fright",onclick:function(t,e){o.value=u,o.focus(),o.fireEvent("keyup"),o.blur(),d.destroy()}.bind(o)}}},{loadMethod:"content",content:'<div class="popupcontent"><p>'+$I18N.t("'{oldValue}' is an invalid value, did you mean '{newValue}'?",{oldValue:o.value,newValue:u})+"</p></div>",panel:"changeNumberWindow_panel"});return!1},$$("body").pick().addEvent("click:relay(input,textarea,select)",t),$$("body").pick().addEvent("mouseup:relay(input,textarea,select)",t),$$("body").pick().addEvent("mousedown:relay(input,textarea,select)",t),$$("body").pick().addEvent("keydown:relay(input.numberinput)",window.preventNonNumericInput),$$("body").pick().addEvent("keyup:relay(input.numberinput)",window.preventNonNumericInput),$$("body").pick().addEvent("blur:relay(input.numberinput)",window.checkNumericInput),$$("a.checkboxlisttoggle").each(function(t){new CheckBoxToggle(t)}),$$("input[type=password]").each(function(t){new PasswordInput(t)}),checkFormgroupsDeleteDisable(),$$("body").pick().addEvent("click:relay(.delete_formgroup)",function(t,e){if(t.stop(),e.hasClass("disabled"))return!1;var i,e=e.getParent("div.formgroup");(i=e?e.getParent("div.element")||e.getParent("div.formitem")||e:i)&&0<i.getSiblings().length&&i.destroy(),checkFormgroupsDeleteDisable()}),$$("body").pick().addEvent('click:relay(input[type="submit"])',function(t,e){if(!0===e.retrieve("preventdoublesubmit",!1))return t.stopPropagation(),t.preventDefault(),!1;t=e.get("data-timeout")||5e3;try{e.store("preventdoublesubmit",!0);(function(){e.eliminate&&e.eliminate("preventdoublesubmit")}).delay(t);return!0}catch(t){}}),$$("body").pick().addEvent("click:relay(.reauth)",function(t,i){t.stopPropagation(),t.preventDefault();var n=String.uniqueID(),s=window.open("/sso/reauth/"+n,"reauthwindow","width=800,heigh=480,location=no,menubar=no,toolbar=no",!0);s.focus();window.addEvent("reauth",function(t,e){n===e&&(!1!==t&&((e=new Element("input",{type:"hidden",name:i.name,value:t})).replaces(i),t=new Element("span.verified",{text:" "+$I18N.t("Identity verified!")}),e.grab(t,"after"),t.grab(new Element("span.fas.fa-check.success-icon"),"top")),s.close(),window.removeEvent("reauth"))})})});var checkFormgroupsDeleteDisable=function(){var t=$$(".formgroup .delete_formgroup");t&&t.each(function(t){var e=t.getParent(".formgroup");e&&(1<(e.closest(".fieldset, fieldset")||e.closest(".formgroup-container")||e.closest(".formgroup")).querySelectorAll(".delete_formgroup").length?t.removeClass("disabled"):t.addClass("disabled"))})},PasswordInput=new Class({checkStrengthTimer:!1,initialize:function(s){var t,o,a,r;function e(){var e=o;s.form.getElements("input").each(function(t){"text"!==t.get("type")||0<(t=t.get("value")).length&&-1===e.indexOf(t)&&e.push(t)});var i,t=zxcvbn(s.value,e),n=!1;s.nextSibling&&$(s.nextSibling).hasClass("suggestionbox")&&(n=$(s.nextSibling)),0<s.value.length?(i="",t.feedback.warning&&(i+="<strong>"+a[t.feedback.warning]+"</strong> "),0<t.feedback.suggestions.length&&(i+="<ul>",t.feedback.suggestions.each(function(t){i+="<li>"+a[t]+"</li>"}),i+="</ul>"),0<i.length?(!1===n&&((n=new Element("div.suggestionbox")).setStyle("width",s.getStyle("width")),s.grab(n,"after")),n.set("html",i)):n&&n.destroy(),!1!==r.checkStrengthTimer&&(clearTimeout(r.checkStrengthTimer),r.checkStrengthTimer=!1),s.removeClass("valid_strength").removeClass("invalid_strength").addClass("unknown_strength"),r.checkStrengthTimer=function(){var t=s.getParent("form"),e=$page.serializeForm(t);e.__passwordStrengthCheck=s.get("name");new $Request.JSON({url:t.get("action"),method:t.get("method"),onSuccess:function(t){var e=!1;s.nextSibling&&$(s.nextSibling).hasClass("suggestionbox")&&(e=$(s.nextSibling)),t.strength?(s.addClass("valid_strength").removeClass("invalid_strength").removeClass("unknown_strength"),e&&e.destroy()):(s.removeClass("valid_strength").addClass("invalid_strength").removeClass("unknown_strength"),!1===e&&((e=new Element("div.suggestionbox")).setStyle("width",s.getStyle("width")),s.grab(e,"after"),e.set("html","<strong>"+$I18N.t("Your password is not complex enough.")+"</strong>")))}}).send(Object.toQueryString(e));clearTimeout(r.checkStrengthTimer),r.checkStrengthTimer=!1}.delay(500)):(n&&n.destroy(),s.removeClass("valid_strength").removeClass("invalid_strength").removeClass("unknown_strength"),clearTimeout(r.checkStrengthTimer))}null!=$(s)&&void 0===(s=$(s)).__passwordInput&&(s.__passwordInput=this,t=s.get("data-show-strength"),o=JSON.parse(s.get("data-context")),a={"A word by itself is easy to guess":$I18N.t("A word by itself is easy to guess"),"Add another word or two. Uncommon words are better.":$I18N.t("Add another word or two. Uncommon words are better."),"All-uppercase is almost as easy to guess as all-lowercase":$I18N.t("All-uppercase is almost as easy to guess as all-lowercase"),"Avoid dates and years that are associated with you":$I18N.t("Avoid dates and years that are associated with you"),"Avoid recent years":$I18N.t("Avoid recent years"),"Avoid repeated words and characters":$I18N.t("Avoid repeated words and characters"),"Avoid sequences":$I18N.t("Avoid sequences"),"Avoid years that are associated with you":$I18N.t("Avoid years that are associated with you"),"Capitalization doesn't help very much":$I18N.t("Capitalization doesn't help very much"),"Common names and surnames are easy to guess":$I18N.t("Common names and surnames are easy to guess"),"Dates are often easy to guess":$I18N.t("Dates are often easy to guess"),"Names and surnames by themselves are easy to guess":$I18N.t("Names and surnames by themselves are easy to guess"),"No need for symbols, digits, or uppercase letters":$I18N.t("No need for symbols, digits, or uppercase letters"),"Predictable substitutions like '@' instead of 'a' don't help very much":$I18N.t("Predictable substitutions like '@' instead of 'a' don't help very much"),"Recent years are easy to guess":$I18N.t("Recent years are easy to guess"),'Repeats like "aaa" are easy to guess':$I18N.t('Repeats like "aaa" are easy to guess'),'Repeats like "abcabcabc" are only slightly harder to guess than "abc"':$I18N.t('Repeats like "abcabcabc" are only slightly harder to guess than "abc"'),"Reversed words aren't much harder to guess":$I18N.t("Reversed words aren't much harder to guess"),"Sequences like abc or 6543 are easy to guess":$I18N.t("Sequences like abc or 6543 are easy to guess"),"Short keyboard patterns are easy to guess":$I18N.t("Short keyboard patterns are easy to guess"),"Straight rows of keys are easy to guess":$I18N.t("Straight rows of keys are easy to guess"),"This is a top-10 common password":$I18N.t("This is a top-10 common password"),"This is a top-100 common password":$I18N.t("This is a top-100 common password"),"This is a very common password":$I18N.t("This is a very common password"),"This is similar to a commonly used password":$I18N.t("This is similar to a commonly used password"),"Use a few words, avoid common phrases":$I18N.t("Use a few words, avoid common phrases"),"Use a longer keyboard pattern with more turns":$I18N.t("Use a longer keyboard pattern with more turns")},r=this,t&&"undefined"!=typeof zxcvbn&&(s.addEvent("keyup",e),e()))}}),CheckBoxToggle=new Class({Implements:[Events,Options],Binds:["toggle","update_link"],options:{},currently_checked:!1,link:!1,checkboxes:[],initialize:function(t){this.other_state=t.get("data-other-state"),t.erase("data-other-state");var e=t.get("data-input-name");this.link=t,this.checkboxes=$$('input[name^="'+e+'["]'),this.link.addEvent("click",this.toggle),this.checkboxes.addEvent("click",this.update_link),this.update_link()},toggle:function(t){t.stop();for(var e=this.all_checked(),i=0,n=this.checkboxes.length;i<n;i++)this.checkboxes[i].set("checked",!e);this.update_link()},all_checked:function(){for(var t=!0,e=0,i=this.checkboxes.length;e<i;e++)if(!this.checkboxes[e].get("checked")){t=!1;break}return t},update_link:function(){var t,e=this.all_checked();e!==this.currently_checked&&(t=this.other_state,this.other_state=this.link.get("html"),this.link.set("html",t),this.currently_checked=e)}}),ColorInput=new Class({Implements:[Events,Options],Binds:["onChangeColor","restoreColor","changeColor","pickColor"],cp:!1,options:{},initialize:function(t,e){this.id=t,this.input=document.id(t),this.cp=new DynamicColorPicker({autoLoadPath:!1,pickerPath:$base_url+"/base/resources/js/colorpicker"});t=new Element("div.buttoncontainer.fix");t.grab(new Element("a.button.cancel",{events:{click:this.restoreColor},text:$I18N.t("Cancel")})),t.grab(new Element("a.button.fright",{events:{click:this.pickColor},text:$I18N.t("Select")})),this.cp.container.grab(t,"bottom"),this.cp.addEvent("change",this.onChangeColor),this.cp.addEvent("cancel",this.restoreColor),this.element=$(this.id+"_container"),this.element.addEvent("click:relay(div.colorlabel)",this.changeColor),this.colorpreview=this.element.getElement("span.colorpreview")},changeColor:function(t,e){if(this.element.getParent(".disabled"))return!1;var i=e.getPosition();this.restore_to=this.colorpreview.getStyle("background-color"),this.cp.setColor(this.restore_to);var n=window.getScrollTop(),s=window.getSize(),o=i.x,a=i.y+e.offsetHeight+10,e=this.cp.container.getDimensions();o+e.width>s.x&&(o=s.x-e.width),a+e.height>s.y+n&&(a=i.y-e.height-10),this.cp.toggle(o,a)},restoreColor:function(){this.onChangeColor(this.restore_to),this.cp.hide()},pickColor:function(){this.cp.hide()},onChangeColor:function(t){this.colorpreview.setStyle("background-color",t),this.element.getElement("span.color").set("text",t.toUpperCase()),this.input.set("value",t),this.input.fireEvent("change")}}),ImageInput=new Class({Implements:[Events,Options],Binds:["click_event","json_event","select_event"],input:!1,element:!1,id:!1,media_window:!1,request:{},options:{},initialize:function(t,e){this.id=t,this.input=document.id(t),this.element=document.id(t+"_imgselector"),this.setOptions(e),this.element.addEvent("click:relay(a)",this.click_event),this.form=this.input.form},click_event:function(t,e){var i=e.get("data-action");if("function"===typeOf(this[i]))return t.preventDefault(),this[i].apply(this,[t,e]),!1},delete:function(t){t.stopPropagation(),this.input.set("value",""),this.element.getElement("a.img_example").empty(),this.reset_links()},choose:function(t){t&&t.stopPropagation(),this.request={data:{imageinput_action:"choose",imageinput_id:this.id,mediasearch:$("mediasearch")?$("mediasearch").get("value"):null}},this.open_mediawindow(690,500)},upload:function(t){t.stopPropagation(),this.request={data:{imageinput_action:"upload",imageinput_id:this.id}},this.open_mediawindow(600)},media_search:function(t,e){t&&t.stopPropagation(),this.media_window&&this.choose()},media_reset:function(t,e){t&&t.stopPropagation(),this.media_window&&($("mediasearch").set("value",""),this.choose())},media_upload:function(t,e){t.preventDefault(),$page.loadController("PopupController","run",[{onClose:function(){this.choose()}.bind(this)},e])},media_delete:function(t,e){t.preventDefault(),$page.loadController("PopupController","run",[{onClose:function(){this.choose()}.bind(this)},e])},media_action:function(t,e){"function"==typeof Milkbox?(this.mbobj=new Milkbox,this.mbobj.openWithFile({href:e.href})):window.open(e.href)},open_mediawindow:function(t,e){0==this.media_window?(this.media_window=new ContentWindow({width:t,height:void 0===e?"auto":e,hideOnLoad:!0,id:"mediawindow",modalOptions:{destroyOnClick:!0,id:"uploadmodal"},close_button:!0,buttons:!1,zIndex:5e3,onClose:function(){this.media_window=!1,this.viewer&&this.viewer.close()}.bind(this)},{loadMethod:"controller",controller:"ContentController",controllerAction:"init",controllerActionParams:["mediawindow_panel",this.form.get("action"),{onJSON:this.json_event,request:this.request}]}),this.media_window.element.addEvent("click:relay(div.media_thumbnail)",this.select_event),this.media_window.element.addEvent("click:relay(a)",this.click_event)):!this.media_window.grid||(e=this.media_window.grid.panels.mediawindow_panel)&&e.loadURL(this.form.get("action"),this.request)},reset_links:function(){var t=this.element.getElements("ul.img_options li"),i=0<this.input.get("value").toInt(),n=this.element.get("data-mediacount").toInt();t.each(function(t){var e=t.getElement("a").get("data-action");"delete"==e?t.setStyle("display",i?"block":"none"):"choose"==e&&t.setStyle("display",0<n||i&&1<n?"block":"none")})},select_event:function(t,e){t.stopPropagation();var e=e.getParent("div.media_block");!e||void 0!==(e=JSON.decode(e.get("data-media-info"))).id&&void 0!==e.result&&(this.input.set("value",e.id),this.element.getElement("a.img_example").set("html",e.result).check_media(),this.media_window.close(),this.media_window=!1,this.reset_links())},json_event:function(t){var e=$("mediasearch");e&&(e.addEvent("keydown",function(t){"enter"==t.key&&this.media_search(t,null)}.bind(this)),e.fill_horizontal()),t.success&&void 0!==t.media_id&&void 0!==t.result&&(this.input.set("value",t.media_id),this.element.getElement("a.img_example").set("html",t.result).check_media(),this.element.check_media(),this.media_window.close(),this.media_window=!1)}}),QTITinyMCEPopupInput=new Class({Implements:[Events,Options],Binds:["click_event"],element:!1,input:!1,name:!1,example:!1,form:!1,initialize:function(t,e,i){"string"===typeOf(t)&&(t=$(t)),this.form=t,this.name=e,this.input=t.getElements("input[name="+e+"]")[0],this.element=this.input.getParent(),this.element.addEvent("click",this.click_event),this.height=i,this.example=this.element.getChildren(".example")[0],this.example.fitImages()},click_event:function(t){t.preventDefault(),t.stopPropagation();t={cancel:{panel:this.input.id+"_window_panel",label:$I18N.t("Cancel"),"data-event":"close",class:"destructive"},save:{panel:this.input.id+"_window_panel",label:$I18N.t("Save"),class:"fright","data-event":"submit"}};this.window=new ContentWindow({height:"auto",buttons:t,id:this.input.id+"_window",modalOptions:{id:this.input.id+"_modal"},zIndex:5e3,onJSON:function(t){t["html-complete"]&&-1!==t["html-complete"].name.indexOf(this.name)&&(this.input.value=t["html-complete"].html,this.input.fireEvent("change"),this.example.set("html",t["html-complete"].html),this.example.fitImages())}.bind(this),can_retry:!0},{loadMethod:"controller",controller:"ContentController",controllerAction:"init",controllerActionParams:[this.input.id+"_window_panel",this.example.getAttribute("data-url")+"&name="+this.name,{can_retry:!0}]}),this.element.store("window",this.window)}}),SliderInput=new Class({Implements:[Events],Binds:["slider_updated","slider_clicked","target_updated","slider_completed"],element:!1,slider:!1,knob:!1,target:!1,minvalue:0,maxvalue:0,decimals:0,empty:!0,timeout:!1,previous_value:!1,initialize:function(t){var e;t&&(this.element=t,this.target=$(this.element.get("data-slider-target")),this.minvalue=parseFloat(this.element.get("data-slider-min")),this.maxvalue=parseFloat(this.element.get("data-slider-max")),this.decimals=parseInt(this.element.get("data-slider-decimals")),this.postfix=this.element.get("data-slider-postfix"),this.element&&this.target&&(this.knob=t.getElement(".sliderknob"),""!=this.target.value&&(this.empty=!1,this.target.value.match(new RegExp("/"+this.postfix+"$/"))||(this.target.value+=this.postfix)),e=parseFloat(this.target.value),","==Locale.get("Number").decimal&&(e=parseFloat(this.target.value.replace(".","").replace(",","."))),isNaN(e)&&(e=0),this.previous_value=e,t.addEvent("mousedown",this.slider_clicked),e={range:[this.minvalue*Math.pow(10,this.decimals),this.maxvalue*Math.pow(10,this.decimals)],initialStep:e*Math.pow(10,this.decimals),steps:(this.maxvalue-this.minvalue)*Math.pow(10,this.decimals),onChange:this.slider_updated,onComplete:this.slider_completed},this.slider=new Slider(t,this.knob,e),""==this.target.value&&this.knob.hide(),this.knob.addEvent("mousedown",function(t){this.blur()}.bind(this.target)),this.target.addEvent("keyup",this.target_updated)))},slider_updated:function(t){document.activeElement==this.target||isNaN(t)||0==this.empty&&(this.target.value=(t/Math.pow(10,this.decimals)).format({decimals:this.decimals})+this.postfix)},slider_completed:function(t){t!=this.previous_value&&(this.previous_value=t,this.target.fireEvent("keyup",[this.target,!0]))},slider_clicked:function(t){this.empty&&(this.empty=!1,this.knob.show(),this.target.value=(this.slider.step/Math.pow(10,this.decimals)).format({decimals:this.decimals})+this.postfix)},target_updated:function(t,e){this.empty&&!e&&(this.empty=!1,this.knob.show());e=parseFloat(this.target.value);","==Locale.get("Number").decimal&&(e=parseFloat(this.target.value.replace(".","").replace(",","."))),isNaN(e)||this.slider.set(e*Math.pow(10,this.decimals))}}),SelectionWindowInput=new Class({Implements:[Events,Options],selection:!1,selection_container:!1,window:!1,old_scroll:!1,url:!1,options:{selection_element:!1,buttons:!1,initial_selection:!1,height:500,width:950},initialize:function(t,e){this.url=t,this.setOptions(e),0!=this.options.selection_element&&(this.selection=$(this.options.selection_element),this.selection_container=$(this.options.selection_element+"_group_container"),this.selection_icon=$(this.options.selection_element+"_icon"));e=this.options.buttons||{cancel:{panel:"leftpanel",label:$I18N.t("Cancel"),"data-event":"close",class:"cancel fleft"},save:{panel:"rightpanel",label:$I18N.t("Select"),class:"fright",onclick:function(t,e){t.stop(),this.options.selection_element&&(this.selection.value=e.element.getElementById("selection").value,(t=e.element.getElements(".selectionwindow_returnlist"))&&(this.selection_container.empty(),t.inject(this.selection_container)),e=this.selection_icon.getElementsByTagName("i")[0],"UL"==t[0].children[0].tagName?(e.classList.remove("fa-circle"),e.classList.add("fa-check-circle"),e.style.color="green"):(e.classList.remove("fa-check-circle"),e.classList.add("fa-circle"),e.style.color="lightgrey")),this.window.close()}.bind(this)}};this.window=new ContentWindow({width:this.options.width,id:"selectionwindow",height:this.options.height,buttons:e,grid:{columnSpacing:0},layout:{left_column:{width:475,panelSpacing:0,resizable:{handleWidth:0,enabled:!1},panels:[{id:"leftpanel",column:"left_column",height:"fill",hidden:!0,buttons:{cancel:e.cancel}}]},right_column:{width:"fill",panelSpacing:0,panels:[{id:"rightpanel",column:"right_column",height:"fill",hidden:!0,buttons:{save:e.save}}]}}}),this.run()},run:function(){var t={data:{initialselection:this.selection?this.selection.value:this.options.initial_selection,panel:"left"}},e=this.window.grid;this.left_panel=e.getPanel("leftpanel"),this.right_panel=e.getPanel("rightpanel"),void 0===document.$trackers&&(document.$trackers={}),document.$trackers.leftpanel=this.left_tracker=new ContentTracker("leftpanel",{request:{data:{panel:"left"},method:"post"}}),document.$trackers.rightpanel=this.right_tracker=new ContentTracker("rightpanel",{request:{data:{panel:"right"},method:"post"}}),this.window.addEvent("onJSON",this.onJSON.bind(this)),this.left_panel.loadURL(this.url,t)},onJSON:function(t){this.left_panel.show(),this.right_panel.show(),t.left&&this.left_panel.setHTML(t.left),t.right&&(this.right_panel.setHTML(t.right),(-1!==navigator.userAgent.indexOf("MSIE")||-1<navigator.appVersion.indexOf("Trident/"))&&this.left_panel.setHTML(t.html)),t.footer&&this.window.grid.footer.set("html",t.footer)}}),Action=new Class({Implements:[Events],Binds:["run"],elements:[],event:"change",target:!1,conditions:[],form:!1,name:"",initialize:function(t,e,i,n,s){this.form=$(t),this.name=e,this.event=i,this.target=!1!==n&&null!==n&&$(n),this.conditions=s,this.load()},load:function(){var t=this.name;if(this.uuid||(this.uuid=String.uniqueID()),void 0===window.$actions&&(window.$actions={}),(window.$actions[this.uuid]=this).form){"[]"==t.substring(t.length-2)?this.elements=this.form.getElements('*[name^="'+t.substr(0,t.length-1)+'"][name$="]"]'):t===this.form.get("name")?this.elements=new Elements([this.form]):this.elements=this.form.getElements('*[name="'+t+'"], div.caesurainput[data-name="'+t+'"]'),this.target&&(this.target.$actions||(this.target.$actions=[]),this.target.$actions.push(this));try{var e=this.form.get("data-formactions");(e=e?e.split(","):[]).contains(this.uuid)||e.push(this.uuid),this.form.set("data-formactions",e.join(","))}catch(t){}if("load"==this.event)window.addEvent("domready",this.run);else{this.elements.addEvent(this.event,this.run);try{this.conditions.each(function(t){for(var e=0,i=t.length;e<i;e++){var n=t[e];"string"===typeOf(n)&&"#"===n.substr(0,1)&&0<(el=this.form.getElements('*[name="'+n.substr(1)+'"]')).length&&el.addEvent(this.event,this.run)}},this)}catch(t){}}"keyup"==this.event&&(this.elements_value=this.elements.get("value"),this.timeout=function(){if(this.elements&&"null"!==typeOf(this.elements.get))try{this.elements.get("value").compare(this.elements_value)||(this.elements.fireEvent(this.event,{}),this.elements_value=this.elements.get("value"))}catch(t){return void clearInterval(this.timeout)}else clearInterval(this.timeout)}.periodical(250,this))}},destroy:function(){"load"==this.event?window.removeEvent("domready",this.run):this.elements.removeEvent(this.event,this.run),this.timeout&&clearInterval(this.timeout)},run:function(t){var e,s=this.getValue(this.elements),o=(!1!==this.target&&this.getValue(this.target),[]);e=0==this.conditions.length||this.conditions.some(function(n){var t,e=n.map(function(t){var e;if("%SELF%"==t)return s="array"==typeOf(s)&&1==s.length&&!["in","notin"].contains(n[0])?s.pop():s;if("%TARGET%"==t)return"array"!=typeOf(i)||1!=i.length||["in","notin"].contains(n[0])||(i=i.pop()),i="array"!=typeOf(i)&&["in","notin"].contains(n[0])?[i]:i;if("string"===typeOf(t)&&"#"===t.substr(0,1)&&0<(e=this.form.getElements('*[name="'+t.substr(1)+'"]')).length){var i=this.getValue(e);return"array"!=typeOf(i)||1!=i.length||["in","notin"].contains(n[0])||(i=i.pop()),i="array"!=typeOf(i)&&["in","notin"].contains(n[0])?[i]:i}return t},this),i=!1;switch(e[0]){case"==":i=e[1]===e[2],t=3;break;case"!=":i=e[1]!==e[2],t=3;break;case"in":i=e[2].contains(e[1]),t=3;break;case"notin":i=!e[2].contains(e[1]),t=3;break;case"<":i=e[1]<e[2],t=3;break;case">":i=e[1]>e[2],t=3;break;case"<=":i=e[1]<=e[2],t=3;break;case">=":i=e[1]>=e[2],t=3;break;case"odd":i=e[1]%2!=0,t=2;break;case"even":i=e[1]%2==0,t=2;break;case"empty":i="string"==typeof e[1]?0===e[1].trim().length:0===e[1].length,t=2;break;case"notempty":i="string"==typeof e[1]?0<e[1].trim().length:0<e[1].length,t=2;break;case"1":i=!0,t=1}return void 0!==t&&(o=e.slice(t)),i},this),this.execute.apply(this,[e,t].concat(o))},getValue:function(t){var e,i=!1;return null!==t&&1<=t.length&&("radio"==(e=$(t[0])).type?(i=this.form.getElements('input[name="'+e.get("name")+'"]:checked').map(function(t){return t.value}),"radio"==e.type&&0<i.length&&(i=i[0])):"checkbox"==e.type?(i=[],t.each(function(t){t.checked&&i.push(t.value)})):"select"==e.type?(i=e.getSelected(),"multiple"!=e.getProperty("multiple")&&0<i.length&&(i=i[0])):i=e.get("value")),i},execute:function(t,e){},fireChangeEvent:function(t){var e;try{e=new Event("change",{bubbles:!0,cancelable:!0})}catch(t){(e=document.createEvent("HTMLEvents")).initEvent("change",!0,!0)}t.dispatchEvent(e)}}),SlideAction=new Class({Extends:Action,prevResult:null,initialize:function(t,e,i,n,s){this.parent(t,e,i,n,s)},execute:function(t,e){var i,n,s=this.target.getParent("div.slider");t!==this.prevResult&&(this.target&&s.set("tween",{link:"chain",onComplete:function(){0<this.element.offsetHeight?(this.element.getComputedSize(),this.element.setStyle("height","auto"),s.fireEvent("show")):(this.element.setStyle("display","none"),s.fireEvent("hide"))}}),t&&this.target?(i=0,n=s.getComputedSize(),this.target.offsetHeight<n.totalHeight&&(i=Math.floor(n.totalHeight)-Math.floor(this.target.offsetHeight)),s.setStyle("display","block"),s.tween("height",s.getElement(".element").offsetHeight+i)):this.target&&0<s.offsetHeight&&(n=s.getComputedSize(),s.setStyle("height",n.totalHeight),s.tween("height",0)),this.prevResult=t)}}),ShowAction=new Class({Extends:Action,initialize:function(t,e,i,n,s){this.parent(t,e,i,n,s)},execute:function(t,e){var i=this.target.getParent("div.slider");t&&this.target?(i.setStyle("display","block"),i.setStyle("height","auto"),i.fireEvent("show")):this.target&&(i.setStyle("height",0),i.setStyle("display","none"),i.fireEvent("hide"))}}),DisableAction=new Class({Extends:Action,initialize:function(t,e,i,n,s){this.parent(t,e,i,n,s),this.run()},execute:function(t,e,i){var n,s;t&&this.target?void 0!==i?(n=this.target.getElements("*[value="+JSON.encode(i)+"]"))&&(s=n.get("disabled"),n.addClass("disabled"),n.set("disabled",!0),s||this.fireChangeEvent(n)):(s=this.target.get("disabled"),this.target.disabled=!0,s||this.fireChangeEvent(this.target),this.target.getElements("input, select, textarea").each(function(t){var e=t.get("disabled");t.set("disabled",!0),e||this.fireChangeEvent(t)}.bind(this)),(this.target.getParent(".element")||this.target).addClass("disabled")):this.target&&(void 0!==i?(n=this.target.getElements("*[value="+JSON.encode(i)+"]"))&&(s=n.get("disabled"),n.removeClass("disabled"),n.set("disabled",!1),s&&this.fireChangeEvent(n)):(s=this.target.get("disabled"),this.target.disabled=!1,s&&this.fireChangeEvent(this.target),this.target.getElements("input, select, textarea").each(function(t){var e=t.get("disabled");t.set("disabled",!1),e&&this.fireChangeEvent(t)}.bind(this)),(this.target.getParent(".element")||this.target).removeClass("disabled")))}}),EnableAction=new Class({Extends:Action,initialize:function(t,e,i,n,s){this.parent(t,e,i,n,s),this.run()},execute:function(t,e,i){var n;!t&&this.target?void 0!==i?(n=this.target.getElements("*[value="+JSON.encode(i)+"]"))&&(n.addClass("disabled"),n.set("disabled",!0)):(this.target.disabled=!0,this.target.getElements("input, select, textarea").set("disabled",!0),(this.target.getParent(".element")||this.target).addClass("disabled")):this.target&&(void 0!==i?(n=this.target.getElements("*[value="+JSON.encode(i)+"]"))&&(n.removeClass("disabled"),n.set("disabled",!1)):(this.target.disabled=!1,this.target.getElements("input, select, textarea").set("disabled",!1),(this.target.getParent(".element")||this.target).removeClass("disabled")))}}),FocusAction=new Class({Extends:Action,initialize:function(t,e,i,n,s){this.parent(t,e,i,n,s),this.run()},execute:function(t,e){t&&this.target&&("input"!=this.target.get("tag")||"hidden"!==this.target.get("type"))&&this.target.focus()}}),CheckAction=new Class({Extends:Action,initialize:function(t,e,i,n,s){this.parent(t,e,i,n,s)},execute:function(t,e,i){void 0!==i?(i=this.target.getElements("*[value="+JSON.encode(i)+"]"))&&(t?i.set("checked","checked"):i.set("checked",!1),i.fireEvent("click")):(t&&this.target?this.target.set("checked","checked"):!t&&this.target&&this.target.set("checked",!1),this.target.fireEvent("click"))}}),CloneButtonAction=new Class({Extends:Action,initialize:function(t,e,i,n,s){this.parent(t,e,i,n,s)},execute:function(t,e){void 0===e.target||"button"!=e.target.type&&"submit"!=e.target.type||(this.form.getElements('input[type=hidden][name="'+e.target.name+'"]').destroy(),e=new Element("input",{type:"hidden",name:e.target.name,value:e.target.value,class:e.target.class}),this.form.adopt(e))}}),SubmitAction=new Class({Extends:CloneButtonAction,ignore_clicks:!1,initialize:function(t,e,i,n,s){this.parent(t,e,i,n,s)},execute:function(t,e){if(e&&e.stop){if(!0===this.ignore_clicks)return e.stop(),!1;this.ignore_clicks=!0;(function(){this.ignore_clicks=!1}).delay(1e4,this)}var i;void 0!==e&&this.parent(t,e),(void 0===e||void 0!==e.target&&"submit"!=e.target.type)&&((e=this.form.getParent("div.panel"))&&(i=e.retrieve("instance"))?i.fireEvent("js_submit",[this.form,this.name+"_action","submit"]):(this.form.grab(new Element("input",{type:"hidden",name:this.name+"_action",value:"submit"})),this.form.submit()))}}),UpdateFormAction=new Class({Extends:Action,initialize:function(t,e,i,n,s){this.parent(t,e,i,n,s)},execute:function(t,e){t&&new Form.Request(this.form,this.form,{extraData:{__update_form:!0},requestOptions:{evalScripts:!0,useSpinner:!1,url:this.form.action,emulation:!1}}).send()}}),ValueAction=new Class({Extends:Action,initialize:function(t,e,i,n,s){this.parent(t,e,i,n,s),this.run()},execute:function(t,e,i){if(t&&this.target)switch(this.target.tagName){case"INPUT":"radio"==this.target.type||"checkbox"==this.target.type?(this.target.set("checked",this.target.value==i),this.target.fireEvent("click")):(this.target.set("value",i),this.target.fireEvent("text"==this.target.type?"keyup":"change"));break;case"TEXTAREA":this.target.set("text",i),this.target.fireEvent("keyup");break;case"SELECT":this.target.set("value",i),this.target.fireEvent("change");break;default:this.target.getElements("input[type=radio], input[type=checkbox]").each(function(t){t.set("checked",t.value==i),t.fireEvent("click")}),this.target.fireEvent("change")}}}),UpdateSelectAction=new Class({Extends:Action,initialize:function(t,e,i,n,s){this.parent(t,e,i,n,s),this.run()},execute:function(t,e,i){if(t&&this.target)switch(this.target.tagName){case"INPUT":this.update_styled_select(i);break;case"SELECT":this.update_normal_select(i)}},update_styled_select:function(t){var i,n=this.target.retrieve("$styledselect",!1);0!=n&&(n.clearOptions(),i=!0,Object.each(t,function(t,e){n.addOption({text:t,value:e,selected:i},!0),i=!1},this),n.apply_onclick())},update_normal_select:function(t){this.target.empty(),Object.each(t,function(t,e){this.target.grab(new Element("option",{text:t,value:e}))})}}),ControllerAction=new Class({Extends:Action,initialize:function(t,e,i,n,s){this.parent(t,e,i,n,s)},execute:function(t,e,i,n,s){t&&((s=s||[]).push(1===this.elements.length?this.elements.pick():this.elements),s.push(this.target),$page.loadController(i,n,s))}}),CaesuraInput=new Class({Implements:[Events],Binds:["changedInput","maxPointsKeyPress","changedPointInput","pointInputKeyDown","changedAreaInput","changedChart","openTable","updateReportInputs","changedReportInputs","changedType","changedSchotanus","addCompositeArea","changedWeighting"],id:!1,value:!1,element:!1,chart:!1,elements:{json:!1,score_type:!1,rounddecimals:!1,grade_range:!1,max_points:!1,caesura:!1,buttonaddpoint:!1,buttonremovepoint:!1,points:!1,areas:!1,example_submit:!1,example_number:!1,example_submit_new:!1},disablechangedevent:!0,old_points:[],old_areas:[],show_score_type:!0,show_area_name:!0,show_area_feedback:!0,initialize:function(t,e){this.id=t,this.chart=e,this.element=$(t),this.elements.json=$(t+"_json"),this.elements.score_type=$(t+"_score_type"),this.elements.caesura_type=$(t+"_caesura_type"),this.elements.rounddecimals=$(t+"_rounddecimals"),this.elements.roundtype=$(t+"_roundtype"),this.elements.grade_range=$(t+"_grade_range"),this.elements.max_points=$(t+"_max_points"),this.elements.caesura=$(t+"_caesura"),this.elements.negate_guessing=$(t+"_negate_guessing"),this.elements.example_submit=$(t+"_example_submit"),this.elements.example_submit_new=$(t+"_example_submit_new"),this.elements.example_input=$(t+"_example_number"),this.elements.example_guessing=$(t+"_example_guessing"),this.elements.schotanus=$(t+"_schotanus"),this.elements.weighting=$(t+"_weighting"),this.elements.composite_add_link=$$("#"+t+"_composite_add_link .button").pick(),this.elements.example_submit&&this.elements.example_submit.addEvent("click",this.openTable),this.elements.example_submit_new&&this.elements.example_submit_new.addEvent("click",this.getScoreTable),this.elements.composite_add_link&&this.elements.composite_add_link.addEvent("click",this.addCompositeArea);var i=$(t+"_graphbox");this.elements.buttonaddpoint=i.getElement(".addpoint"),this.elements.buttonremovepoint=i.getElement(".removepoint"),this.elements.pointtemplate=$(t+"_pointtemplate").getParent().getParent(),this.elements.points=[],this.elements.reportcontainer=$(t+"_reportcontainer"),this.elements.reportcontainer&&(this.elements.reports=this.elements.reportcontainer.getElements(".reportinput"),this.elements.reportcontainer.getElements(".numberinput").addEvent("blur",this.changedReportInputs),this.elements.reportcontainer.getElements("input[type=radio]").addEvent("click",this.changedReportInputs)),this.elements.areatemplate=$(t+"_areatemplate"),this.elements.areas=[];t=this.elements.pointtemplate.getElements(".html_template-1").pick().get("html").split(/\s*{[0,1]}\s*/);3===t.length&&(this.elements.pointtemplate.getElements(".html_template-1").pick().set("html",t[0]),this.elements.pointtemplate.getElements(".html_template-2").pick().set("html",t[1])),this.elements.caesura_type.getElements("input[type=radio]").addEvent("click",this.changedType),this.elements.score_type.addEvent("change",this.changedInput),this.elements.rounddecimals.addEvent("change",this.changedInput),this.elements.roundtype.addEvent("change",this.changedInput),this.elements.grade_range.addEvent("change",this.changedInput),this.elements.max_points.addEvent("change",this.changedInput),this.elements.max_points.addEvent("keypress",this.maxPointsKeyPress),this.elements.caesura.addEvent("change",this.changedInput),this.elements.negate_guessing&&this.elements.negate_guessing.addEvent("change",this.changedInput),this.elements.schotanus&&this.elements.schotanus.addEvent("change",this.changedSchotanus),this.elements.weighting&&this.elements.weighting.getElements("input[type=radio]").addEvent("click",this.changedWeighting);var n,s=this;this.elements.score_type.getParent("div.slider").addEvents({show:function(){s.show_score_type||this.setStyle("height","0px")}}),this.elements.buttonaddpoint.addEvent("click",function(){return e.showAddPoint(),!1}),this.elements.buttonremovepoint.addEvent("click",function(){return e.removePoint(),this.disabled=!0,this.addClass("disabled"),!1}),this.elements.buttonremovepoint.disabled=!0,this.elements.buttonremovepoint.addClass("disabled");try{this.value=JSON.parse(this.elements.json.value),this.checkValue(),this.elements.caesura_type&&"hidden"!==this.elements.caesura_type.type&&((n=this.elements.caesura_type.getElement("input[value="+this.value.type+"]")).checked=!0,n.fireEvent("click")),this.elements.weighting&&((n=this.elements.weighting.getElement("input[value="+this.value.weighting+"]")).checked=!0,n.fireEvent("click")),this.elements.score_type.value=this.value.score_type,this.elements.score_type.fireEvent("change"),this.elements.negate_guessing&&(this.elements.negate_guessing.value=this.value.negate_guessing?"true":"false",this.elements.negate_guessing.fireEvent("change")),this.elements.schotanus&&(this.elements.schotanus.value=this.value.schotanus,this.elements.schotanus.fireEvent("change")),this.elements.rounddecimals.value=this.value.roundprecision,this.elements.rounddecimals.fireEvent("change"),this.elements.roundtype.value=this.value.roundtype,this.elements.roundtype.fireEvent("change"),"normal"===this.value.type&&(this.elements.grade_range.value=0===this.value.points[0][1]?"0-10":"1-10",this.elements.grade_range.fireEvent("change"),this.elements.max_points.value=this.value.points[this.value.points.length-1][1],this.elements.max_points.fireEvent("change")),this.updateInputs(),this.updateReportInputs(),this.updatePointInputs(),this.updateAreaInputs(),this.updateChart()}catch(t){this.value=JSON.parse('{"caesura_point":1,"points":[[0,1],[55,5.5],[100,10]],"roundprecision":1,"score_type":"grade","areas":[],"roundtype":"normal","type":"normal","schotanus":"no","weighting":"absolute","reports":[]}'),this.checkValue(),this.elements.score_type.value="grade",this.elements.score_type.fireEvent("change"),this.elements.rounddecimals.value=1,this.elements.rounddecimals.fireEvent("change"),this.elements.roundtype.value="natural",this.elements.roundtype.fireEvent("change")}this.updateInputs(),this.updateReportInputs(),this.updatePointInputs(),this.updateAreaInputs(),this.updateChart(),Highcharts.addEvent(e,"changed",this.changedChart),Highcharts.addEvent(e,"pointadded",function(t){this.value.areas.splice(t.index,0,["",""]),t.index<=this.value.caesura_point&&this.value.caesura_point++}.bind(this)),Highcharts.addEvent(e,"pointremoved",function(t){this.value.areas.splice(t.index,1)}.bind(this)),Highcharts.addEvent(e,"pointclicked",function(t){t.enabled?(this.elements.buttonremovepoint.disabled=!1,this.elements.buttonremovepoint.removeClass("disabled")):(this.elements.buttonremovepoint.disabled=!0,this.elements.buttonremovepoint.addClass("disabled"))}.bind(this)),this.disablechangedevent=!1},roundDecimals:function(t,e){e=Math.pow(10,e);return Math.round(t*e)/e},floorDecimals:function(t,e){e=Math.pow(10,e);return Math.floor(t*e)/e},ceilDecimals:function(t,e){e=Math.pow(10,e);return Math.ceil(t*e)/e},checkValue:function(){var t=this.value.points.length-this.value.areas.length-1;if(0<t)for(var e=0;e<t;e++)this.value.areas.push(["",""]);else if(t<0)for(e=0;t<e;e--)this.value.areas.pop();this.value.reports instanceof Array&&(this.value.reports={})},getPoints:function(t){for(var e=[],i=this.value.points.length,n=t&&"no"!==this.value.schotanus?parseFloat(this.value.schotanus)/100:1,s=0;s<i;s++){var o=this.value.points[s];t&&this.value.schotanus;e.push({x:this.roundDecimals(o[0]*(s===i-1?1:n),1),y:o[1],drag:!0})}return e},getReportLines:function(){},setPoints:function(t){this.value.points=[];for(var e=void 0===this.value.schotanus||"no"===this.value.schotanus?1:parseFloat(this.value.schotanus)/100,i=0,n=t.length;i<n;i++){var s=t[i],s=0===i||i===n-1?[s.x,s.y]:[this.roundDecimals(s.x,2)/e,s.y];this.value.points.push(s)}},updateInputs:function(){this.elements.score_type.value=this.value.score_type,this.elements.score_type.fireEvent("change"),this.elements.rounddecimals.value=this.value.roundprecision,this.elements.rounddecimals.fireEvent("change"),this.elements.roundtype.value=this.value.roundtype,this.elements.roundtype.fireEvent("change"),this.elements.grade_range.value=0===this.value.points[0][1]?"0-10":"1-10",this.elements.grade_range.fireEvent("change"),this.elements.max_points.value=this.value.points[this.value.points.length-1][1],this.elements.max_points.fireEvent("change"),this.elements.negate_guessing&&(this.elements.negate_guessing.value=this.value.negate_guessing?"true":"false",this.elements.negate_guessing.fireEvent("change")),this.elements.schotanus&&(this.elements.schotanus.value=this.value.schotanus,this.elements.schotanus.fireEvent("change")),this.updateCaesuraSelect()},updateCaesuraSelect:function(){var n=this.elements.caesura.retrieve("$styledselect"),s=this.getPoints(!0);n.clearOptions(),n.addOption({value:-1,text:$I18N.t("No caesura")}),s.each(function(t,e){var i=parseFloat(t.x);("no"===this.value.schotanus||e<s.length-1)&&("composite"===this.value.type?n.addOption({value:e,text:$I18N.t("Score")+" "+Highcharts.numberFormat(t.y,this.getRoundPrecision())+this.getGradePostfix()}):n.addOption({value:e,text:Highcharts.numberFormat(i,i===Math.round(i)?0:1)+"%, "+$I18N.t("score")+" "+Highcharts.numberFormat(t.y,this.getRoundPrecision())+this.getGradePostfix()}))}.bind(this)),n.set(-1),n.set(this.value.caesura_point)},updateChart:function(){this.chart.setScoreType(this.value.score_type),this.chart.setCaesuraType(this.value.type),this.chart.setDecimalsY(Math.min(this.getRoundPrecision(),1)),this.chart.setPoints(this.getPoints(!0))},getRoundPrecision:function(){return"percentage"===this.value.score_type||"composite"===this.value.type||"points"===this.value.score_type&&50<this.value.points[this.value.points.length-1].y?this.value.roundprecision:this.value.roundprecision+1},getRoundType:function(){return this.value.roundtype},round:function(t,e){switch(e=e||this.getRoundPrecision(),this.getRoundType()){case"natural":return this.roundDecimals(t,e);case"up":return this.ceilDecimals(t,e);case"down":return this.floorDecimals(t,e);case"almost_natural":var i=this.roundDecimals(t,e),n=this.floorDecimals(t,e);return this.hasPassed(i)&&!this.hasPassed(n)?n:i;case"auto":return t<this.value.points[this.value.caesura_point][1]?this.floorDecimals(t,e):this.ceilDecimals(t,e)}},updatePointInputs:function(){var t=this.getPoints(!0);if(0===this.elements.points.length&&(this.elements.points.push(this.elements.pointtemplate),this.elements.pointtemplate.getElements("input").each(function(t){t.addEvent("blur",this.changedPointInput)}.bind(this))),this.elements.points.length!==t.length){for(var e=t.length-this.elements.points.length,i=0;i<e;i++){var n=this.elements.pointtemplate.clone();n.getElements("input").each(function(t){t.addEvent("blur",this.changedPointInput),t.addEvent("keydown",this.pointInputKeyDown),t.disabled=!1,t.removeClass("disabled")}.bind(this)),n.inject(this.elements.points[this.elements.points.length-1],"after"),this.elements.points.push(n)}for(i=0;e<i;i--)this.elements.points.pop().destroy()}var s=this.getRoundPrecision(),o=this.elements.points,a=this.getGradePostfix(),r="no"!==this.value.schotanus&&void 0!==this.value.schotanus;t.each(function(t,e){var i=o[e].getElements("input");i[0].disableValidation=!0,i[0].value=Highcharts.numberFormat(t.x,Math.round(t.x)==t.x?0:1)+"%",i[1].disableValidation=!0,i[1].value=Highcharts.numberFormat(t.y,s)+a,0===e||e===o.length-1||r&&e===o.length-2?(i[0].disabled=!0,i[0].addClass("disabled"),i[1].disabled=!0,i[1].addClass("disabled")):(i[0].disabled=!1,i[0].removeClass("disabled"),i[1].disabled=!1,i[1].removeClass("disabled"))});var l=this.element.getElement(".caesura_guesswarning");l&&(this.value.negate_guessing&&2<t.length&&t[0].y===t[1].y?l.removeClass("dnone"):l.addClass("dnone"))},updateAreaInputs:function(){var t,e;if(0===this.elements.areas.length&&(this.elements.areas.push(this.elements.areatemplate),(t=this.elements.areatemplate.getElements("input")).addEvent("change",this.changedAreaInput),e=this,t[0].getParent("div.slider").addEvents({show:function(){e.show_area_name||this.setStyle("height","0px")}}),t[1].getParent("div.slider").addEvents({show:function(){e.show_area_feedback||this.setStyle("height","0px")}})),this.elements.areas.length!==this.value.areas.length){for(var i=this.value.areas.length-this.elements.areas.length,n=0;n<i;n++){var s=this.elements.areatemplate.clone(!0,!0);s.set("html",s.get("html").replace(/\-0/g,"-"+this.elements.areas.length)),s.getElements("input").each(function(t){t.addEvent("change",this.changedAreaInput)}.bind(this)),s.inject(this.elements.areas[this.elements.areas.length-1],"after"),this.elements.areas.push(s),window.addEvent("domready",function(){new QTITinyMCEPopupInput(this.elements.json.getParent("form"),s.getElements("input")[1].name)}.bind(this))}for(n=0;i<n;n--)this.elements.areas.pop().destroy()}var o=this.elements.areas;this.value.areas.each(function(t,e){var i=o[e].getElements("input");i[0].value=t[0],i[1].value=t[1],o[e].getElements(".example")[0].set("html",t[1]),o[e].getElements(".areaname").each(function(t){t.set("text",this.intToChar(e))}.bind(this))}.bind(this)),this.element.createTooltips()},updateReportInputs:function(){if(!this.elements.reportcontainer)return!1;var n=0,s=[];this.elements.reports.each(function(t){var e=this.value.reports[t.get("data-title")],i=t.getElement(".numberinput");"relative"===this.value.weighting?(i.readonly=!0,i.addClass("disabled")):(i.readonly=!1,i.removeClass("disabled")),this.value.score_type!==t.get("data-score-type")?t.addClass("disabled"):t.removeClass("disabled"),e?(i.value=Highcharts.numberFormat("relative"===this.value.weighting?1:e.weight,2),t.getElement("input[type=radio][value="+(e.passed?1:0)+"]").checked=!0,s.contains(t.get("data-score-type"))||s.push(t.get("data-score-type"))):(i.value=Highcharts.numberFormat(1),t.getElement("input[type=radio][value=0]").checked=!0,this.value.reports[t.get("data-title")]={weight:0,passed:!1}),t.hasClass("disabled")||(t=0,t=","===Locale.get("Number.decimal")?parseFloat(i.get("value").replace(".","").replace(",",".")):parseFloat(i.value),n+=t)}.bind(this)),"composite"==this.value.type?0==n?(this.elements.reportcontainer.getElement(".nodata_warning").setStyle("display","block"),this.changeShowAreaName(!1)):(this.elements.reportcontainer.getElement(".nodata_warning").setStyle("display","none"),this.changeShowAreaName(!0)):this.changeShowAreaName(!0);var t=this.elements.score_type.retrieve("$styledselect");t&&("composite"===this.value.type?t.list.getElements("li").each(function(t){s.contains(t.retrieve("value"))?t.removeClass("disabled"):t.addClass("disabled")}):t.list.getElements("li").removeClass("disabled"))},changedReportInputs:function(){if(this.elements.reportcontainer){if(this.disablechangedevent)return!0;this.value.reports={},this.elements.reports.each(function(t){var e,i=t.getElement(".numberinput");t.hasClass("disabled")||(e=0,e=","===Locale.get("Number.decimal")?parseFloat(i.value.replace(".","").replace(",",".")):parseFloat(i.value),this.value.reports[t.get("data-title")]={weight:e,passed:"1"==t.getElement("input[type=radio]:checked").value})}.bind(this)),this.disablechangedevent=!0,this.updateReportInputs(!1),this.changedType(),this.updateJSON(!1),this.disablechangedevent=!1}},updateJSON:function(){var t=JSON.stringify(this.value);this.elements.json.value!==t&&(this.elements.json.value=t,this.element.fireEvent("change"),this.elements.score_type.fireEvent("change"))},changedType:function(t){var e=this.elements.caesura_type.getElement("input:checked").value;if(this.value.type!==e){if("composite"===e){this.value.type=e;var i,n,s,o={},a=0==this.old_points.length;this.old_points=this.value.points,this.old_areas=this.value.areas,this.elements.reports.each(function(t){var e=t.get("data-score-type");void 0===o[e]&&(o[e]={cnt:0,type:e,min:0,max:0,caesura:0,sum:0,unweighted_min:0,unweighted_max:0,unweighted_caesura:0});var i=t.getElement(".numberinput"),i=","===Locale.get("Number.decimal")?parseFloat(i.value.replace(".","").replace(",",".")):parseFloat(i.value);o[e].cnt++,o[e].min+=parseFloat(t.get("data-min-score"))*i,o[e].max+=parseFloat(t.get("data-max-score"))*i,o[e].caesura+=parseFloat(t.get("data-caesura"))*i,o[e].unweighted_min+=parseFloat(t.get("data-min-score")),o[e].unweighted_max+=parseFloat(t.get("data-max-score")),o[e].unweighted_caesura+=parseFloat(t.get("data-caesura")),o[e].sum+=i}),(r=Object.values(o).sort(function(t,e){return e.cnt-t.cnt})[0])?(this.elements.score_type.value=r.type,this.elements.score_type.fireEvent("change"),i=this.round(0===r.sum?r.unweighted_min/r.cnt:r.min/r.sum,this.value.roundprecision),n=this.round(0===r.sum?r.unweighted_max/r.cnt:r.max/r.sum,this.value.roundprecision),s=this.round(0===r.sum?r.unweighted_caesura/r.cnt:r.caesura/r.sum,this.value.roundprecision),a?(this.value.points=[[i,i],[s,s],[n,n]],this.value.areas=[[$I18N.t("Failed"),""],[$I18N.t("Passed"),""]]):(this.value.points[0][0]=i,this.value.points[0][1]=i,this.value.points[this.value.points.length-1][0]=n,this.value.points[this.value.points.length-1][1]=n)):this.elements.score_type.fireEvent("change")}else{if(this.value.type=e,0<this.old_points.length)this.value.points=this.old_points,this.value.areas=this.old_areas,this.old_points=[],this.old_areas=[];else{var r=this.value.points[0][0],e=this.value.points[this.value.points.length-1][0];if(0!==r[0]||100!==e[0])for(var l=e-r,h=0,c=this.value.points.length;h<c;h++)this.value.points[h][0]=0==h?0:h==c-1?100:this.round((this.value.points[h][0]-r)/l*100,1)}this.changedInput()}this.chart.hideAddPoint(),this.updateReportInputs(),this.updatePointInputs(!1),this.updateAreaInputs(!1),this.updateJSON(!1),this.updateChart()}},changedSchotanus:function(t){t&&this.setPoints(this.chart.getPoints()),this.changedInput()},changedInput:function(){if(this.disablechangedevent)return!0;this.value.score_type;this.value.score_type=this.elements.score_type.value;var t=this.value.roundprecision,e=this.value.roundtype;this.value.roundprecision=parseInt(this.elements.rounddecimals.value),this.value.roundtype=this.elements.roundtype.value;var i=this.value.points[this.value.points.length-1][1];if("grade"===this.value.score_type?("composite"===this.value.type?this.value.points[0][1]=this.value.points[0][0]:this.value.points[0][1]="0-10"===this.elements.grade_range.value?0:1,this.value.points[this.value.points.length-1][1]=10):"points"===this.value.score_type?(this.value.points[0][1]=0,this.value.points[this.value.points.length-1][1]=parseInt(this.elements.max_points.value)):(this.value.points[0][1]=0,this.value.points[this.value.points.length-1][1]=100),i!==this.value.points[this.value.points.length-1][1])for(var n=1;n<this.value.points.length-1;n++)this.value.points[n][1]=this.value.points[n][1]*(this.value.points[this.value.points.length-1][1]/i);if(t!==this.value.roundprecision||e!==this.value.roundtype)for(n=1;n<this.value.points.length-1;n++)this.value.points[n][1]=this.round(this.value.points[n][1]),"composite"===this.value.type&&(this.value.points[n][0]=this.value.points[n][1]);this.value.caesura_point=parseInt(this.elements.caesura.value),this.value.negate_guessing=!!this.elements.negate_guessing&&"true"===this.elements.negate_guessing.value,this.value.schotanus=this.elements.schotanus?this.elements.schotanus.value:"no",this.disablechangedevent=!0,this.updateInputs(!1),this.updateReportInputs(),this.updatePointInputs(!1),this.updateChart(!1),this.updateAreaInputs(!1),this.updateJSON(!1),this.disablechangedevent=!1},maxPointsKeyPress:function(t){return"enter"!==t.key||(this.changedInput(),!1)},changedPointInput:function(){if(this.disablechangedevent)return!0;var s=this.getPoints(!1),o=this.elements.points;this.elements.points.each(function(t,e){var i,n;0<e&&e<o.length-1&&(i=s[e-1],(n=s[e+1])&&(t=t.getElements("input"),t=","===Locale.get("Number.decimal")?{x:parseFloat(t[0].value.replace(".","").replace(",",".")),y:parseFloat(t[1].value.replace(".","").replace(",","."))}:{x:parseFloat(t[0].value),y:parseFloat(t[1].value)},s[e]={x:Math.min(Math.max(t.x,i.x),n.x),y:Math.min(Math.max(t.y,i.y),n.y),drag:!0}))}),this.setPoints(s),this.disablechangedevent=!0,this.updatePointInputs(!1),this.updateChart(!1),this.updateCaesuraSelect(),this.updateJSON(!1),this.disablechangedevent=!1},pointInputKeyDown:function(t){return"enter"!==t.key||(t.preventDefault(),this.changedPointInput(),!1)},changedAreaInput:function(){if(this.disablechangedevent)return!0;this.elements.areas.each(function(t,e){t=t.getElements("input");this.value.areas[e][0]=t[0].value,this.value.areas[e][1]=t[1].value}.bind(this)),this.disablechangedevent=!0,this.updateJSON(!1),this.disablechangedevent=!1},changedChart:function(){if(this.disablechangedevent)return!0;this.setPoints(this.chart.getPoints()),this.disablechangedevent=!0,this.updateInputs(!1),this.updatePointInputs(!1),this.updateAreaInputs(!1),this.updateJSON(!1),this.disablechangedevent=!1},intToChar:function(t){for(var e="";0<=t;)e=String.fromCharCode(t%26+65)+e,t=Math.floor(t/26)-1;return e},getGradePostfix:function(){var t="";return"percentage"===this.value.score_type&&(t="%"),t="points"===this.value.score_type?" pt.":t},changeShowScoreType:function(t){this.show_score_type!==t&&(t||(this.elements.score_type.value=this.value.score_type,this.elements.score_type.fireEvent("change")),this.elements.score_type.getParent(".slider").setStyle("height",t?"auto":"0px"),this.show_score_type=t)},changeShowAreaName:function(e){this.elements.areas.each(function(t){t.getElements("input")[0].getParent(".slider").setStyle("height",e?"auto":"0px")}),this.show_area_name=e},changeShowAreaFeedback:function(e){this.elements.areas.each(function(t){t.getElements("input")[1].getParent(".slider").setStyle("height",e?"auto":"0px")}),this.show_area_feedback=e},openTable:function(){this.exampleTable=new ContentWindow({title:$I18N.t("Score table"),width:500,zIndex:1e5,id:"caesurawindow",modalOptions:{id:"casurawindow_modal"},close_button:!0,class:"contentwindow",onClose:function(){clearTimeout(this.eol_redirect),this.exampleTable=!1}.bind(this)},{loadMethod:"callback",callback:this.generateTable.bind(this),panel:"caesurawindow_panel"}),this.exampleTable.grid.getPanel("caesurawindow_panel").content.bind_fillpanels()},generateTable:function(){var t,e=new Element("table.datatable.examplescores"),i=new Element("tr");e.grab(i),i.grab(new Element("th",{text:$I18N.t("Score")})),i.grab(new Element("th",{text:$I18N.t("Grade")})),i.grab(new Element("th",{text:$I18N.t("Passed")})),i.grab(new Element("th",{text:$I18N.t("Score area")}));for(var n=","===Locale.get("Number.decimal")?(t=parseInt(this.elements.example_input.get("value").replace(".","").replace(",",".")),parseInt(this.elements.example_guessing.get("value").replace(".","").replace(",","."))):(t=parseInt(this.elements.example_input.get("value")),parseInt(this.elements.example_guessing.get("value"))),s=$I18N.t("Yes"),o=$I18N.t("No"),a=0;a<=t;a++){var r,l,h=new Element("tr"),c=this.calculateGrade(a,t,this.value.roundprecision,n),u="<strong>"+Highcharts.numberFormat(c,this.value.roundprecision)+"</strong>";this.value.roundprecision<2&&(r=this.calculateGrade(a,t,this.value.roundprecision+1,n),l=0,this.round(r,this.value.roundprecision)!==c&&(0==this.value.roundprecision?l=.1:1==this.value.roundprecision&&(l=.01)),u+="<span class='decimals'>("+Highcharts.numberFormat(r-l,this.value.roundprecision+1)+")</span>"),h.grab(new Element("td",{text:a})),h.grab(new Element("td",{html:u})),h.grab(new Element("td",{text:this.hasPassed(c)?s:o})),h.grab(new Element("td",{text:this.getAreaName(c)})),e.grab(h)}i=new Element("div.popupcontent.fillpanel");return i.grab(e),i},getScoreTable:function(){var t=null,e=$("recipe_settings_create"),i=$("recipe_settings_edit");e?t=e.toQueryString().parseQueryString():i&&(t=i.toQueryString().parseQueryString());i=$("feedbackreport");(t=i?i.toQueryString().parseQueryString():t)&&(this.exampleTable=new ContentWindow({title:$I18N.t("Score table"),width:500,zIndex:1e5,id:"caesurawindow",modalOptions:{id:"casurawindow_modal"},close_button:!0,onClose:function(){this.exampleTable=!1}.bind(this),class:"contentwindow"},{loadMethod:"controller",controller:"ContentController",controllerAction:"init",controllerActionParams:["caesurawindow_panel","/study/recipe/score_table",{request:{data:{form:t},method:"post"}}]}));t=$("subscription_settings");t&&(t=t.toQueryString().parseQueryString(),this.exampleTable=new ContentWindow({title:$I18N.t("Score table"),width:500,zIndex:1e5,id:"caesurawindow",modalOptions:{id:"casurawindow_modal"},close_button:!0,onClose:function(){this.exampleTable=!1}.bind(this),class:"contentwindow"},{loadMethod:"controller",controller:"ContentController",controllerAction:"init",controllerActionParams:["caesurawindow_panel","/subscription/score_table",{request:{data:{form:t},method:"post"}}]}))},calculateGrade:function(t,e,i,n){if(e<=0)return!1;void 0===i&&(i=this.value.roundprecision);var s=JSON.parse(JSON.encode(this.value));this.value.negate_guessing&&0<n&&(s=this.negateGuessing(s,n));var o=0;0<t&&0<e&&(o=+this.stripDecimals(100*Math.max(0,Math.min(t/e,1))));e=s.points[s.points.length-1];if(o>=e[0])return this.round(e[1],i);for(var a=e,r=s.points.length-1;0<=r;r--){var l=s.points[r];if(l[0]==o)return this.round(l[1],i);if(l[0]<o){var h=a[0]-l[0],c=a[1]-l[1],u=o-l[0];return this.round(u/h*c+l[1],i)}a=l}return this.round(s.points[0][1],i)},negateGuessing:function(t,e){var i=[],n=t.points,s=n.shift();i.push(s),i.push([e,s[1]]);var o=(100-e)/100;return n.each(function(t){i.push([e+t[0]*o,t[1]])}),t.points=i,t.areas.unshift(t.areas[0]),t.caesura_point++,t},stripDecimals:function(t){return parseFloat(t).toPrecision(12)},hasPassed:function(t){return-1===this.value.caesura_point?null:this.value.points[this.value.caesura_point][1]<=t},getAreaName:function(t){for(var e="",i=this.value.areas.length-1;0<i;i--)if(t>=this.value.points[i][1]&&!(this.value.points[i-1]&&t<=this.value.points[i][1]&&this.value.points[i-1][1]===this.value.points[i][1]))return null===(e=void 0===this.value.areas[i][0]?null:this.value.areas[i][0])?" - ":e;return!1===(e=void 0===this.value.areas[0][0]?null:this.value.areas[0][0])?" - ":e},addCompositeArea:function(e){e.preventDefault(),this.editwindow=new ContentWindow({width:660,height:"80%",id:"composite_window"},{loadMethod:"controller",controller:"ContentController",controllerAction:"init",controllerActionParams:["composite_window_panel",e.target.getAttribute("href"),{request:{data:{score_type:this.value.score_type,lines:JSON.stringify(this.value.lines)}}}]}),this.editwindow.grid.addEvent("onJSON",function(t){!0===t.success&&(this.editwindow.element.startLoading(),void 0!==t.line&&(void 0===this.value.lines&&(this.value.lines=[]),this.value.lines.push(t.line),this.updateJSON()),this.refreshReports(function(){this.editwindow.element.stopLoading(),this.editwindow.close()}.bind(this),e.target.getAttribute("href")))}.bind(this))},refreshReports:function(e,t){var i=this.element.getParent("form");document.$grid||document.$page;this.editwindow.element.startLoading(),i.runCallback("reports",{},function(t){t.reports&&(this.elements.reportcontainer.getParent(".row-slider").outerHTML=t.reports,this.elements.reportcontainer=$(this.id+"_reportcontainer"),this.elements.reportcontainer&&(this.elements.reports=this.elements.reportcontainer.getElements(".reportinput"),this.elements.reportcontainer.getElements(".numberinput").addEvent("blur",this.changedReportInputs),this.elements.reportcontainer.getElements("input[type=radio]").addEvent("click",this.changedReportInputs)),this.disablechangedevent=!0,this.updateReportInputs(!1),this.changedType(),this.updateJSON(!1),this.disablechangedevent=!1,e())}.bind(this))},changedWeighting:function(){var t=this.elements.weighting.getElement("input:checked").value;this.value.weighting!==t&&(this.value.weighting=t,this.disablechangedevent=!0,this.updateReportInputs(!1),this.changedType(),this.updateJSON(!1),this.disablechangedevent=!1)}}),$page;window.addEvent("domready",function(){Locale.use($lang),$$("body")[0].createLinks(),$$("body")[0].createSliders(),$$("body")[0].createTooltips(),$$("body")[0].createSymbolLists(),$page=new Page,buffer&&buffer.execute()}),document.addEventListener("DOMContentLoaded",function(){var t=["/testplayer","/login","/sso"];for(document.getElementById("review-page")&&t.push("/review"),index=0;index<t.length;++index)if(window.location.pathname.toLocaleLowerCase().startsWith(t[index]))return;var i=void 0;window.addEventListener("offline",function(){var t,e;void 0===i&&(t=$I18N.t("Network connection to RemindoToets is broken, please check your internet connection.")+"<br>"+$I18N.t("This popup will close automatically when your connection is restored."),e="auto",window.location.pathname.toLocaleLowerCase().startsWith("/results/check/revise/run/")&&(t+="<br><br>"+$I18N.t("Correctionwork that has not been saved yet, will be saved when your internet connection is restored. If you close this browser(-tab) or reload the page, unsaved correctionwork will be lost!"),"ie"===Browser.name&&(e="126px")),i=renderErrorWindow("offlineWindow",$I18N.t("Disconnected"),t,void 0,void 0,e))}),window.addEventListener("online",function(){void 0!==i&&(i.close(),i=void 0)});var e=void 0,n=void 0,s=void 0,o=0,a=Cookie.read("user_id");setInterval(function(){if(navigator.onLine&&!window.location.pathname.startsWith("/embed/"))return Cookie.read("user_id")===a?(o=0,null!=n&&(n.close(),n=void 0),void(null!=s&&(s.close(),s=void 0))):0<Cookie.read("user_id")?void 0!==e?void 0:void(e=renderErrorWindow("offlineWindow",$I18N.t("New login detected"),$I18N.t("A new user login is detected. The current user is not valid anymore. Refresh the page to continue RemindoToets as the new user."),$I18N.t("Refresh page"),function(){location.reload()})):void(++o<3||void 0===n&&(n=renderErrorWindow("loginWindow",$I18N.t("Logon expired"),$I18N.t("Your logon has expired; please click on the 'Log in'-button to enter your login credentials."),$I18N.t("Log in"),function(t){t.stopPropagation(),t.preventDefault(),void 0!==s&&s||(s=window.open("/login","authWindow","width=800,heigh=480,location=no,menubar=no,toolbar=no,scrollbars=yes",!0))})))},1e3)}.bind(this));
//# sourceMappingURL=base.js.map